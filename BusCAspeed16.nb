(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    476303,      11636]
NotebookOptionsPosition[    460417,      11393]
NotebookOutlinePosition[    460808,      11410]
CellTagsIndexPosition[    460765,      11407]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["An agent model for buses", "Title",
 CellChangeTimes->{{3.747229971380108*^9, 3.747229976524006*^9}, 
   3.747230014017823*^9, {3.756054684824004*^9, 
   3.7560546889496613`*^9}},ExpressionUUID->"96147a4d-7515-4828-be64-\
976d91bea8e8"],

Cell[CellGroupData[{

Cell["Assumptions and rules", "Chapter",
 CellChangeTimes->{{3.747237266723563*^9, 
  3.747237273297133*^9}},ExpressionUUID->"6fca091b-9b9a-406e-a508-\
43cb7455b9fa"],

Cell[TextData[{
 "A ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Cross]", "n"}], TraditionalForm]],ExpressionUUID->
  "e12e3cb7-c7eb-4db2-a6ce-555be44cdc56"],
 " agent model, the top row marks stations and traffic lights, the bottom \
line holds the buses.\nPositive is taken to be to the left, there is no \
negative movement. Also, lights and stations are assumed to be sufficiently \
far apart so that it is impossible to have two of them within a bus\
\[CloseCurlyQuote] line of sight (LOS). \nBuses are characterized by the \
following parameters: \n\t\[FilledSmallCircle] Speed ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "1109c317-6ee4-4dfb-9580-7962e4c8972e"],
 " (number of cells that were advanced in the previous tick), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "\[Element]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "\[Ellipsis]", ",", 
      SubscriptBox["v", "max"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "c37779fd-cd46-444d-94a8-de81252e85b1"],
 ". The speed of each bus changes through the simulation. \n\t\
\[FilledSmallCircle] A negative acceleration ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "-"], TraditionalForm]],ExpressionUUID->
  "655cbb13-91e9-423d-808c-80f8d33421ed"],
 ", maximum negative speed change per tick, its fixed.\n\t\
\[FilledSmallCircle] A positive acceleration ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "+"], TraditionalForm]],ExpressionUUID->
  "19cf9dba-fad7-4625-8358-d889a8e7118d"],
 ", the maximum positive speed change per tick, its fixed.\n\t\
\[FilledSmallCircle] A number of cars or wagons ",
 Cell[BoxData[
  FormBox["w", TraditionalForm]],ExpressionUUID->
  "939d5e2a-fedb-4fda-9978-db9fdf7f2e10"],
 ", this is how many doors the bus has, its fixed. \n\t\[FilledSmallCircle] \
The carrying capacity of the wagons ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "4c59c80a-8c19-402a-8f5f-e42605d1c7f4"],
 ", fixed.\n\t\[FilledSmallCircle] Stations don\[CloseCurlyQuote]t have size, \
they are supposed to be able to fit an infinite number of commuters.\n\t\
\[FilledSmallCircle] The LOS of a bus is used to determine its reactions \
(according to the rules below), it is taken to be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["v", "max"], "+"}], "|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],ExpressionUUID->
  "55cba4af-d3d3-449d-9acb-90ac4eca1970"],
 ". Its better for it to be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"w", "+", 
      SubscriptBox["v", "max"], "+", 
      SubscriptBox["v", "max"], "-"}], "|", 
     SubscriptBox["a", "-"], "|", 
     RowBox[{
      RowBox[{"+", 
       SubscriptBox["v", "max"]}], "-", "2"}], "|", 
     SubscriptBox["a", "-"], "|"}], "=", 
    RowBox[{
     RowBox[{"w", "+", "1", "+", 
      RowBox[{"3", 
       SubscriptBox["v", "max"]}], "-", "3"}], "|", 
     SubscriptBox["a", "-"], "|"}]}], TraditionalForm]],ExpressionUUID->
  "9a4d9a73-43ed-4821-a1fe-9e1d0813970d"],
 ", this is: the size of the bus plus the minimum distance moved when braking \
at full speed.\nBuses move according to the following rules:\n\t\
\[FilledSmallCircle] They must stop at red lights\n\t\[FilledSmallCircle] \
They must stop at stations and remain stationary while loading or unloading \
passengers\n\t\[FilledSmallCircle] They must brake if they may crash into the \
bus ahead.\n\t\[FilledSmallCircle] Otherwise they accelerate to maximum speed \
and keep cruising at that speed.\n\t\[FilledSmallCircle] A bus enters the \
simulation every tick, if possible, from the left with probability ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "b"], TraditionalForm]],ExpressionUUID->
  "a6aff739-ffa3-45d4-a78c-25aa5b9407fc"],
 ".\n Stations\n \t\[FilledSmallCircle] Unloading happens before loading.\n \t\
\[FilledSmallCircle] There is a load/unload rate ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "e0af1a2b-a2be-44a2-bac0-b014126201af"],
 " (units: passengers per tick), same for both cases.\n \t\
\[FilledSmallCircle] The bus unloads a percentage of passengers ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "u"], TraditionalForm]],ExpressionUUID->
  "bc90a4d9-6dd9-4946-b571-fff27286ebf6"],
 " each time it stops.\n \t\[FilledSmallCircle] The bus loads all possible \
passengers (until it is full) or until the station empties (this is, there \
are fewer than \[Lambda]\[Upsilon] passangers at the station).\n \t\
\[FilledSmallCircle] Loading happens back to front (the back wagons fill \
first). This is irrelevant.\n \t\[FilledSmallCircle] Unloading happens front \
to back (the front wagons empty first). This is irrelevant.\n Lights\n \t\
\[FilledSmallCircle] Lights are green if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Sin", "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "i"], " ", "t"}], "+", 
      SubscriptBox["\[Phi]", "i"]}], ")"}], ">", "0"}], TraditionalForm]],
  ExpressionUUID->"7e0f9fc9-a06a-4671-911d-ecb75cee73c5"],
 ", red otherwise. "
}], "Text",
 CellChangeTimes->{{3.74723002556637*^9, 3.747230305987381*^9}, {
   3.7472310816196127`*^9, 3.747231127310165*^9}, {3.747231225885625*^9, 
   3.7472312751571417`*^9}, {3.747231666421261*^9, 3.7472318288139467`*^9}, {
   3.747231904792822*^9, 3.7472320115807734`*^9}, {3.747232244482369*^9, 
   3.74723232136653*^9}, {3.747237698048254*^9, 3.747237727145447*^9}, {
   3.7472382301082287`*^9, 3.747238271332171*^9}, {3.7472437609587097`*^9, 
   3.747243830113662*^9}, {3.747538327575605*^9, 3.747538328853429*^9}, {
   3.7484499496297073`*^9, 3.74845004432438*^9}, {3.748450885760723*^9, 
   3.74845088590374*^9}, {3.749156799437299*^9, 3.749156987883822*^9}, {
   3.749750907885255*^9, 3.749751054676434*^9}, {3.7560547052064*^9, 
   3.756054707974587*^9}, {3.756055741062402*^9, 3.756055937163967*^9}, {
   3.7575346270808783`*^9, 3.757534695431561*^9}, {3.7583812130565147`*^9, 
   3.758381258802991*^9}, {3.7598538026855907`*^9, 3.759853807154153*^9}, {
   3.768069950701713*^9, 3.768070139239603*^9}, 3.768148241105694*^9, {
   3.7681487688110332`*^9, 3.768148769071488*^9}, {3.7697973300682297`*^9, 
   3.769797330637335*^9}, {3.771847162809298*^9, 3.771847239298973*^9}, {
   3.7754770411150827`*^9, 
   3.775477041577941*^9}},ExpressionUUID->"4b1e53e0-cadb-4068-a1b0-\
2ada61edd588"],

Cell["These are global parameters, don\[CloseCurlyQuote]t change them.", \
"Text",
 CellChangeTimes->{{3.7507030594127502`*^9, 
  3.750703078231501*^9}},ExpressionUUID->"bc79c9d6-9b1d-4c13-b73c-\
c855212371b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vmax", "=", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"am", "=", 
   RowBox[{"-", "7"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ap", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]\[Upsilon]", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pu", "=", ".3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]b", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"100", " ", "5", "  ", "w"}], "+", "vmax", "-", "am"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "this", " ", "is", " ", "the", " ", "size", " ", "of", " ", "the", " ", 
     "track"}], ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "vmax"}], "-", 
     RowBox[{
     "am", " ", "length", " ", "is", " ", "included", " ", "to", " ", "allow",
       " ", "a", " ", "spece", " ", "for", " ", "buses", " ", "to", " ", 
      "exit", " ", "the", " ", "track"}]}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"los", "=", 
   RowBox[{
    RowBox[{"3", 
     RowBox[{"(", 
      RowBox[{"vmax", "-", 
       RowBox[{"Abs", "[", "am", "]"}]}], ")"}]}], "+", "5"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "this", " ", "is", " ", "the", " ", "line", " ", "of", " ", "sight"}], 
    ",", " ", 
    RowBox[{"not", " ", "including", " ", "the", " ", "bus"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"step", "=", "0"}], ";"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.747241804141075*^9, 3.747241843917441*^9}, {
   3.747243802616193*^9, 3.747243807511299*^9}, {3.749750972493256*^9, 
   3.7497509834113073`*^9}, {3.749751077356114*^9, 3.749751080601962*^9}, {
   3.751050641282873*^9, 3.751050641793276*^9}, {3.7560547300347652`*^9, 
   3.756054736054923*^9}, {3.756055955596019*^9, 3.756055995492115*^9}, {
   3.7619340856716757`*^9, 3.761934114192047*^9}, {3.7681487751690817`*^9, 
   3.7681487958977537`*^9}, {3.768149078739862*^9, 3.7681490926860743`*^9}, {
   3.769797279876111*^9, 3.769797282496374*^9}, {3.772209037273559*^9, 
   3.772209068438593*^9}, {3.777652619405182*^9, 3.777652622851501*^9}, {
   3.778512673771077*^9, 3.7785126740727863`*^9}, 3.778513697207951*^9, {
   3.778514298333529*^9, 3.77851430104357*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"06561019-91e5-4895-98ec-ea625464ae94"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data structures", "Chapter",
 CellChangeTimes->{{3.747237279729944*^9, 3.747237285174081*^9}},
 TextJustification->1.,ExpressionUUID->"34a485e1-db54-494d-bd09-bd8e00ac5eae"],

Cell[CellGroupData[{

Cell["The track", "Section",
 CellChangeTimes->{{3.7481913999814157`*^9, 
  3.748191404425782*^9}},ExpressionUUID->"e8573741-344c-41ec-98bf-\
aeb18d62369a"],

Cell[TextData[{
 "The track is a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Cross]", "n"}], TraditionalForm]],ExpressionUUID->
  "1a11cbe8-58c2-4bca-a8f1-c8966d91c723"],
 " list, it has lights and stations on the first row, buses on the second. \
The last ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "max"], TraditionalForm]],ExpressionUUID->
  "defae4cf-506b-43bb-a338-dacbf7f86413"],
 " spaces should be kept empty for cleaning reasons. \nTime is kept at the \
first cell of the top track."
}], "Text",
 CellChangeTimes->{{3.7472399463468*^9, 3.747239983674673*^9}, {
  3.748193780234787*^9, 3.7481937806380243`*^9}, {3.748545672591663*^9, 
  3.7485457312808733`*^9}},ExpressionUUID->"8fe7bb2e-b8a4-42e3-9fa4-\
4a94ea0f459a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"track", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "size", "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.747239525393776*^9, 3.747239552026145*^9}, {
  3.74724186540729*^9, 3.747241874799971*^9}, {3.748193790292995*^9, 
  3.7481937926727962`*^9}, {3.749234045669479*^9, 3.7492340470936937`*^9}, {
  3.749234361393118*^9, 3.74923436320299*^9}, {3.761934122294231*^9, 
  3.7619341228938017`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"29371a8c-7808-401c-8a44-7fa1feab8cfb"],

Cell["\<\
This is the line-of-sight neighborhood of the bus (including the bus length).\
\
\>", "Text",
 CellChangeTimes->{{3.747535848893268*^9, 3.747535874339202*^9}, {
  3.759165983311802*^9, 3.75916598525012*^9}, {3.7693366539097767`*^9, 
  3.769336663549221*^9}},ExpressionUUID->"b89e8d06-e6e1-4670-9e35-\
cd61f5ecabec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"w", "+", "1", "+", "los"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.747535879203615*^9, {3.7481230980325623`*^9, 3.7481230981929903`*^9}, {
   3.7693366356157703`*^9, 3.7693366391176357`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"a1a47536-9a1c-4457-b7ab-597eb0c6c9c7"],

Cell[TextData[{
 "This puts stations on ",
 Cell[BoxData[
  FormBox[
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "7187a5a9-7a0a-453a-83c1-1d4eaa977db4"],
 ", stations are lists of two elements ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["p", "i"], ",", "\[Alpha]"}], "}"}], TraditionalForm]],
  ExpressionUUID->"7dc45d96-a0bd-4bc8-a0af-fecb33a0fc2a"],
 ", with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "i"], TraditionalForm]],ExpressionUUID->
  "bb8992db-51a9-4e73-acfe-897b00d0f8dd"],
 " the amount of people at the station (0 at the start),  and ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "d55f4b61-7de0-4478-9470-3cea55ba0c06"],
 "(random uniform) the arrives per unit time. \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["stations",
     FontWeight->"Bold"], "[", "]"}], TraditionalForm]],ExpressionUUID->
  "59720332-a58c-4b45-860a-a09572588dfa"],
 " modifies ",
 Cell[BoxData[
  FormBox[
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "1fbf4245-6b10-4dea-bd50-3ce88de2830a"],
 " so that there is one station at place 50, and another every 100 cells \
ahead."
}], "Text",
 CellChangeTimes->{{3.748449050358139*^9, 3.7484490570423717`*^9}, {
  3.748449129449112*^9, 3.7484493006948357`*^9}, {3.748449863765726*^9, 
  3.748449927284923*^9}, {3.748450359501688*^9, 3.748450442338331*^9}, {
  3.756055667108514*^9, 
  3.756055718083351*^9}},ExpressionUUID->"0121c219-e4e1-41b9-a68f-\
bf0115741663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stations", "[", "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Rule", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"100", "j"}], "+", "50"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"Floor", "[", 
             FractionBox[
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"track", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"50", "+", "w"}], ";;", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "100"], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"RandomReal", "[", "]"}], "p"}], "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"Floor", "[", 
            FractionBox[
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"track", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"50", "+", "w"}], ";;", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "100"], "]"}], 
           "+", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.748450448663639*^9, 3.748450455068112*^9}, {
   3.748452778824389*^9, 3.748452822799199*^9}, {3.748453286218829*^9, 
   3.748453297003031*^9}, {3.748547155263887*^9, 3.74854719268616*^9}, {
   3.75105070964937*^9, 3.751050710735236*^9}, {3.751050773472084*^9, 
   3.7510507744685993`*^9}, 3.756056681275782*^9, {3.7591702094892387`*^9, 
   3.7591702099321012`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"571c3f2c-de0e-4e1b-8c09-ca43eeae9abc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"stations", "[", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.748452828024149*^9, 3.748452873157044*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"e26c2684-30e8-4eb8-b904-115724ea3ad9"],

Cell[TextData[{
 "This puts lights on ",
 Cell[BoxData[
  FormBox[
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "688a1300-b610-49de-b427-1c1b6c349caf"],
 ", lights are lists of one element ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Omega]", "i"], ",", 
      SubscriptBox["\[Phi]", "i"], ",", "t"}], "}"}], "}"}], 
   TraditionalForm]],ExpressionUUID->"f65af5af-0ffb-4630-b19e-31dbe4239d6c"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["lights",
     FontWeight->"Bold"], "[", "\[Omega]", "]"}], TraditionalForm]],
  ExpressionUUID->"b42b4dcb-5a9f-446e-878b-e274f1fbc0d9"],
 " modifies ",
 Cell[BoxData[
  FormBox[
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "b414d706-f17b-4784-b939-d79c8982c883"],
 " so that there is one light at place 100, and another every 100 cells \
ahead, lights all have frequency ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Omega]", "i"], "=", "\[Omega]"}], TraditionalForm]],
  ExpressionUUID->"e0383a17-2e4e-49ac-aabe-65e813fca9bb"],
 " and phase ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "i"], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "993a80b1-25d0-4a34-b61d-e0ba03c7da9c"],
 "."
}], "Text",
 CellChangeTimes->{{3.748449050358139*^9, 3.7484490570423717`*^9}, {
   3.748449129449112*^9, 3.7484493006948357`*^9}, {3.748449863765726*^9, 
   3.748449927284923*^9}, {3.748450359501688*^9, 3.748450442338331*^9}, {
   3.748452907098782*^9, 3.748452978784439*^9}, {3.748453317977995*^9, 
   3.748453319302793*^9}, {3.748454113668767*^9, 3.7484541519938297`*^9}, {
   3.750882340499102*^9, 3.7508823434670267`*^9}, {3.750882407066264*^9, 
   3.750882407433631*^9}, {3.756056748227737*^9, 3.75605677434754*^9}, {
   3.7560568346410503`*^9, 3.756056839241097*^9}, {3.7569250499703817`*^9, 
   3.756925050088746*^9}, 
   3.759165998325706*^9},ExpressionUUID->"d74bbd24-d0f1-42bd-bb3a-\
675cd6db6fe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lights", "[", "\[Omega]_", "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Rule", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"100", "j"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Floor", "[", 
             FractionBox[
              RowBox[{"Length", "[", 
               RowBox[{"track", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "100"], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\[Omega]", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
          RowBox[{"Floor", "[", 
           FractionBox[
            RowBox[{"Length", "[", 
             RowBox[{"track", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "100"], "]"}]}], "]"}]}],
        "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.748455991674415*^9, 3.748456047084758*^9}, {
   3.750882364420525*^9, 3.750882369073826*^9}, 3.756056864179556*^9, {
   3.75692507691663*^9, 3.756925077464826*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"841bd5b4-19a2-4ebf-9fdf-b991f32c62c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"lights", "[", "15", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.748456053981888*^9, 3.748456061577868*^9}, {
  3.748457261281228*^9, 3.748457286771179*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"74d04a73-a54a-4b31-8fb9-e91ce118eb78"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["makeTrack",
     FontWeight->"Bold"], "[", 
    RowBox[{
     StyleBox["size",
      FontSlant->"Italic"], ",", " ", "\[Rho]", ",", 
     StyleBox["st",
      FontSlant->"Italic"], 
     StyleBox[",",
      FontSlant->"Italic"], 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"lt", ",", "\[Omega]", ",", "\[Phi]"}], "}"}],
      FontSlant->"Italic"], 
     StyleBox[",",
      FontSlant->"Italic"], 
     StyleBox["\[Delta]",
      FontSlant->"Italic"]}], "]"}], TraditionalForm]],ExpressionUUID->
  "aaee6c63-e1b4-4c64-aa49-31988769bf53"],
 ", returns a track of length  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["los",
     FontSlant->"Italic"], 
    StyleBox["+",
     FontSlant->"Italic"], 
    StyleBox["size",
     FontSlant->"Italic"], 
    StyleBox["+",
     FontSlant->"Plain"], 
    StyleBox["los",
     FontSlant->"Italic"]}], TraditionalForm]],ExpressionUUID->
  "0df501db-1ac6-443f-accd-6b4498c6a439"],
 " populated with buses such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "\[TildeEqual]", 
    FractionBox[
     RowBox[{"number", " ", "of", " ", 
      RowBox[{"buses", " ", "\[Cross]", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "size"]}], TraditionalForm]],
  ExpressionUUID->"5d78533f-f30e-487f-88fa-0118b6aa1012"],
 ". Stations are placed every ",
 Cell[BoxData[
  FormBox[
   StyleBox["st",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "4a0fb975-1b1e-44dc-ad95-a6a63dcdea2c"],
 " cells. Lights are placed every ",
 Cell[BoxData[
  FormBox[
   StyleBox["lt",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "423567d7-e3af-46ad-ab7a-30b80e7c1214"],
 " cells with frequency \[Omega] and phase \[Phi]. \[Delta] is used as the \
offset between lights and stations (it can be negative). The first ",
 Cell[BoxData[
  FormBox[
   StyleBox["los",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "6326467b-fe6d-47dd-853f-8a76fd7ac14f"],
 " cells are always empty. The first station is placed at position ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["los",
     FontSlant->"Italic"], "+", "1"}], TraditionalForm]],ExpressionUUID->
  "35892cf7-13fc-4d41-add2-84182d47b4ab"],
 ", the second at position ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["los",
     FontSlant->"Italic"], "+", "1", "+", 
    StyleBox["st",
     FontSlant->"Italic"]}], TraditionalForm]],ExpressionUUID->
  "06bb3e84-cf81-450c-bbc5-60b78220bba3"],
 ", the ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "9870a334-91a7-4cab-933d-89dc0dbefc10"],
 "-th station at position ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["los",
     FontSlant->"Italic"], "+", "1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"i", "-", "1"}], ")"}], " ", "\[Cross]", 
     StyleBox["st",
      FontSlant->"Italic"]}]}], TraditionalForm]],ExpressionUUID->
  "09c46dd7-feb2-401d-8e05-0c3dc6745f36"],
 ". The first light is placed at position ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["los",
     FontSlant->"Italic"], "+", "1", "+", "\[Delta]"}], TraditionalForm]],
  ExpressionUUID->"f20e0298-9a32-4709-abc3-774128556c69"],
 ", the second at position ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["los",
     FontSlant->"Italic"], "+", "1", "+", "\[Delta]", "+", 
    StyleBox["lt",
     FontSlant->"Italic"]}], TraditionalForm]],ExpressionUUID->
  "e73aa7f9-0a4c-472b-b22d-84944fcbe066"],
 ", the ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]],ExpressionUUID->
  "7d6c9fcb-ca52-462c-b30d-b701e5012efd"],
 "-th station at position ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["los",
     FontSlant->"Italic"], "+", "1", "+", "\[Delta]", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"j", "-", "1"}], ")"}], " ", "\[Cross]", 
     StyleBox["lt",
      FontSlant->"Italic"]}]}], TraditionalForm]],ExpressionUUID->
  "c978a633-98b9-41fb-b7ae-8f3154b54f84"],
 ". The buses start full and with velocity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],ExpressionUUID->
  "5ab5448a-8a57-4bff-b43f-3c386d2d01f6"],
 ".\n"
}], "Text",
 CellChangeTimes->{{3.771871244928797*^9, 3.7718712483825274`*^9}, {
   3.77187160569071*^9, 3.771871702094483*^9}, {3.7718733360140657`*^9, 
   3.771873401542041*^9}, {3.7718734360307283`*^9, 3.77187346634893*^9}, 
   3.772197975760851*^9, 3.772198012512244*^9, {3.772198047631784*^9, 
   3.772198163414804*^9}, {3.772198815135693*^9, 3.772198851502405*^9}, {
   3.772208341330921*^9, 3.7722085483953037`*^9}, {3.772211050269682*^9, 
   3.772211082901229*^9}, {3.774890995808638*^9, 3.774891011651033*^9}, {
   3.774891062116765*^9, 3.7748910652751513`*^9}, {3.7748922910509243`*^9, 
   3.774892301772533*^9}, {3.774892414282013*^9, 3.77489244553691*^9}, {
   3.775492058885223*^9, 3.77549206024189*^9}, 3.777302124840261*^9, {
   3.777647952823143*^9, 3.777647954303925*^9}, {3.777647985763485*^9, 
   3.777648077543579*^9}, {3.777648116597684*^9, 
   3.777648200202442*^9}},ExpressionUUID->"04974618-db90-4061-908a-\
01d776eee45d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeTrack", "[", 
    RowBox[{"size_Integer", ",", 
     RowBox[{"\[Rho]_", "/;", 
      RowBox[{"0", "\[LessEqual]", "\[Rho]", "\[LessEqual]", "1"}]}], ",", 
     RowBox[{"st_Integer", "?", "Positive"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lt_Integer", "?", "Positive"}], ",", 
       RowBox[{"\[Omega]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Phi]_", "?", "NumericQ"}]}], "}"}], ",", 
     "\[Delta]_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"track", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "2", "}"}], ",", 
          RowBox[{"{", "size", " ", "}"}]}], "]"}]}], ",", 
       RowBox[{"bus", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "p"}], "}"}]}], 
         "]"}]}], ",", 
       RowBox[{"headsat", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"RandomSample", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"w", "+", "1"}], ",", " ", "size"}], " ", "]"}], ",", 
           RowBox[{"Floor", "[", 
            RowBox[{"\[Rho]", 
             FractionBox[
              RowBox[{" ", "size", " "}], 
              RowBox[{"w", "+", "1"}]]}], "]"}]}], "]"}], "]"}]}], ",", 
       "pairs", ",", "overlaps"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Put", " ", "the", " ", "stations", " ", "every", " ", "st"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"track", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"st", " ", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "+", "1"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Floor", "[", 
                  FractionBox["size", "st"], "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"Round", "[", 
                  RowBox[{
                   RowBox[{"RandomReal", "[", "]"}], "p"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"Floor", "[", 
                FractionBox["size", "st"], "]"}]}], "]"}]}], "}"}]}], "]"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Put", " ", "the", " ", "lights", " ", "every", " ", "lt"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"track", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"lt", " ", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "+", "\[Delta]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Floor", "[", 
                  FractionBox["size", "lt"], "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"\[Omega]", ",", "\[Phi]", ",", "0"}], "}"}], "}"}], 
               ",", 
               RowBox[{"Floor", "[", 
                FractionBox["size", "lt"], "]"}]}], "]"}]}], "}"}]}], "]"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"put", " ", "the", " ", "buses"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "make", " ", "sure", " ", "no", " ", "bus", " ", "is", " ", "on", " ", 
        "top", " ", "of", " ", "another"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"headsat", ",", "2", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"overlaps", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"pairs", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "<", 
           RowBox[{"w", "+", "1"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"overlaps", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"headsat", "=", 
          RowBox[{"headsat", "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "w", "+", "1"}]}], 
               "]"}], "&"}], "/@", "overlaps"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pairs", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{"headsat", ",", "2", ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"overlaps", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"pairs", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "<", 
              RowBox[{"w", "+", "1"}]}], "&"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"now", " ", "put", " ", "the", " ", "buses"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "headsat", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pairs", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"headsat", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", "w"}], ",", 
                RowBox[{"headsat", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "bus"}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"track", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{"track", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "pairs"}], "]"}]}], ";"}]}],
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "add", " ", "los", " ", "empty", " ", "spaces", " ", "at", " ", "the", 
        " ", "beggining", " ", "and", " ", "los", " ", "empty", " ", "spaces",
         " ", "at", " ", "the", " ", "end"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "los"}], "]"}], ",", 
          RowBox[{"track", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "los"}], "]"}]}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "los"}], "]"}], ",", 
          RowBox[{"track", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "los"}], "]"}]}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0GtI02EYBfC1EI2Esg9DZUW60m7TrJhuqTXLBA0pdYoQlGI5aTQJWS1B
Q7fRZZWM1sUtChFMjCgwb6Wm5QWzTQprrTLbdOj2n4LX8ddc73k/PPzgHM6X
J6JQmXWey+Fw4shBX1zXSmo4I1XFy9adIL4PmRbC0PLNMXDNqj4Mj9tN1MhM
h3aS2D+r00OrPKsW+gVzJjjWxvbBW7bbNlg2Y2agQ/V0Dq4F+SfdxOv5jAue
tGZ44a8p+yxkfweGeIiSR0PbYJN6xA7ZlH0uWMbIluHzlrt+aM7mhTHEx3yW
6mwoOQTbbDUi+PFLrhE6FvsfwqSizh4vUcS/8Ql2qbxLsDt7dJnmal7ADLFw
bxQP1j67coBq4hyFzJhMGrSdkYr9OmrCj1IlPBV+rBQ27rdoYMfwVi105+3S
Q9c3BbX3r6EGFgbIDNBZsToHX2x6vQDDBULBBmKRPIl6jS0WwSqXXQwVGyuT
YTKbcgSec99Ph7sDm6iNxvjTcEDSTB3UduihpbvyHozMkZig5lXYE5jTLq2j
fW5dA9xzwfAGJv5ZaIXj7dF9dFegH4BXc6fn4VCwbAHmjexojoogf1acpVbr
xG9hzPrqfigq8UxAu6rcA6e4vaPRRN8d3XdYz83/JySaDQVUS8K78VjiUtoH
6hnZy0tpOxkpJ/ZiBczs+dwCW8eLO6Ev0jqcTnxgzPoJgxWJTnh5ljsBV1OV
8/Crhr8IbYapFeg+yHAyiDdH5rfAKvlgKPwPoNd9tA==
  "],
 CellLabel->"In[17]:=",ExpressionUUID->"b7869e27-90a2-4a54-92e6-482fc99ea5ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["Buses", "Section",
 CellChangeTimes->{{3.747237625158515*^9, 
  3.747237629684988*^9}},ExpressionUUID->"a8b112f3-2448-4781-88eb-\
341c7082f57f"],

Cell[TextData[{
 "A bus is modeled as a sequence of lists, the head of the bus (rightmost \
list) is different from the wagons (lists to the left of the head).\n\t\
\[EmptySmallCircle] head: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["v", "i"], ",", 
     SubscriptBox["s", "i"], ",", 
     SubscriptBox["p", "i"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "3c45a063-a12f-4626-8611-1dd5a179b3aa"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", " ", 
    SubscriptBox["v", "i"], "\[LessEqual]", " ", 
    SubscriptBox["v", "max"]}], TraditionalForm]],ExpressionUUID->
  "3a7b5a57-c963-4cc1-a4cb-596e9fef70db"],
 " the speed that the bus had the previous tick, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "5bebefe3-1f68-439b-a6bf-c87e7ce1f7d6"],
 " the load status, and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", " ", 
    SubscriptBox["p", "i"], "\[LessEqual]", " ", "p"}], TraditionalForm]],
  ExpressionUUID->"21c6c373-48e8-400a-b92a-99019bde4748"],
 " the amount of passengers.\n\t\t\[EmptySquare] The load status: 0 is moving \
or ready to move, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"1", ",", "r"}], "}"}], TraditionalForm]],ExpressionUUID->
  "9a76100d-c8e1-4a7b-abed-a9ca337b755d"],
 " is unloading (",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "d266a3dc-0188-45a7-b203-5b298eec932a"],
 " keeps track of the ticks needed to finish unloading), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"2", ",", 
     StyleBox["pl",
      FontSlant->"Italic"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "6eedadfa-633e-4a86-a0c1-cedaf9172eef"],
 " is loading (loading happens until the bus is filled or there are no \
passengers in the station; ",
 Cell[BoxData[
  FormBox[
   StyleBox["pl",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "fc9b0b80-6d45-42f0-91dd-0b02bef9ae5b"],
 " is the amount of passengers in the previous tick).\n\t\[EmptySmallCircle] \
wagon: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    SubscriptBox["p", "i"], "}"}], TraditionalForm]],ExpressionUUID->
  "87ebd38d-de71-4c1e-9f67-bcffa70dbe8b"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", " ", 
    SubscriptBox["p", "i"], "\[LessEqual]", " ", "p"}], TraditionalForm]],
  ExpressionUUID->"899f5d7a-4cd1-4c67-afe8-b5c5ffeaec46"],
 " the amount of passengers."
}], "Text",
 CellChangeTimes->{{3.7472376720919437`*^9, 3.7472376938466043`*^9}, {
   3.747237736903092*^9, 3.74723773942349*^9}, {3.7472380818491497`*^9, 
   3.74723824407439*^9}, {3.747238279177437*^9, 3.747238491476478*^9}, 
   3.747239473691678*^9, {3.7472395184087467`*^9, 3.747239519296631*^9}, {
   3.748548537738312*^9, 3.748548597135934*^9}, {3.756057117985715*^9, 
   3.7560571493445587`*^9}, {3.756057443403653*^9, 3.756057548794032*^9}, {
   3.756057659153483*^9, 3.756057694817011*^9}, {3.756058162447485*^9, 
   3.7560581786216917`*^9}, {3.7563223359281273`*^9, 
   3.7563223867498093`*^9}, {3.759166008448511*^9, 
   3.7591660154793863`*^9}},ExpressionUUID->"ac33a864-65c0-4f37-b150-\
38ae66143e2f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test cases", "Section",
 CellChangeTimes->{{3.748191431513535*^9, 3.7481914360603037`*^9}, {
  3.748193741121952*^9, 
  3.748193744500205*^9}},ExpressionUUID->"b0d0f650-268d-4607-8117-\
169c38e036ce"],

Cell["brake cases (5, 19, 30, 35, 41, 99, 240, 348, 448, 1427)", "Text",
 CellChangeTimes->{{3.7476741400739202`*^9, 3.74767414502923*^9}, {
  3.749233177449691*^9, 3.7492332006821947`*^9}, {3.756060843143116*^9, 
  3.756060844087327*^9}, {3.7560609735645037`*^9, 3.756060982565888*^9}, {
  3.7560655931760197`*^9, 3.756065595599769*^9}, {3.758474141551765*^9, 
  3.758474153263773*^9}, {3.7584746502872343`*^9, 3.75847467908674*^9}, {
  3.7663393778276033`*^9, 
  3.766339382762556*^9}},ExpressionUUID->"63d0b6a7-1d72-4561-8aee-\
350d800681da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vmax", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "ahead"}], ",", " ", 
    RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"15", ";;", "19"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Round", "[", 
        RowBox[{"vmax", "/", "2"}], "]"}], ",", "0", ",", "0"}], "}"}]}], 
    "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "ahead"}], ",", " ", 
    RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"26", ";;", "29"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "30", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "ahead"}], ",", " ", "stoped", ",", " ", "wait"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"31", ";;", "34"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "35", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "ahead"}], ",", " ", 
    RowBox[{"going", " ", "slow"}], ",", " ", "hold"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"94", ";;", "97"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "98", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "red", " ", "light", " ", "ahead", " ", "with", " ", "bus", " ", "before",
      " ", "light"}], "*)"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"37", ";;", "40"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "41", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "station", " ", "ahead", " ", "with", " ", "bus", " ", "before", " ", 
      "station"}], ",", " ", "brake"}], "*)"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"236", ";;", "239"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "240", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vmax", "-", "2"}], ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"station", " ", "ahead"}], ",", " ", "fast", ",", " ", "brake"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"344", ";;", "347"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "348", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"station", " ", "ahead"}], ",", " ", "close", ",", " ", "slow", 
    ",", " ", "accelerate"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"444", ";;", "447"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "448", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"station", " ", "ahead"}], ",", " ", "close", ",", " ", "fast", 
    ",", " ", "brake"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1423", ";;", "1426"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}],
  Background->RGBColor[1, 0.5, 0.5]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "1427", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"14", ",", "0", ",", "1"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"station", " ", "ahead"}], ",", " ", "far", ",", " ", "fast", 
     ",", " ", "?"}], "*)"}], ";"}],
  Background->RGBColor[1, 0.5, 0.5]]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756059840119279*^9, 3.756059849189701*^9}, {
   3.756060024289875*^9, 3.7560600333432713`*^9}, 3.756060071721843*^9, {
   3.756060147244348*^9, 3.756060147531188*^9}, {3.756060252081932*^9, 
   3.7560602824468184`*^9}, 3.756060362438233*^9, {3.756060444090375*^9, 
   3.756060446986011*^9}, {3.7560607345780563`*^9, 3.7560607410603228`*^9}, {
   3.756060895490984*^9, 3.756060911931713*^9}, 3.7560609466636057`*^9, {
   3.75606558284133*^9, 3.756065604194254*^9}, 3.75615383516625*^9, 
   3.756328893796135*^9, {3.758474135025779*^9, 3.758474137009102*^9}, {
   3.758474637728314*^9, 3.75847467382403*^9}, {3.758748199542674*^9, 
   3.758748199965823*^9}, {3.766339401964815*^9, 3.76633942202724*^9}, {
   3.766339464138912*^9, 3.766339473506234*^9}, 3.766339918802454*^9, {
   3.766340046051415*^9, 3.766340047584634*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"66ef6297-4ac6-4ef5-819e-ec40d1288576"],

Cell["Acceleration cases (41, 64, 104) ", "Text",
 CellChangeTimes->{{3.747671810465378*^9, 3.74767181610982*^9}, {
   3.749233208241004*^9, 3.7492332245197573`*^9}, {3.7560656239748983`*^9, 
   3.756065629520073*^9}, 
   3.756325187479982*^9},ExpressionUUID->"9f7925ca-5235-4f99-b779-\
fd5f8b16794b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"60", ";;", "63"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "64", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{"accelerate", ",", " ", 
    RowBox[{"nothing", " ", "nearby"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"100", ";;", "103"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "104", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{"light", " ", "behind"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"283", ";;", "286"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "287", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "far", " ", "ahead"}], ",", " ", 
    RowBox[{"going", " ", "slow"}]}], "*)"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7475737958997793`*^9, 3.747573863856892*^9}, {
   3.747593846473525*^9, 3.747593957424458*^9}, {3.7476697584490433`*^9, 
   3.747669783575808*^9}, {3.747674290254483*^9, 3.747674320003202*^9}, {
   3.747674394556715*^9, 3.7476744124883347`*^9}, {3.747674513886142*^9, 
   3.747674514523498*^9}, 3.748017642108061*^9, {3.748549182680806*^9, 
   3.748549186622135*^9}, {3.749231595382606*^9, 3.749231690972623*^9}, {
   3.749232133349145*^9, 3.749232142193492*^9}, {3.7496728178797703`*^9, 
   3.749672823718334*^9}, {3.749672872318117*^9, 3.749672892045418*^9}, 
   3.7560656207968807`*^9, {3.756328903066265*^9, 3.756328908441016*^9}, {
   3.7575322236909733`*^9, 3.757532225588779*^9}, {3.757532359152289*^9, 
   3.757532432470152*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"8df18c66-b716-420e-b945-a5db70389fb8"],

Cell["\<\
station cases (50, 150,  550, 650, 750, 850, 950, 1050, 1150, 1250). 
The stations are at positions\
\>", "Text",
 CellChangeTimes->{{3.749232087222259*^9, 3.749232094536237*^9}, {
   3.749233228061178*^9, 3.749233251411971*^9}, {3.7492333903928556`*^9, 
   3.74923339296726*^9}, {3.749317776101987*^9, 3.749317786615075*^9}, {
   3.749388042887443*^9, 3.74938805303113*^9}, {3.7493883328334827`*^9, 
   3.7493883354817142`*^9}, {3.750013165417955*^9, 3.7500131689215612`*^9}, {
   3.750013344677369*^9, 3.750013348294696*^9}, {3.756327588526321*^9, 
   3.7563276392772303`*^9}, 3.7584748085402203`*^9, {3.758474912547195*^9, 
   3.7584749138191*^9}, {3.758475003673604*^9, 3.758475007025482*^9}, {
   3.7584751785191803`*^9, 3.7584751847029963`*^9}, {3.758475296023569*^9, 
   3.758475297447941*^9}, {3.758475373800145*^9, 3.758475383135778*^9}, {
   3.758481105934627*^9, 
   3.758481107127142*^9}},ExpressionUUID->"4ec388ea-1684-4fb1-bde0-\
166c3d766324"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "_", "}"}]}], "]"}], "//", "Flatten"}]], "Input",
 CellChangeTimes->{{3.7493174650087757`*^9, 3.7493174651688766`*^9}, {
   3.756066174662869*^9, 3.756066175125661*^9}, 3.756066329708254*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"657c5e0a-a3a4-457a-88a1-52b23694d15f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "50", ",", "150", ",", "250", ",", "350", ",", "450", ",", "550", ",", 
   "650", ",", "750", ",", "850", ",", "950", ",", "1050", ",", "1150", ",", 
   "1250", ",", "1350", ",", "1450", ",", "1550", ",", "1650", ",", "1750", 
   ",", "1850", ",", "1950"}], "}"}]], "Output",
 CellChangeTimes->{3.749233377341728*^9, 3.749234402266046*^9, 
  3.749317399541057*^9, 3.7493174658738623`*^9, 3.756066330402842*^9, 
  3.7561519225414457`*^9, 3.756322284349333*^9, 3.756903818957389*^9, 
  3.757513353660935*^9, 3.758379683918743*^9, 3.758473157362357*^9, 
  3.758475483175642*^9, 3.758481535225829*^9, 3.758729043679577*^9, 
  3.759166035584758*^9, 3.759853848115035*^9, 3.764855453096661*^9, 
  3.769337076947774*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"4c7f16d7-1e6a-4748-adc3-521923ca3826"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"46", ";;", "49"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "50", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", 
    RowBox[{"ready", " ", "to", " ", "move"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"146", ";;", "149"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "150", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", "brake", 
    ",", " ", 
    RowBox[{"go", " ", "directly", " ", "to", " ", "loading"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"546", ";;", "549"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "550", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"\[Lambda]\[Upsilon]", "-", "1"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}], 
    ",", 
    RowBox[{
    "unload", " ", "and", " ", "change", " ", "status", " ", "to", " ", 
     "load"}]}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"646", ";;", "649"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "650", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"p", "/", "2"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}], 
    ",", " ", 
    RowBox[{"keeps", " ", "unloading"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"746", ";;", "748"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "749", "]"}], "]"}], "=", 
   RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "750", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}], 
    ",", 
    RowBox[{
    "unload", " ", "and", " ", "change", " ", "status", " ", "to", " ", 
     "load"}]}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"846", ";;", "849"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "850", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "950", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]\[Upsilon]", "-", "4"}], ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"946", ";;", "949"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "950", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1050", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3", "\[Lambda]\[Upsilon]"}], ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1046", ";;", "1049"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1050", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"p", "-", "\[Lambda]\[Upsilon]", "+", "3"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], ",",
     " ", "fill", ",", " ", 
    RowBox[{"change", " ", "to", " ", "0"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1150", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"5", "\[Lambda]\[Upsilon]"}], ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1146", ";;", "1149"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1150", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"p", " ", "w"}], "+", "\[Lambda]\[Upsilon]"}]}], "}"}], ",", 
     "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], ",",
     " ", 
    RowBox[{"tricked", " ", "to", " ", "change", " ", "to", " ", "0"}]}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1246", ";;", "1249"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1250", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "am", "]"}], "-", 
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "am", "]"}], "/", "2"}], "]"}]}], ",", "0", ",", 
     "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", "brake", 
    ",", " ", 
    RowBox[{"go", " ", "start", " ", "unloading"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1446", ";;", "1449"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1450", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Round", "[", 
        FractionBox[
         RowBox[{"p", 
          RowBox[{"(", 
           RowBox[{"w", "+", "1"}], ")"}]}], "\[Lambda]\[Upsilon]"], "]"}]}], 
      "}"}], ",", "p"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", 
    RowBox[{
    "stay", " ", "here", " ", "for", " ", "loads", " ", "of", " ", "time"}]}],
    "*)"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.749317231138932*^9, 3.74931728316156*^9}, {
   3.749317316717847*^9, 3.7493173171099977`*^9}, {3.749317356872324*^9, 
   3.7493173694272413`*^9}, {3.749317479179035*^9, 3.749317491500669*^9}, {
   3.749317796545979*^9, 3.749317857822126*^9}, {3.749320181729562*^9, 
   3.749320193659864*^9}, {3.7493205179167957`*^9, 3.749320574429921*^9}, 
   3.749320648712331*^9, {3.749320979940587*^9, 3.749320989193927*^9}, {
   3.74932102644475*^9, 3.749321051214665*^9}, {3.7493880692412367`*^9, 
   3.749388116121711*^9}, {3.749388149060318*^9, 3.749388153250551*^9}, {
   3.7496710280966873`*^9, 3.749671073461565*^9}, {3.7496734160135393`*^9, 
   3.749673418484551*^9}, {3.74967390433278*^9, 3.74967390731649*^9}, {
   3.749674096257251*^9, 3.749674177336266*^9}, {3.7497520458958673`*^9, 
   3.749752050405943*^9}, {3.7500131243418903`*^9, 3.750013225442363*^9}, {
   3.750013322455677*^9, 3.750013376686771*^9}, {3.7500134126628847`*^9, 
   3.7500134144064817`*^9}, {3.750272068575433*^9, 3.750272072341571*^9}, {
   3.750273716985381*^9, 3.750273745950739*^9}, {3.750273807916534*^9, 
   3.750273836998466*^9}, {3.7502738762159033`*^9, 3.750273958340926*^9}, {
   3.756151936184614*^9, 3.756151936551824*^9}, 3.756327575610566*^9, 
   3.7584741268360157`*^9, {3.758474631201727*^9, 3.758474710255578*^9}, {
   3.7584747733179893`*^9, 3.758474780253954*^9}, {3.758474818245137*^9, 
   3.758474891547885*^9}, {3.758474979458723*^9, 3.758474999492812*^9}, {
   3.7584750725923634`*^9, 3.758475135856126*^9}, {3.758475167167807*^9, 
   3.7584754428810453`*^9}, {3.758475506051469*^9, 3.758475515408648*^9}, {
   3.758481077138793*^9, 3.758481162094837*^9}, {3.758483235566243*^9, 
   3.758483250100576*^9}, {3.75848328054144*^9, 3.758483303763611*^9}, {
   3.758483403986442*^9, 3.758483423857025*^9}, {3.758485655180566*^9, 
   3.758485676682671*^9}, 3.7663359903775253`*^9, {3.766336042941881*^9, 
   3.7663360843328753`*^9}, {3.766336152059517*^9, 3.766336155299403*^9}, 
   3.7663362008916817`*^9, {3.766336257809786*^9, 3.766336318625123*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"b64af6ad-5580-4c4a-8833-42682b32afa8"],

Cell["\<\
light cases (200, 300, 400, 495, 594, 698).
The lights are at positions\
\>", "Text",
 CellChangeTimes->{{3.749232087222259*^9, 3.749232094536237*^9}, {
  3.74923220678028*^9, 3.749232207480122*^9}, {3.7492333974422283`*^9, 
  3.749233407700226*^9}, {3.7493200417502413`*^9, 3.749320078524002*^9}, {
  3.756328922896523*^9, 
  3.756328952344543*^9}},ExpressionUUID->"86d18cb1-de72-4495-ba5d-\
675fa7c601e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Position", "[", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}], "}"}]}], "]"}], "//", 
  "Flatten"}]], "Input",
 CellChangeTimes->{{3.756327852828023*^9, 3.756327854491337*^9}, {
  3.758737683160282*^9, 3.758737683477762*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"38fa66e0-66e7-492a-b4e0-40048fa82e3f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "100", ",", "200", ",", "300", ",", "400", ",", "500", ",", "600", ",", 
   "700", ",", "800", ",", "900", ",", "1000", ",", "1100", ",", "1200", ",", 
   "1300", ",", "1400", ",", "1500", ",", "1600", ",", "1700", ",", "1800", 
   ",", "1900", ",", "2000"}], "}"}]], "Output",
 CellChangeTimes->{3.7492334409628353`*^9, 3.749234407235713*^9, 
  3.756327857093831*^9, 3.756903819001604*^9, 3.757513353693927*^9, 
  3.758379683954102*^9, 3.758475451630332*^9, 3.7584815352780733`*^9, 
  3.758729043714582*^9, 3.758737642310013*^9, 3.7587376841426992`*^9, 
  3.759166035617086*^9, 3.759853848152367*^9, 3.764855453135209*^9, 
  3.769337076972206*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"c5df0ecc-02df-462e-b671-46742a4134f7"]
}, Open  ]],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"196", ";;", "199"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "200", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"3", ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"red", " ", "light"}], ",", " ", 
     RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
     RowBox[{"bus", " ", "moving"}], ",", " ", "stop"}], "*)"}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"296", ";;", "299"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "300", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"red", " ", "light"}], ",", " ", 
     RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
     RowBox[{"bus", " ", "stoped"}], ",", " ", "wait"}], "*)"}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"396", ";;", "399"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "400", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "am", "]"}], "+", "1"}], ",", "0", ",", "0"}], 
     "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Red", " ", "light"}], ",", " ", 
     RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
     RowBox[{"bus", " ", "moving", " ", "fast"}], ",", " ", "move"}], "*)"}], 
   ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "500", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     "1"}], ";"}], " "}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"491", ";;", "494"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "495", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"vmax", ",", "0", ",", "0"}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"green", " ", "light"}], ",", " ", "move"}], "*)"}], ";"}], 
   " "}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"590", ";;", "593"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "594", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", ",", 
     " ", "hold"}], "*)"}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"694", ";;", "697"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}],
  Background->None], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "698", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"red", " ", "light"}], ",", " ", "close", ",", " ", "slow", ",", 
     "hold"}], "*)"}], ";"}],
  Background->None]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7492336763374367`*^9, 3.749233853603043*^9}, {
   3.749233931397645*^9, 3.749233940445043*^9}, {3.7493183747792053`*^9, 
   3.7493184297962103`*^9}, {3.749318465279415*^9, 3.749318486894908*^9}, {
   3.749319447917459*^9, 3.7493194483139353`*^9}, {3.749320670974909*^9, 
   3.749320677415721*^9}, {3.7493207198006477`*^9, 3.7493207748645277`*^9}, {
   3.749321100272026*^9, 3.7493211252260323`*^9}, {3.749321639263977*^9, 
   3.749321675679863*^9}, 3.7493883064887857`*^9, {3.749670908930612*^9, 
   3.749670934728552*^9}, {3.749673182167342*^9, 3.749673182776807*^9}, {
   3.749674247663782*^9, 3.749674250927023*^9}, {3.749674341709115*^9, 
   3.749674344557102*^9}, {3.750943038654907*^9, 3.7509430387893887`*^9}, 
   3.7563287606725473`*^9, {3.7587380734422293`*^9, 3.7587380793269*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"048bab5f-774c-4caa-96dd-24eff9fbbb55"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Chapter",
 CellChangeTimes->{{3.748191431513535*^9, 
  3.7481914360603037`*^9}},ExpressionUUID->"9dc19ae6-ecbb-48d3-bb5c-\
448b820f668c"],

Cell[CellGroupData[{

Cell["Base functions", "Section",
 CellChangeTimes->{{3.765715021750127*^9, 
  3.765715028381115*^9}},ExpressionUUID->"b8432c32-f3a0-48bd-b0e7-\
4529f055a04e"],

Cell[TextData[{
 "These decide the behavior of the accelerations, ",
 Cell[BoxData[
  FormBox[
   StyleBox["accelerate",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "71044003-9aef-423c-b394-13a692c82028"],
 " augments the speed according to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "+"], TraditionalForm]],ExpressionUUID->
  "25db3287-d077-4016-9824-8d363ce65c4f"],
 " but never above ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "max"], TraditionalForm]],ExpressionUUID->
  "a61d790f-a98b-4b4f-8300-881baf515c2a"],
 ". To diminish the speed use ",
 StyleBox["brake",
  FontWeight->"Bold"],
 ", it never diminishes the speed below 0 and it takes an optional argument \
for a negative acceleration different from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "-"], "."}], TraditionalForm]],ExpressionUUID->
  "6f01fdd9-d9c0-4617-b0a6-7631b25348ac"]
}], "Text",
 CellChangeTimes->{{3.748123632424643*^9, 3.748123805854216*^9}, {
  3.749738342757679*^9, 3.749738345643572*^9}, {3.749738600287261*^9, 
  3.749738614806486*^9}},ExpressionUUID->"cef8119a-37ae-403f-8a67-\
fd6459261552"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"accelerate", "[", "i_Integer", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"i", "+", "ap"}], ",", 
         RowBox[{
          RowBox[{"i", "+", "ap"}], "\[LessEqual]", "vmax"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"vmax", ",", 
         RowBox[{
          RowBox[{"i", "+", "ap"}], ">", "vmax"}]}], "}"}]}], "}"}], ",", 
     "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"brake", "[", 
   RowBox[{"i_Integer", ",", 
    RowBox[{"negacc_Integer:", "am"}]}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i", "+", "negacc"}], ",", 
        RowBox[{
         RowBox[{"i", "+", "negacc"}], "\[GreaterEqual]", " ", "0"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"i", "+", "negacc"}], "<", "0"}]}], "}"}]}], "}"}], ",", 
    "0"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.747589599535859*^9, 3.747589613449592*^9}, {
  3.747589689781673*^9, 3.747589782497353*^9}, {3.747593223540167*^9, 
  3.74759330210076*^9}, {3.747593354776238*^9, 3.7475934020227013`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"facaedda-76bc-402b-9b48-ae74826e3f46"],

Cell[TextData[{
 "This function creates a bus with probability ",
 Cell[BoxData[
  FormBox["\[Rho]b", TraditionalForm]],ExpressionUUID->
  "0c1d8da8-4a92-4edf-9f7d-e7fec295abfb"],
 ",  with ",
 Cell[BoxData[
  FormBox["w", TraditionalForm]],ExpressionUUID->
  "15cd1c57-90cf-498c-bdc9-57aa8ff76faf"],
 " wagons, it starts with full speed and full of pasengers. The function \
receives a track, if there is a bus on the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"w", "+", "vmax", "-"}], "|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],ExpressionUUID->
  "1213ce71-f58f-4cd0-9d2b-5c4fe71859e6"],
 " blocks it does nothing, if not, it puts a new bus. Buses start empty."
}], "Text",
 CellChangeTimes->{{3.747239593281732*^9, 3.747239626637972*^9}, {
   3.747239656777773*^9, 3.747239685732884*^9}, {3.747239885233486*^9, 
   3.747239898811108*^9}, {3.747242372202776*^9, 3.7472423899073257`*^9}, {
   3.7472429636354*^9, 3.747243078751562*^9}, {3.747243994909453*^9, 
   3.747244001222211*^9}, {3.756058757394112*^9, 3.756058813562361*^9}, {
   3.756058884349334*^9, 3.756058893092087*^9}, 3.759853866112393*^9, {
   3.7722087581731033`*^9, 
   3.7722087686839867`*^9}},ExpressionUUID->"e38bb641-3464-41d7-8566-\
b58e1838f651"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"newbus", "[", 
    RowBox[{"t_List", "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"w", "+", "1", "+", "los"}]}], "]"}], "]"}], "\[Equal]", 
      "base"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomReal", "[", "]"}], "\[LessEqual]", " ", "\[Rho]b"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"t", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "i"}], "}"}], "\[Rule]", 
            RowBox[{"{", "p", "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"w", "+", "1"}]}], "}"}], "->", 
          RowBox[{"{", 
           RowBox[{"vmax", ",", "0", ",", "p"}], "}"}]}]}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newbus", "[", "t_List", "]"}], ":=", "t"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvYJr5RWv168dP4iuA9PToi7eBNEKfTNugeg/7Uce
guiOyTMegehjK/qfgehHO0+AaaMFR7+A6DXeuj9AdBb7vD8g2qbSgMEbSPOF
CXwG0XkJAt9AdIrITzYfIF2hpckOooN0jiiD6EuX7qqBaIXKFh0QbRu8Sh9E
T0q72AmiN//J7AbRG5LmBfoC6S92AcEgOmlJUwSIjjzYFQWiy5TctE+9fe2Y
/URdF0RL9fzLEPr02lEpcV0miL6w0kVG9g/Q3exhYJrpmIQeiK5g5DAA0U7b
6osLRN84Tv1kUgKii5aLXHol9cZRnysdTAMAEraitA==
  "],
 CellLabel->"In[83]:=",ExpressionUUID->"0186486b-a385-4862-bf74-d6471580f8ed"],

Cell["\<\
This builds the minimal neighborhood (LOS) for each bus, the logic for \
movement is: build the neighborhood, then move the buses (only in the \
neighborhood), finally, update the buses positions. heads are used later\
\>", "Text",
 CellChangeTimes->{{3.748195395526585*^9, 3.748195478233656*^9}, {
   3.748195538688464*^9, 3.748195545206846*^9}, {3.749157020744774*^9, 
   3.749157022616678*^9}, 
   3.76933699905886*^9},ExpressionUUID->"ea6d7524-6856-450f-a7bb-\
9bb6fc170580"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"heads", "=", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.747580893901483*^9, 3.7475809105143414`*^9}, {
  3.747581004987136*^9, 3.74758100720737*^9}, {3.748549421292107*^9, 
  3.748549422218363*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"eef9f21a-f8a4-46b2-abf0-a43456a436a7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5", ",", "19", ",", "30", ",", "35", ",", "41", ",", "50", ",", "64", ",", 
   "98", ",", "104", ",", "150", ",", "200", ",", "240", ",", "287", ",", 
   "300", ",", "348", ",", "400", ",", "448", ",", "495", ",", "550", ",", 
   "594", ",", "650", ",", "698", ",", "750", ",", "850", ",", "950", ",", 
   "1050", ",", "1150", ",", "1250", ",", "1427", ",", "1450"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7484481470339317`*^9, 3.7485468536983356`*^9, 3.74854722059881*^9, {
   3.7485494003247023`*^9, 3.748549423134107*^9}, 3.7492340843191233`*^9, 
   3.7493892672917967`*^9, 3.74948848372478*^9, 3.749670843079938*^9, 
   3.7496738271148376`*^9, 3.749674193265051*^9, 3.750002318955509*^9, 
   3.750012734636779*^9, 3.750270390536581*^9, 3.750429524488081*^9, 
   3.750429706123736*^9, 3.7507118802497663`*^9, 3.756059256253076*^9, 
   3.756903824657819*^9, 3.757513329834244*^9, 3.757513363910578*^9, 
   3.757532442976603*^9, 3.7583796998442583`*^9, 3.7584778335829353`*^9, 
   3.758481203884131*^9, 3.758481548171183*^9, 3.758483318147333*^9, 
   3.758729052541617*^9, 3.7587383546526413`*^9, 3.7591660564137383`*^9, 
   3.764855453192054*^9, {3.769337053324499*^9, 3.769337081659603*^9}},
 CellLabel->
  "Out[102]=",ExpressionUUID->"f84c7d5e-a62f-4ede-9023-084e62dac5bb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"neighbors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "los"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "los"}]}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
    "heads"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.747580940473942*^9, 3.7475810153366747`*^9}, {
   3.747581063537075*^9, 3.747581063684557*^9}, {3.748546828749857*^9, 
   3.748546848377801*^9}, {3.749157044138102*^9, 3.749157058584968*^9}, {
   3.7492313691848*^9, 3.749231382216443*^9}, 3.749399912371464*^9, {
   3.7507114970422297`*^9, 3.750711497901966*^9}, {3.7693370379973*^9, 
   3.7693370459007473`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"b9edf46c-6814-4145-ba3d-ac497645b49d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"neighbors", "[", 
  RowBox[{"[", "6", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.748546860163143*^9, 3.748546889440895*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"fe0e60b6-0fa0-4d03-9d9e-50ccccd554d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "32"}], "}"}], ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.748546863623502*^9, 3.7485468897755632`*^9}, 
   3.748547226267893*^9, 3.74948848859696*^9, 3.7496741958583317`*^9, 
   3.7500127366754513`*^9, 3.7504295280543537`*^9, 3.750429710722238*^9, 
   3.756904389894868*^9, 3.758477836973317*^9, 3.758481551133594*^9, 
   3.759166059939372*^9, 3.764855453232943*^9, {3.769337058943451*^9, 
   3.769337088141429*^9}},
 CellLabel->
  "Out[104]=",ExpressionUUID->"7dd270f5-d41c-4d9e-a6f6-a7d7f0a4d488"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["movebottom", "Section",
 CellChangeTimes->{{3.756908997148981*^9, 
  3.756909007065099*^9}},ExpressionUUID->"9f4601e7-c16a-4a11-ae70-\
d9556c56ef94"],

Cell["\<\
Now, lets bus forward according to the following rules:
\t\[FilledSmallCircle] They must stop at red lights
\t\[FilledSmallCircle] They must stop at stations and remain stationary while \
loading or unloading passangers
\t\[FilledSmallCircle] They must brake if they may crash into the bus ahead.
\t\[FilledSmallCircle] Otherwise they accelerate to maximum speed and keep \
cruising at that speed.
The movement is simultaneous for all buses. The idea is to return the new \
position of the heads and the speed changes given the neighborhood of one bus.\
\>", "Text",
 CellChangeTimes->{{3.747511866992814*^9, 3.747511918911833*^9}, {
  3.747511954463647*^9, 3.747512086038766*^9}, {3.748195572955658*^9, 
  3.748195623951894*^9}, {3.756904692938826*^9, 
  3.756904726576531*^9}},ExpressionUUID->"762e159f-6c29-48ae-96d6-\
8d744d67d444"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["movebottom",
     FontWeight->"Bold"], "[", 
    StyleBox[
     RowBox[{
      RowBox[{"line_of", "_sight", "_neighborhood"}], ",", "spd"}],
     FontSlant->"Italic"], "]"}], TraditionalForm]],ExpressionUUID->
  "7fc18c16-556c-4fee-9248-fc0ec8af879f"],
 " only concerns itself with the movement with respect to other buses (it \
doesn\[CloseCurlyQuote]t care for lights or stations). It returns the new \
situation of the bus relative to the old one. The last argument is optional, \
if used it sets the speed to ",
 Cell[BoxData[
  FormBox[
   StyleBox["spd",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "e64c8158-240d-4e2a-9862-af85be08e52e"],
 ", should only be used when sure about ",
 Cell[BoxData[
  FormBox[
   StyleBox["spd",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "a6b271fa-5b60-46c4-9abc-3ae2ff316fe7"],
 "."
}], "Text",
 CellChangeTimes->{{3.7486233488289948`*^9, 3.748623522126315*^9}, {
  3.749744793337783*^9, 3.74974482066107*^9}, {3.757514592931611*^9, 
  3.757514612964838*^9}},ExpressionUUID->"857ad2ee-84cc-4eca-9153-\
fc7e0901a58d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sizepat", "=", 
  RowBox[{"ConstantArray", "[", 
   RowBox[{
    RowBox[{"{", "_", "}"}], ",", "w"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756904992342023*^9, 3.756905032778322*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"b6fe9b39-403a-48ca-a22f-369edabf4140"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "_", "}"}], ",", 
   RowBox[{"{", "_", "}"}], ",", 
   RowBox[{"{", "_", "}"}], ",", 
   RowBox[{"{", "_", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.756905075819442*^9, 3.757513638444756*^9, 3.7587402780645037`*^9, 
   3.759166064879031*^9, 3.75985388846577*^9, 3.761927519892097*^9, 
   3.762175403927288*^9, 3.7624412087477083`*^9, 3.7624519001615257`*^9, 
   3.763228222716765*^9, 3.763730932673176*^9, 3.763745999534617*^9, 
   3.763900353381*^9, 3.763902171481694*^9, 3.763918667118711*^9, 
   3.763990122721409*^9, 3.764599650395094*^9, 3.764600909857751*^9, 
   3.764849586408782*^9, 3.7648536353695927`*^9, {3.7648554527885637`*^9, 
   3.764855453281517*^9}, 3.764855485576572*^9, 3.764856066823042*^9, 
   3.764875485180808*^9, 3.764875544596273*^9, 3.76487574522661*^9, 
   3.764877967562188*^9, 3.765714529057631*^9, 3.765716122974463*^9, 
   3.7662315716103897`*^9, 3.766232164308714*^9, 3.766232533333734*^9, 
   3.7662328453719063`*^9, 3.766233566929747*^9, 3.766335218949534*^9, 
   3.766339998766115*^9, 3.7663402589967327`*^9, 3.7663405744922237`*^9, 
   3.766945973906685*^9, 3.766946785215468*^9, 3.7693376740105*^9, 
   3.7693443474460373`*^9, 3.769433087832837*^9, 3.769789225300619*^9, 
   3.769791184135008*^9, 3.769792561832602*^9, 3.7697974192077703`*^9, 
   3.771168056673793*^9, 3.771169905929497*^9, 3.771172280681191*^9, 
   3.771172590121871*^9, 3.771172939664716*^9, 3.7711737197897673`*^9, 
   3.771175956155521*^9, 3.771849806807231*^9, 3.7718504346884823`*^9, 
   3.7748906470554857`*^9, 3.775477087400584*^9, 3.775492115960693*^9, 
   3.775561263524126*^9, 3.7773013725390472`*^9, 3.777301543247429*^9, 
   3.777302463428969*^9, 3.777302559854527*^9, 3.777639859509218*^9, 
   3.777647865737137*^9, 3.777652637146244*^9, 3.7776588346768827`*^9, 
   3.7785035001784353`*^9, 3.778513238338606*^9, 3.778513717677348*^9, 
   3.7785145648305387`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"ee8418da-5ad3-4493-adac-cd4e7c328068"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions with messages", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 
  3.756909036722934*^9}},ExpressionUUID->"1b690565-d7a8-4daf-a73a-\
e64f5e361117"],

Cell[TextData[{
 "The most specific case: Bus is stopped, there is enough room to accelerate \
forward. Only works if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["a", "+"], "\[LessEqual]"}], "|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],ExpressionUUID->
  "4f680c6b-98b2-4837-8789-6891348de6fe"],
 "."
}], "Text",
 CellChangeTimes->{{3.756914168894032*^9, 3.756914269178179*^9}, {
  3.7569168672173243`*^9, 
  3.756916884952548*^9}},ExpressionUUID->"650a71d8-a1d4-46d8-a336-\
8c95c3f7f5db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Activate", "/@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Inactivate", "[", 
      RowBox[{
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", "sizepat"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", "i"}], "]"}]}], ",", "___"}], "}"}]}], "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"i", ",", " ", "\"\< free\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", "i"}], "]"}]}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "ap"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756914137900305*^9, 3.756914147475752*^9}, {
  3.7569143238103323`*^9, 3.756914324861753*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"26c4a5c2-d440-417b-9b6e-c13caa272be0"],

Cell["Case where the bus can\[CloseCurlyQuote]t move and its velocity is 0", \
"Text",
 CellChangeTimes->{{3.756915510251132*^9, 3.756915534239736*^9}, {
  3.756915717941362*^9, 
  3.756915729676852*^9}},ExpressionUUID->"02bc87b7-057e-4382-90b7-\
2e1b09d3eec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{"bottom", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sequence", "@@", "sizepat"}], ",", 
      RowBox[{"h", ":", 
       RowBox[{"{", 
        RowBox[{"0", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<No move, speed was 0\>\"", "]"}], ";", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"base", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "\[Rule]", 
              RowBox[{"bottom", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"w", "+", "1"}], "\[Rule]", "h"}]}], "}"}], ",", "1"}], 
        "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.756915744525333*^9, 3.756915753597331*^9}, {
  3.7569170636050158`*^9, 3.756917064685018*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"df0d7e60-5734-4a19-bf5c-6e35fa3269d6"],

Cell["\<\
Restricted movement, the bus has some speed, there is a bus ahead. The key \
condition here is that if the other bus does not move, there would be no \
crash in the following iteration.\
\>", "Text",
 CellChangeTimes->{{3.7569160152340527`*^9, 3.7569161260144053`*^9}, {
  3.7569162733396397`*^9, 3.756916287483334*^9}, {3.7569170195093937`*^9, 
  3.7569170450369368`*^9}},ExpressionUUID->"f7471d36-930f-47f4-a38b-\
f2c67e930994"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movebottom", "[", 
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "___"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "/;", 
           RowBox[{"v", "\[GreaterEqual]", "1"}]}], ",", "_", ",", "_"}], 
         "}"}]}], ",", "___", ",", 
       RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"crash", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"bottom", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"w", "+", "2"}], ";;", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", "_", "}"}], ",", "1", ",", "1"}], "]"}], "]"}], "[", 
         
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Bus ahead, moving\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"h", ",", "crash"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"crash", "\[GreaterEqual]", "vmax"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<\\tVery far.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", ">=", 
            RowBox[{"2", 
             RowBox[{"Abs", "[", "am", "]"}]}]}], 
           RowBox[{"(*", "fast", "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\\t\\tFast, brake.\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"v", "==", 
            RowBox[{"Abs", "[", "am", "]"}]}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Not", " ", "so", " ", "fast"}], ",", " ", 
             RowBox[{"maybe", " ", "hold"}]}], "*)"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\\t\\tNot so fast, hold?\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"crash", ">", 
                 RowBox[{
                  RowBox[{"Abs", "[", "am", "]"}], "+", 
                  RowBox[{"2", "ap"}]}]}], ",", 
                RowBox[{"v", "+", "ap"}], ",", 
                RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "True", 
           RowBox[{"(*", 
            RowBox[{"Slow", ",", " ", 
             RowBox[{"accelerate", " ", "up", " ", "to", " ", "am"}]}], 
            "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<\\t\\tSlow, accelerate up to am\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"accelerate", "[", "v", "]"}], ",", 
                RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"crash", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", "far", "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<\\tFar.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}], 
           RowBox[{"(*", "fast", "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\\t\\tFast, brake.\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"brake", "[", "v", "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"accelerate", "[", "v", "]"}], "<=", 
                   RowBox[{"crash", "-", 
                    RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
                  RowBox[{"accelerate", "[", "v", "]"}], ",", 
                  RowBox[{"crash", "-", 
                   RowBox[{"Abs", "[", "am", "]"}]}]}], "]"}]}], "]"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"v", "==", 
            RowBox[{"Abs", "[", "am", "]"}]}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Not", " ", "so", " ", "fast"}], ",", " ", 
             RowBox[{"maybe", " ", "hold"}]}], "*)"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\\t\\tNot so fast, hold?\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"crash", ">", 
                 RowBox[{
                  RowBox[{"Abs", "[", "am", "]"}], "+", 
                  RowBox[{"2", "ap"}]}]}], ",", 
                RowBox[{"v", "+", "ap"}], ",", 
                RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "True", 
           RowBox[{"(*", 
            RowBox[{"Slow", ",", " ", 
             RowBox[{"accelerate", " ", "up", " ", "to", " ", "am"}]}], 
            "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<\\t\\tSlow, accelerate up to am\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"accelerate", "[", "v", "]"}], ",", 
                RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"crash", "==", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<\\tClose (exactly at am).\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}], 
           RowBox[{"(*", "fast", "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\\t\\tFast, brake to am.\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"brake", "[", "v", "]"}], ">", 
               RowBox[{"Abs", "[", "am", "]"}]}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<WARNING!!! Had to brake too much. Step is\>\"", "<>", 
                RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], "]"}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"v", "==", 
            RowBox[{"Abs", "[", "am", "]"}]}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Not", " ", "so", " ", "fast"}], ",", " ", 
             RowBox[{"maybe", " ", "hold"}]}], "*)"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\\t\\tNot so fast, hold\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", "v"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "True", 
           RowBox[{"(*", 
            RowBox[{"Slow", ",", " ", 
             RowBox[{"accelerate", " ", "up", " ", "to", " ", "am"}]}], 
            "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<\\t\\tSlow, accelerate up to am\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"accelerate", "[", "v", "]"}], ",", 
                RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", "True", 
        
        RowBox[{"(*", "near", "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<\\tNear, set v to crash distance.\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", "\[GreaterEqual]", "crash"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<\\t\\tFast, brake to crash.\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"brake", "[", "v", "]"}], ">", "crash"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<WARNING!!! Had to brake too much. Step is\>\"", "<>", 
                RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], "]"}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", "crash"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<\\t\\tSlow, accelerate up to crash\>\"", "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"accelerate", "[", "v", "]"}], ",", "crash"}], 
               "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.756917067328204*^9, 3.756917107870358*^9}, {
   3.756917354984603*^9, 3.756917356257004*^9}, {3.757515671399221*^9, 
   3.7575157180847273`*^9}, {3.7624516032665453`*^9, 3.7624516096411257`*^9}, 
   3.762451818769987*^9, 3.7646007734171247`*^9, {3.7646008077677937`*^9, 
   3.764600810393117*^9}, {3.764855423154913*^9, 3.764855423929228*^9}, {
   3.7648753868388844`*^9, 3.764875389861621*^9}, {3.766232015424609*^9, 
   3.7662320484306192`*^9}, {3.766335462760899*^9, 3.766335463521042*^9}, {
   3.769791057478593*^9, 3.7697910623302727`*^9}, {3.771171928175859*^9, 
   3.7711720074591007`*^9}, {3.771172045330595*^9, 3.7711720461948977`*^9}, {
   3.771172801604392*^9, 3.771172806202444*^9}, {3.7711728645283546`*^9, 
   3.771172865614579*^9}, {3.771173238235718*^9, 3.771173266243746*^9}, {
   3.771173307761937*^9, 3.771173317385234*^9}, {3.771173358655686*^9, 
   3.771173444740905*^9}, {3.77117362085748*^9, 3.7711736215079203`*^9}, {
   3.771174056540983*^9, 3.7711740619806957`*^9}, {3.771174264800378*^9, 
   3.771174343863304*^9}, {3.771175700132998*^9, 3.77117579237366*^9}, {
   3.773585862088538*^9, 3.773585863182715*^9}, {3.777652465231001*^9, 
   3.777652481048769*^9}, 3.777652555344975*^9},
 CellLabel->
  "In[167]:=",ExpressionUUID->"60f3bc51-7978-4172-a3c9-266eb01db6a9"],

Cell["\<\
The only remaining case, there is no bus ahead. Free movement.\
\>", "Text",
 CellChangeTimes->{{3.756917366071883*^9, 3.7569174017092123`*^9}, 
   3.7569175357063*^9},ExpressionUUID->"a5bc851e-c1bc-475f-89eb-ee224d278c9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movebottom", "[", 
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "__"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"spd", "=", 
       RowBox[{"accelerate", "[", "v", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<No bus ahead.\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<old speed, new speed \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", " ", "spd"}], "}"}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"base", ",", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"spd", "+", "i"}], "\[Rule]", 
             RowBox[{
              RowBox[{"{", "wagons", "}"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"w", "+", "spd", "+", "1"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"spd", ",", 
             RowBox[{"h", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"h", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "]"}]}]}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756917570211269*^9, 3.756917572019082*^9}, {
  3.763900556368381*^9, 3.763900590669712*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"e786b857-499b-4342-bdcf-81639d94143b"],

Cell["The case where the speed is set, Only use if sure.", "Text",
 CellChangeTimes->{{3.75751463534298*^9, 3.757514678674118*^9}, {
  3.757514711729604*^9, 
  3.7575147124816227`*^9}},ExpressionUUID->"78b5fb41-b0ee-40e9-aafb-\
4fa4afeddaa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "__"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", "rest___"}], 
      "}"}]}], ",", 
    RowBox[{"set_Integer", "/;", 
     RowBox[{"0", "\[LessEqual]", "set", "\[LessEqual]", "vmax"}]}]}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"crash", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", "rest", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", "1", ",", "1"}], "]"}], "//", 
       "Flatten"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"v", "-", "set"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"v", "-", "set"}], ">", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<WARNING: Braking more than allowed. Step is\>\"", "<>", 
         RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"set", "-", "v"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"set", "-", "v"}], ">", "ap"}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<WARNING: Accelerating more than allowed Step is\>\"", "<>", 
         RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Changing speed from \>\"", ",", " ", "v", ",", " ", "\"\< to \>\"",
        ",", " ", "set"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"h", ",", "crash", ",", "set"}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"crash", "\[Equal]", 
         RowBox[{"{", "}"}]}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{"crash", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "\[GreaterEqual]", 
         "set"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"unrestricted", " ", "movement"}], ",", " ", "accelerate"}], 
        "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"base", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"set", "+", "i"}], "\[Rule]", 
              RowBox[{
               RowBox[{"{", "wagons", "}"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"w", "+", "set", "+", "1"}], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"set", ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", " ",
        ",", 
       RowBox[{"Print", "[", "\"\<Set speed is having trouble.\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7575147009616423`*^9, 3.757514979694734*^9}, {
  3.757515087356724*^9, 3.757515228179902*^9}, {3.75751530977876*^9, 
  3.7575153099775953`*^9}, {3.777652529265027*^9, 3.777652543916706*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"58671395-5e14-4f70-a2ad-d87756323ad1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions without messages", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 
  3.7569089811333857`*^9}},ExpressionUUID->"4a4f8ff1-3e91-4026-8c5c-\
254aac57d883"],

Cell[TextData[{
 "The most specific case: Bus is stopped, there is enough room to accelerate \
forward. Only works if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["a", "+"], "\[LessEqual]"}], "|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],ExpressionUUID->
  "fdaa390e-9e5e-4144-a676-721fde675a10"],
 "."
}], "Text",
 CellChangeTimes->{{3.756914168894032*^9, 3.756914269178179*^9}, {
  3.7569168672173243`*^9, 
  3.756916884952548*^9}},ExpressionUUID->"ebb24cef-a7ba-4f7d-ba87-\
2f2568e16180"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Activate", "/@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Inactivate", "[", 
      RowBox[{
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", "sizepat"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", "i"}], "]"}]}], ",", "___"}], "}"}]}], "]"}], ":=",
        "\[IndentingNewLine]", 
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ",", "i"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "ap"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756914137900305*^9, 3.756914147475752*^9}, {
   3.756914298354786*^9, 3.756914314661626*^9}, {3.756915626400405*^9, 
   3.756915627239438*^9}, 3.75691580482024*^9, 3.756916795424233*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"9b3e417d-b36a-4d53-aa44-62cf3cc44e76"],

Cell["Case where the bus can\[CloseCurlyQuote]t move and its velocity is 0", \
"Text",
 CellChangeTimes->{{3.756915510251132*^9, 3.756915534239736*^9}, {
  3.756915717941362*^9, 
  3.756915729676852*^9}},ExpressionUUID->"d935f2f6-e259-44ff-afde-\
1805f0cf7e90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{"bottom", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sequence", "@@", "sizepat"}], ",", 
      RowBox[{"h", ":", 
       RowBox[{"{", 
        RowBox[{"0", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{"base", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"bottom", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"w", "+", "1"}], "\[Rule]", "h"}]}], "}"}], ",", "1"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756915744525333*^9, 3.756915753597331*^9}, {
  3.756915814100024*^9, 3.756915815900033*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"3de749d7-95f7-45f7-985d-6e0ad577b796"],

Cell["\<\
Restricted movement, the bus has some speed, there is a bus ahead. The key \
condition here is that if the other bus does not move, there would be no \
crash in the following iteration.\
\>", "Text",
 CellChangeTimes->{{3.7569160152340527`*^9, 3.7569161260144053`*^9}, {
  3.7569162733396397`*^9, 3.756916287483334*^9}, {3.7569170195093937`*^9, 
  3.7569170450369368`*^9}},ExpressionUUID->"2a9eb7e4-d5e3-46e8-9e5f-\
87861d5ec0e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{"bottom", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"wagons", ":", "___"}], ",", 
      RowBox[{"h", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v_", "/;", 
          RowBox[{"v", "\[GreaterEqual]", "1"}]}], ",", "_", ",", "_"}], 
        "}"}]}], ",", "___", ",", 
      RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"crash", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bottom", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"w", "+", "2"}], ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", "_", "}"}], ",", "1", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"crash", "\[GreaterEqual]", "vmax"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", ">=", 
         RowBox[{"2", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", "fast", "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"brake", "[", "v", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"v", "==", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Not", " ", "so", " ", "fast"}], ",", " ", 
          RowBox[{"maybe", " ", "hold"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"crash", ">", 
             RowBox[{
              RowBox[{"Abs", "[", "am", "]"}], "+", 
              RowBox[{"2", "ap"}]}]}], ",", 
            RowBox[{"v", "+", "ap"}], ",", 
            RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "True", 
        RowBox[{"(*", 
         RowBox[{"Slow", ",", " ", 
          RowBox[{"accelerate", " ", "up", " ", "to", " ", "am"}]}], "*)"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"accelerate", "[", "v", "]"}], ",", 
            RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"crash", ">", 
       RowBox[{"Abs", "[", "am", "]"}]}], 
      RowBox[{"(*", "far", "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", "fast", "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"brake", "[", "v", "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"accelerate", "[", "v", "]"}], "<=", 
               RowBox[{"crash", "-", 
                RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
              RowBox[{"accelerate", "[", "v", "]"}], ",", 
              RowBox[{"crash", "-", 
               RowBox[{"Abs", "[", "am", "]"}]}]}], "]"}]}], "]"}]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"v", "==", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Not", " ", "so", " ", "fast"}], ",", " ", 
          RowBox[{"maybe", " ", "hold"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"crash", ">", 
             RowBox[{
              RowBox[{"Abs", "[", "am", "]"}], "+", 
              RowBox[{"2", "ap"}]}]}], ",", 
            RowBox[{"v", "+", "ap"}], ",", 
            RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "True", 
        RowBox[{"(*", 
         RowBox[{"Slow", ",", " ", 
          RowBox[{"accelerate", " ", "up", " ", "to", " ", "am"}]}], "*)"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"accelerate", "[", "v", "]"}], ",", 
            RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"crash", "==", 
       RowBox[{"Abs", "[", "am", "]"}]}], 
      RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", "fast", "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"brake", "[", "v", "]"}], ">", 
            RowBox[{"Abs", "[", "am", "]"}]}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<WARNING!!! Had to brake too much. Step is\>\"", "<>", 
             RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"movebottom", "[", 
          RowBox[{"bottom", ",", 
           RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"v", "==", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Not", " ", "so", " ", "fast"}], ",", " ", 
          RowBox[{"maybe", " ", "hold"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", "v"}], "]"}], ",", "\[IndentingNewLine]", 
        "True", 
        RowBox[{"(*", 
         RowBox[{"Slow", ",", " ", 
          RowBox[{"accelerate", " ", "up", " ", "to", " ", "am"}]}], "*)"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"accelerate", "[", "v", "]"}], ",", 
            RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", 
      RowBox[{"(*", "near", "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "\[GreaterEqual]", "crash"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"brake", "[", "v", "]"}], ">", "crash"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<WARNING!!! Had to brake too much. Step is\>\"", "<>", 
             RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"movebottom", "[", 
          RowBox[{"bottom", ",", "crash"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"accelerate", "[", "v", "]"}], ",", "crash"}], "]"}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.77117288953474*^9, 3.771172926301113*^9}, {
   3.771173136353146*^9, 3.771173213291943*^9}, {3.77117365274549*^9, 
   3.7711736956361437`*^9}, 3.7711759381665907`*^9, {3.771175969114695*^9, 
   3.771176014766921*^9}, {3.777652507337825*^9, 3.777652517896812*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"0aa5dc25-205d-4ce8-8008-b877d55b3705"],

Cell["\<\
The only remaining case, there is no bus ahead. Free movement.\
\>", "Text",
 CellChangeTimes->{{3.756917366071883*^9, 3.7569174017092123`*^9}, 
   3.7569175357063*^9},ExpressionUUID->"5599b516-7616-4046-b1b5-f31ac645588c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movebottom", "[", 
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "__"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"spd", "=", 
       RowBox[{"accelerate", "[", "v", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"base", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"spd", "+", "i"}], "\[Rule]", 
            RowBox[{
             RowBox[{"{", "wagons", "}"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"w", "+", "spd", "+", "1"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"spd", ",", 
            RowBox[{"h", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"h", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.7569175592832603`*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"ee15f134-8a5e-4328-b909-90eea1a659fe"],

Cell["The case where the speed is set, Only use if sure.", "Text",
 CellChangeTimes->{{3.75751463534298*^9, 3.757514678674118*^9}, {
  3.757514711729604*^9, 
  3.7575147124816227`*^9}},ExpressionUUID->"a6716cbf-eca8-49aa-99cb-\
70c3eb21c05e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "__"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", "rest___"}], 
      "}"}]}], ",", 
    RowBox[{"set_Integer", "/;", 
     RowBox[{"0", "\[LessEqual]", "set", "\[LessEqual]", "vmax"}]}]}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"crash", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", "rest", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", "1", ",", "1"}], "]"}], "//", 
       "Flatten"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"v", "-", "set"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"v", "-", "set"}], ">", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<WARNING: Braking more than allowed. Step is\>\"", "<>", 
         RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"set", "-", "v"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"set", "-", "v"}], ">", "ap"}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<WARNING: Accelerating more than allowed. Step is\>\"", "<>", 
         RowBox[{"ToString", "[", "step", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"crash", "\[Equal]", 
         RowBox[{"{", "}"}]}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{"crash", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "\[GreaterEqual]", 
         "set"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"unrestricted", " ", "movement"}], ",", " ", "accelerate"}], 
        "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"base", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"set", "+", "i"}], "\[Rule]", 
              RowBox[{
               RowBox[{"{", "wagons", "}"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"w", "+", "set", "+", "1"}], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"set", ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", " ",
        ",", 
       RowBox[{"Print", "[", "\"\<Set speed is having trouble.\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7575147009616423`*^9, 3.757514979694734*^9}, {
  3.757515087356724*^9, 3.757515228179902*^9}, {3.757515277187276*^9, 
  3.757515280138817*^9}, {3.7776525790780497`*^9, 3.7776525889667473`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"2c13f073-2afa-4d73-b607-335cd3fa16d6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["move", "Section",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 
  3.75690904578677*^9}},ExpressionUUID->"767e1ff4-6555-41a0-8123-\
a690763a0701"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["move",
     FontWeight->"Bold"], "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top",
       FontSlant->"Italic"], ",", 
      StyleBox["bottom",
       FontSlant->"Italic"]}], "}"}], "]"}], TraditionalForm]],ExpressionUUID->
  "f8c09585-136b-48bb-a1f5-ee473bbd6340"],
 " takes into account the different situations that arise from the \
interactions with the stations or lights.\nFor lights it stops the bus if the \
light is red and the bus can stop, for stations it stops the bus and \
loads/unloads passengers.\nStations and lights should be sufficiently spaced \
so that there is no chance to have two of them within the LOS of a bus."
}], "Text",
 CellChangeTimes->{{3.750274861670138*^9, 3.750274931941072*^9}, {
   3.750274984643898*^9, 3.7502750311476593`*^9}, {3.7569192993851957`*^9, 
   3.7569193235376263`*^9}, 
   3.75985395846246*^9},ExpressionUUID->"96023d43-f806-4569-b1ec-\
637f7a9d8804"],

Cell[CellGroupData[{

Cell["Functions with messages", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569176563043222`*^9, 
  3.7569176567446117`*^9}},ExpressionUUID->"6b1112fd-c70d-4b7c-b3c2-\
94080786cd88"],

Cell["\<\
Case where there is a station on the top track and there is a bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 
  3.756923320560177*^9}},ExpressionUUID->"0597a4b6-9903-4e49-bd63-\
5cddd837ea41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"ds", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Station and bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"db", ",", "ds"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tBus at station, unload, load or move\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"v", ">", "0"}], 
          RowBox[{"(*", 
           RowBox[{"stop", ",", " ", 
            RowBox[{"go", " ", "to", " ", "unload"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tStop, go to unload (or load).\>\"", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"stopAndUnload", "[", 
            RowBox[{"{", 
             RowBox[{
              StyleBox["top",
               FontSlant->"Italic"], ",", "bottom"}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], 
          RowBox[{"(*", 
           RowBox[{"ready", " ", "to", " ", "move"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<\\t\\tMove.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", "True", 
          RowBox[{"(*", 
           RowBox[{"load", " ", "or", " ", "unload"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<\\t\\tLoad or unload.\>\"", "]"}], ";", 
           
           RowBox[{"loadAndUnload", "[", 
            RowBox[{"{", 
             RowBox[{
              StyleBox["top",
               FontSlant->"Italic"], ",", 
              StyleBox["bottom",
               FontSlant->"Italic"]}], "}"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ds", ">", "0"}], 
       RowBox[{"(*", 
        RowBox[{"Station", " ", "ahead"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tStation ahead\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ds", "\[GreaterEqual]", "db"}], 
          RowBox[{"(*", 
           RowBox[{"bus", " ", "2", " ", "is", " ", "closer"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tBus 2 before station, interact with bus number 2\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Station", " ", "is", " ", "closer"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tStation before bus 2, interact with station\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
              RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
             RowBox[{"(*", 
              RowBox[{"far", ",", " ", 
               RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<\\t\\t\\tFar, fast, brake to max negative\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"top", ",", 
                RowBox[{"movebottom", "[", 
                 RowBox[{"bottom", ",", 
                  RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
              RowBox[{"v", "<", "ds"}]}], 
             RowBox[{"(*", 
              RowBox[{"far", ",", " ", 
               RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ds", "\[LessEqual]", 
                RowBox[{"2", 
                 RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<\\t\\t\\tFar, slow, hold or accelerate to max \
negative\>\"", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"top", ",", 
                  RowBox[{"movebottom", "[", 
                   RowBox[{"bottom", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
                    RowBox[{"Abs", "[", "am", "]"}]}], ",", 
                    RowBox[{"Abs", "[", "am", "]"}], ",", 
                    RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<\\t\\t\\tFar, fast, hold or brake to 2 am\>\"", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"top", ",", 
                  RowBox[{"movebottom", "[", 
                   RowBox[{"bottom", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"v", "\[GreaterEqual]", 
                    RowBox[{"2", 
                    RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
                    RowBox[{"2", 
                    RowBox[{"Abs", "[", "am", "]"}]}], ",", "v"}], "]"}]}], 
                   "]"}]}], "}"}]}], ","}], "\[IndentingNewLine]", "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"ds", "\[LessEqual]", 
              RowBox[{"Abs", "[", "am", "]"}]}], 
             RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<\\t\\t\\tClose, brake or accelerate to ds\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ds", ">", "v"}], 
                RowBox[{"(*", "accelerate", "*)"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"top", ",", 
                  RowBox[{"movebottom", "[", 
                   RowBox[{"bottom", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"v", "+", "ap"}], ",", "ds"}], "]"}]}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ds", "==", "v"}], 
                RowBox[{"(*", 
                 RowBox[{"constant", " ", "speed"}], "*)"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"top", ",", 
                  RowBox[{"movebottom", "[", 
                   RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "True", 
                RowBox[{"(*", "brake", "*)"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"top", ",", 
                  RowBox[{"movebottom", "[", 
                   RowBox[{"bottom", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"ds", ",", 
                    RowBox[{"v", "+", "am"}]}], "]"}]}], "]"}]}], "}"}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             "True", ",", " ", 
             RowBox[{"Print", "[", "\"\<\\t\\tProblem (station)\>\"", "]"}]}],
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
        ",", "\[IndentingNewLine]", "True", 
       RowBox[{"(*", 
        RowBox[{"station", " ", "behind"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tStation behind, interact with bus ahead\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756919141055341*^9, 3.75691914156811*^9}, {
   3.756919192383854*^9, 3.7569191933599787`*^9}, {3.7569192549262257`*^9, 
   3.756919255021707*^9}, {3.756919983616617*^9, 3.7569199844420557`*^9}, 
   3.756920203899517*^9, 3.756920438513762*^9, 3.756920758653461*^9, {
   3.7569221553272943`*^9, 3.756922266943678*^9}, {3.756922303092514*^9, 
   3.7569223487424927`*^9}, {3.756923157628049*^9, 3.756923159317794*^9}, {
   3.7569231975410233`*^9, 3.7569232809559402`*^9}, {3.756936380818111*^9, 
   3.756936403750822*^9}, {3.758479376513631*^9, 3.7584794501041803`*^9}, {
   3.758479484370964*^9, 3.7584795204054823`*^9}, 3.758479560158568*^9, {
   3.758479600395851*^9, 3.758479603826613*^9}, {3.7584820654345284`*^9, 
   3.7584820686677437`*^9}, {3.763742617867609*^9, 3.763742619804126*^9}, {
   3.763742935560627*^9, 3.7637429419522667`*^9}, {3.763743042617161*^9, 
   3.7637430446896152`*^9}, {3.763743415058466*^9, 3.763743424895295*^9}, {
   3.7637437404738417`*^9, 3.763743806153653*^9}, {3.763743856633917*^9, 
   3.7637438838012114`*^9}, {3.763743930577243*^9, 3.763743997433917*^9}, {
   3.763744034791564*^9, 3.763744093125757*^9}, {3.763744172164503*^9, 
   3.7637442355777187`*^9}, 3.763744300375745*^9, {3.7637443771578627`*^9, 
   3.7637444024064207`*^9}, {3.763744508720989*^9, 3.7637445096175327`*^9}, {
   3.763744570381174*^9, 3.763744599751255*^9}, {3.7637446346471148`*^9, 
   3.763744774609602*^9}, 3.76374487235828*^9, {3.763744902568907*^9, 
   3.7637449990571632`*^9}, {3.763745033692873*^9, 3.7637450408161287`*^9}, {
   3.763745114287814*^9, 3.763745338080414*^9}, 3.763745421947445*^9, {
   3.763745481126849*^9, 3.763745511689632*^9}, {3.763745609520986*^9, 
   3.763745646481373*^9}, {3.763745693488312*^9, 3.763745741907752*^9}, {
   3.763745834532194*^9, 3.763745835242353*^9}, 3.7669466756808157`*^9, {
   3.777658491803824*^9, 3.777658501078556*^9}, {3.777658536499531*^9, 
   3.77765854313208*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"69253122-35ca-4058-9099-46da0bcd3052"],

Cell["\<\
Case where there is a station on the top track and there is no bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.756923384383792*^9, 
  3.756923384575515*^9}},ExpressionUUID->"72455a84-5ab5-4b98-b5e0-\
6b0ae55a534f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "==", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"ds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Station, no bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "ds", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "<", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"station", " ", "behind"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tStation behind\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ds", "\[GreaterEqual]", "0"}], " ", 
       RowBox[{"(*", 
        RowBox[{"Deal", " ", "with", " ", "the", " ", "station"}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tInteract with station\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "\[Equal]", "0"}], "&&", 
           RowBox[{"ds", "\[Equal]", "0"}]}], 
          RowBox[{"(*", 
           RowBox[{"bus", " ", "at", " ", "station"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tBus at station, load, unload or move\>\"",
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<\\t\\t\\tmove.\>\"", "]"}], ";", 
              RowBox[{"{", 
               RowBox[{"top", ",", 
                RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<\\t\\t\\tload or unload.\>\"", "]"}],
               ";", 
              RowBox[{"loadAndUnload", "[", 
               RowBox[{"{", 
                RowBox[{
                 StyleBox["top",
                  FontSlant->"Italic"], ",", 
                 StyleBox["bottom",
                  FontSlant->"Italic"]}], "}"}], "]"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", ">", "0"}], "&&", 
           RowBox[{"ds", "\[Equal]", "0"}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"bus", " ", "at", " ", "station"}], ",", " ", 
            RowBox[{
            "stop", " ", "and", " ", "go", " ", "to", " ", "unload"}]}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tBus at station, stop and go to unload\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"stopAndUnload", "[", 
            RowBox[{"{", 
             RowBox[{
              StyleBox["top",
               FontSlant->"Italic"], ",", 
              StyleBox["bottom",
               FontSlant->"Italic"]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tFar, fast, brake to max negative\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "<", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ds", "\[LessEqual]", 
             RowBox[{"2", 
              RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<\\t\\t\\tFar, slow, hold or accelerate to max \
negative\>\"", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"top", ",", 
               RowBox[{"movebottom", "[", 
                RowBox[{"bottom", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
                    RowBox[{"Abs", "[", "am", "]"}]}], ",", 
                   RowBox[{"Abs", "[", "am", "]"}], ",", 
                   RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<\\t\\t\\tFar, fast, hold or brake to 2 am\>\"", "]"}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"top", ",", 
               RowBox[{"movebottom", "[", 
                RowBox[{"bottom", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"v", "\[GreaterEqual]", 
                    RowBox[{"2", 
                    RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
                   RowBox[{"2", 
                    RowBox[{"Abs", "[", "am", "]"}]}], ",", "v"}], "]"}]}], 
                "]"}]}], "}"}]}], ","}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ds", "\[LessEqual]", 
           RowBox[{"Abs", "[", "am", "]"}]}], 
          RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tClose, brake or accelerate to ds\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ds", ">", "v"}], 
             RowBox[{"(*", "accelerate", "*)"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"top", ",", 
               RowBox[{"movebottom", "[", 
                RowBox[{"bottom", ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"v", "+", "ap"}], ",", "ds"}], "]"}]}], "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ds", "==", "v"}], 
             RowBox[{"(*", 
              RowBox[{"constant", " ", "speed"}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"top", ",", 
               RowBox[{"movebottom", "[", 
                RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "True", 
             RowBox[{"(*", "brake", "*)"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"top", ",", 
               RowBox[{"movebottom", "[", 
                RowBox[{"bottom", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"ds", ",", 
                   RowBox[{"v", "+", "am"}]}], "]"}]}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          "True", ",", " ", 
          RowBox[{"Print", "[", "\"\<\\tProblem (station)\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", "True", 
       ",", 
       RowBox[{"Print", "[", "\"\<\\tProblem with interaction.\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.766946293824885*^9, 3.766946318316515*^9}, {
  3.7776560251672564`*^9, 3.777656035613854*^9}, {3.777656755787662*^9, 
  3.777656797148653*^9}, {3.777657365346284*^9, 3.777657395737146*^9}, {
  3.777657487674053*^9, 3.777657529531311*^9}, {3.777657585327252*^9, 
  3.77765765665133*^9}, {3.77765790568744*^9, 3.777657925038823*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"cef49b94-fd30-4618-ae62-1da42ac03ebe"],

Cell["\<\
Case where there is a light on the top track and there is a bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.7569237677400837`*^9, 
  3.756923772683919*^9}},ExpressionUUID->"798ba209-42b3-46b4-9073-\
9098b61a53b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "1"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest___", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", "_List", ",", "1", ",", "1"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}], ",", 
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Light, bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"db", ",", "dl"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dl", "<", "0"}], "||", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ">", "0"}]}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"light", " ", "behind"}], ",", " ", 
         RowBox[{"or", " ", "green"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tLight behind or green\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dl", "\[GreaterEqual]", "db"}], 
       RowBox[{"(*", 
        RowBox[{"deal", " ", "with", " ", "the", " ", "bus"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tBus before light, interact with bus\>\"", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dl", "<", "db"}], 
       RowBox[{"(*", 
        RowBox[{"deal", " ", "with", " ", "the", " ", "light"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tLight before bus, interact with light\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dl", "\[Equal]", "0"}], "&&", 
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}],
             ",", " ", 
            RowBox[{"moving", " ", "fast"}]}], "*)"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tRed light at the head, moving fast\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dl", "\[Equal]", "0"}], "&&", 
           RowBox[{"v", "\[LessEqual]", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}],
             ",", " ", "stop"}], "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tRed light at the head, stop\>\"", "]"}], 
           ";", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"{", 
              RowBox[{"wagons", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"h", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"h", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"dl", "\[LessEqual]", 
           RowBox[{"Abs", "[", "am", "]"}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light"}], ",", " ", "near", ",", " ", 
            RowBox[{"advance", " ", "to", " ", "the", " ", "light"}]}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tNear, advance to the light\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "+", "ap"}], ">", "dl"}], ",", "dl", ",", 
                 RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dl", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", 
            ",", " ", "brake"}], "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tFar, fast, brake, advance to the light\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dl", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
           RowBox[{"v", "\[LessEqual]", " ", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "slow", 
            ",", " ", "accekerate"}], "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tFar, slow, accelerate, advance to the light\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"accelerate", "[", "v", "]"}]}], "]"}]}], "}"}]}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", "True", ",", " ", 
       RowBox[{"Print", "[", "\"\<Problem (light)\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756936438589587*^9, 3.756936467364991*^9}, {
   3.756936599840809*^9, 3.756936634863811*^9}, {3.758740353947177*^9, 
   3.7587403568585367`*^9}, {3.758740464066324*^9, 3.758740477362607*^9}, {
   3.75874059007401*^9, 3.758740599743247*^9}, 3.771169739697138*^9},
 CellLabel->
  "In[231]:=",ExpressionUUID->"6a76a04e-b9f7-41e0-9b36-6f66f27f36d3"],

Cell["\<\
Case where there is a light on the top track and there is no bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.7569237677400837`*^9, 
  3.756923782355897*^9}},ExpressionUUID->"31761617-6c00-4a73-8c27-\
00b2ddbf2c32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "1"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest___", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[Equal]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"top", ",", "_List", ",", "1", ",", "1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Light, no bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "dl", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dl", "<", "0"}], "||", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ">", "0"}]}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"light", " ", "behind"}], ",", " ", 
         RowBox[{"or", " ", "green"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tLight behind or green\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Red", " ", "light"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dl", "\[Equal]", "0"}], "&&", 
        RowBox[{"v", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
         ",", " ", 
         RowBox[{"moving", " ", "fast"}]}], "*)"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tRed light at the head, moving fast\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dl", "\[Equal]", "0"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
         ",", " ", "stop"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tRed light at the head, stop\>\"", "]"}],
         ";", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"wagons", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"dl", "\[LessEqual]", 
        RowBox[{"Abs", "[", "am", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light"}], ",", " ", "near", ",", " ", 
         RowBox[{"advance", " ", "to", " ", "the", " ", "light"}]}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tNear, advance to the light\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "+", "ap"}], ">", "dl"}], ",", "dl", ",", 
              RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dl", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
        RowBox[{"v", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", 
         ",", " ", "brake"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tFar, fast, brake, advance to the light\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"brake", "[", "v", "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"accelerate", "[", "v", "]"}], "\[LessEqual]", 
                 RowBox[{"dl", "-", 
                  RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
                RowBox[{"accelerate", "[", "v", "]"}], ",", 
                RowBox[{"dl", "-", 
                 RowBox[{"Abs", "[", "am", "]"}]}]}], "]"}]}], "]"}]}], 
           "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dl", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
        RowBox[{"v", "\[LessEqual]", " ", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "slow", 
         ",", " ", "accekerate"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<\\tFar, slow, accelerate, advance to the light\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"accelerate", "[", "v", "]"}]}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", " ", 
       RowBox[{"Print", "[", "\"\<Problem (light)\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756936978093399*^9, 3.756937004813389*^9}, {
  3.7587410055360928`*^9, 3.758741005976446*^9}, {3.7587410478898993`*^9, 
  3.7587411230792713`*^9}, {3.7587479183347187`*^9, 3.758747918751042*^9}, {
  3.7587485279793167`*^9, 3.7587485468087*^9}, {3.758748611352149*^9, 
  3.758748611487352*^9}, {3.758748728494832*^9, 3.758748760548552*^9}, {
  3.759167156572847*^9, 3.75916715662593*^9}, {3.7591672695532417`*^9, 
  3.759167274901731*^9}, {3.7646130836783037`*^9, 3.764613096918475*^9}, {
  3.764849296750153*^9, 3.764849298910762*^9}, {3.766233448312503*^9, 
  3.766233480430594*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"31344346-ab83-462e-9142-6e4db4359187"],

Cell["The general case", "Text",
 CellChangeTimes->{{3.756937033515044*^9, 
  3.756937041992055*^9}},ExpressionUUID->"0c65a689-f771-4657-a434-\
386005c0e307"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"move", "[", "track_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"movebottom", "[", 
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.756937068503295*^9, 3.756937111262622*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"6b1af498-60c4-41ff-b067-9c3f75c61a26"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions without messages", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 
  3.7569089811333857`*^9}},ExpressionUUID->"9d6afb35-47f6-47d7-aec3-\
3fc3f26a5d0a"],

Cell["\<\
Case where there is a station on the top track and there is a bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 
  3.756923320560177*^9}},ExpressionUUID->"40ec76a3-fa87-442d-9e32-\
508b804466e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"ds", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ds", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", ">", "0"}], 
        RowBox[{"(*", 
         RowBox[{"stop", ",", " ", 
          RowBox[{"go", " ", "to", " ", "unload"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"stopAndUnload", "[", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["top",
            FontSlant->"Italic"], ",", "bottom"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], 
        RowBox[{"(*", 
         RowBox[{"ready", " ", "to", " ", "move"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "True", 
        RowBox[{"(*", 
         RowBox[{"load", " ", "or", " ", "unload"}], "*)"}], ",", 
        RowBox[{"loadAndUnload", "[", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["top",
            FontSlant->"Italic"], ",", 
           StyleBox["bottom",
            FontSlant->"Italic"]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ds", ">", "0"}], 
      RowBox[{"(*", 
       RowBox[{"Station", " ", "ahead"}], "*)"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ds", "\[GreaterEqual]", "db"}], 
        RowBox[{"(*", 
         RowBox[{"bus", " ", "2", " ", "is", " ", "closer"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Station", " ", "is", " ", "closer"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "<", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ds", "\[LessEqual]", 
             RowBox[{"2", 
              RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"movebottom", "[", 
               RowBox[{"bottom", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
                   RowBox[{"Abs", "[", "am", "]"}]}], ",", 
                  RowBox[{"Abs", "[", "am", "]"}], ",", 
                  RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"movebottom", "[", 
               RowBox[{"bottom", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"v", "\[GreaterEqual]", 
                   RowBox[{"2", 
                    RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
                  RowBox[{"2", 
                   RowBox[{"Abs", "[", "am", "]"}]}], ",", "v"}], "]"}]}], 
               "]"}]}], "}"}], ","}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ds", "\[LessEqual]", 
           RowBox[{"Abs", "[", "am", "]"}]}], 
          RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ds", ">", "v"}], 
            RowBox[{"(*", "accelerate", "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"movebottom", "[", 
               RowBox[{"bottom", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"v", "+", "ap"}], ",", "ds"}], "]"}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ds", "==", "v"}], 
            RowBox[{"(*", 
             RowBox[{"constant", " ", "speed"}], "*)"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"movebottom", "[", 
               RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", "True", 
            RowBox[{"(*", "brake", "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"movebottom", "[", 
               RowBox[{"bottom", ",", 
                RowBox[{"Max", "[", 
                 RowBox[{"ds", ",", 
                  RowBox[{"v", "+", "am"}]}], "]"}]}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", 
          ",", " ", 
          RowBox[{"Print", "[", "\"\<\\t\\tProblem (station)\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", "True", 
      RowBox[{"(*", 
       RowBox[{"station", " ", "behind"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756919141055341*^9, 3.75691914156811*^9}, {
   3.756919192383854*^9, 3.7569191933599787`*^9}, {3.7569192549262257`*^9, 
   3.756919255021707*^9}, {3.756919983616617*^9, 3.7569199844420557`*^9}, 
   3.756920203899517*^9, 3.756920438513762*^9, 3.756920758653461*^9, {
   3.7569221553272943`*^9, 3.756922266943678*^9}, {3.756922303092514*^9, 
   3.7569223487424927`*^9}, {3.756923157628049*^9, 3.756923159317794*^9}, {
   3.7569231975410233`*^9, 3.7569232809559402`*^9}, {3.756936380818111*^9, 
   3.756936403750822*^9}, {3.758479376513631*^9, 3.7584794501041803`*^9}, {
   3.758479484370964*^9, 3.7584795204054823`*^9}, 3.758479560158568*^9, {
   3.758479600395851*^9, 3.758479603826613*^9}, {3.7584820654345284`*^9, 
   3.7584820686677437`*^9}, {3.758729238390623*^9, 3.75872927247797*^9}, 
   3.758733449834013*^9, {3.7637458812205544`*^9, 3.76374593931892*^9}, {
   3.763746094192749*^9, 3.763746094604423*^9}, {3.7669467070286016`*^9, 
   3.766946762115951*^9}, {3.777658588993874*^9, 3.777658653100071*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"5707bd90-bddf-4a1d-8e3e-a50fe218a7dc"],

Cell["\<\
Case where there is a station on the top track and there is no bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.756923384383792*^9, 
  3.756923384575515*^9}},ExpressionUUID->"9bbc4881-7e9e-4ec3-acf9-\
ec0df59a2268"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "==", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"ds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ds", "<", "0"}], ",", 
      RowBox[{"(*", 
       RowBox[{"station", " ", "behind"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ds", "\[GreaterEqual]", "0"}], " ", 
      RowBox[{"(*", 
       RowBox[{"Deal", " ", "with", " ", "the", " ", "station"}], "*)"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "\[Equal]", "0"}], "&&", 
         RowBox[{"ds", "\[Equal]", "0"}]}], 
        RowBox[{"(*", 
         RowBox[{"bus", " ", "at", " ", "station"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"loadAndUnload", "[", 
           RowBox[{"{", 
            RowBox[{
             StyleBox["top",
              FontSlant->"Italic"], ",", 
             StyleBox["bottom",
              FontSlant->"Italic"]}], "}"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", ">", "0"}], "&&", 
         RowBox[{"ds", "\[Equal]", "0"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"bus", " ", "at", " ", "station"}], ",", " ", 
          RowBox[{"stop", " ", "and", " ", "go", " ", "to", " ", "unload"}]}],
          "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"stopAndUnload", "[", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["top",
            FontSlant->"Italic"], ",", 
           StyleBox["bottom",
            FontSlant->"Italic"]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
         RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
        RowBox[{"(*", 
         RowBox[{"far", ",", " ", 
          RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
         RowBox[{"v", "<", "ds"}]}], 
        RowBox[{"(*", 
         RowBox[{"far", ",", " ", 
          RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ds", "\[LessEqual]", 
           RowBox[{"2", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
                 RowBox[{"Abs", "[", "am", "]"}]}], ",", 
                RowBox[{"Abs", "[", "am", "]"}], ",", 
                RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"v", "\[GreaterEqual]", 
                 RowBox[{"2", 
                  RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
                RowBox[{"2", 
                 RowBox[{"Abs", "[", "am", "]"}]}], ",", "v"}], "]"}]}], 
             "]"}]}], "}"}], ","}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ds", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ds", ">", "v"}], 
          RowBox[{"(*", "accelerate", "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"v", "+", "ap"}], ",", "ds"}], "]"}]}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ds", "==", "v"}], 
          RowBox[{"(*", 
           RowBox[{"constant", " ", "speed"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "True", 
          RowBox[{"(*", "brake", "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"ds", ",", 
                RowBox[{"v", "+", "am"}]}], "]"}]}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", 
        ",", " ", 
        RowBox[{"Print", "[", "\"\<\\tProblem (station)\>\"", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", ",", 
      
      RowBox[{"Print", "[", "\"\<\\tProblem with interaction.\>\"", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.756919141055341*^9, 3.75691914156811*^9}, {
   3.756919192383854*^9, 3.7569191933599787`*^9}, {3.7569192549262257`*^9, 
   3.756919255021707*^9}, {3.756919983616617*^9, 3.7569199844420557`*^9}, 
   3.756920203899517*^9, 3.756920438513762*^9, 3.756920758653461*^9, {
   3.7569221553272943`*^9, 3.756922266943678*^9}, {3.756922303092514*^9, 
   3.7569223487424927`*^9}, {3.756923157628049*^9, 3.756923159317794*^9}, {
   3.7569231975410233`*^9, 3.7569232809559402`*^9}, {3.756923404635791*^9, 
   3.756923434185429*^9}, {3.756923472235037*^9, 3.7569235036417828`*^9}, {
   3.756936408663323*^9, 3.756936432340933*^9}, {3.757511908861381*^9, 
   3.7575119368840714`*^9}, {3.757511995203389*^9, 3.75751205758843*^9}, {
   3.7575121089345293`*^9, 3.757512119311709*^9}, 3.757512560852899*^9, {
   3.758479833201127*^9, 3.758479834107828*^9}, {3.758481961976777*^9, 
   3.758481971493462*^9}, {3.7584820741724253`*^9, 3.758482076924491*^9}, {
   3.7587291973834953`*^9, 3.758729232718058*^9}, {3.762443198703135*^9, 
   3.762443208901266*^9}, {3.766946538792973*^9, 3.766946589557453*^9}, {
   3.766946936082738*^9, 3.766946936615835*^9}, {3.777658107701974*^9, 
   3.777658168408267*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"8d548be1-acb1-4f15-b6b9-42d9a99ff27e"],

Cell["\<\
Case where there is a light on the top track and there is a bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.7569237677400837`*^9, 
  3.756923772683919*^9}},ExpressionUUID->"fc96c2f1-fd53-4fbc-a444-\
115c8dec0d58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "1"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest___", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", "_List", ",", "1", ",", "1"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}], ",", 
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dl", "<", "0"}], "||", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ">", "0"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"light", " ", "behind"}], ",", " ", 
        RowBox[{"or", " ", "green"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dl", "\[GreaterEqual]", "db"}], 
      RowBox[{"(*", 
       RowBox[{"deal", " ", "with", " ", "the", " ", "bus"}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dl", "<", "db"}], 
      RowBox[{"(*", 
       RowBox[{"deal", " ", "with", " ", "the", " ", "light"}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dl", "\[Equal]", "0"}], "&&", 
         RowBox[{"v", ">", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
          ",", " ", 
          RowBox[{"moving", " ", "fast"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dl", "\[Equal]", "0"}], "&&", 
         RowBox[{"v", "\[LessEqual]", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
          ",", " ", "stop"}], "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"wagons", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"dl", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light"}], ",", " ", "near", ",", " ", 
          RowBox[{"advance", " ", "to", " ", "the", " ", "light"}]}], "*)"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "+", "ap"}], ">", "dl"}], ",", "dl", ",", 
              RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dl", ">", 
          RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
         RowBox[{"v", ">", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", 
          ",", " ", "brake"}], "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dl", ">", 
          RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
         RowBox[{"v", "\[LessEqual]", " ", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "slow", 
          ",", " ", "accekerate"}], "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"accelerate", "[", "v", "]"}]}], "]"}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", "True", ",", " ", 
      RowBox[{"Print", "[", "\"\<Problem (light)\>\"", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.756936438589587*^9, 3.756936467364991*^9}, {
  3.756936599840809*^9, 3.756936634863811*^9}, {3.758729155312252*^9, 
  3.758729183975337*^9}, {3.758740699254204*^9, 3.758740699628483*^9}, {
  3.771169843431752*^9, 3.771169882656424*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"2d94b5fd-5659-4397-bc4a-9fefc344bc7c"],

Cell["\<\
Case where there is a light on the top track and there is no bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.7569237677400837`*^9, 
  3.756923782355897*^9}},ExpressionUUID->"38fd9f21-2f2f-44ca-9230-\
5ec59ea7953d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "1"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest___", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[Equal]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"top", ",", "_List", ",", "1", ",", "1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dl", "<", "0"}], "||", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ">", "0"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"light", " ", "behind"}], ",", " ", 
        RowBox[{"or", " ", "green"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Red", " ", "light"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dl", "\[Equal]", "0"}], "&&", 
       RowBox[{"v", ">", 
        RowBox[{"Abs", "[", "am", "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
        ",", " ", 
        RowBox[{"moving", " ", "fast"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dl", "\[Equal]", "0"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
        ",", " ", "stop"}], "*)"}], ",", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"{", 
         RowBox[{"wagons", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"h", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"h", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"dl", "\[LessEqual]", 
       RowBox[{"Abs", "[", "am", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light"}], ",", " ", "near", ",", " ", 
        RowBox[{"advance", " ", "to", " ", "the", " ", "light"}]}], "*)"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "+", "ap"}], ">", "dl"}], ",", "dl", ",", 
            RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dl", ">", 
        RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
       RowBox[{"v", ">", 
        RowBox[{"Abs", "[", "am", "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", ",",
         " ", "brake"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"brake", "[", "v", "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"accelerate", "[", "v", "]"}], "\[LessEqual]", 
               RowBox[{"dl", "-", 
                RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
              RowBox[{"accelerate", "[", "v", "]"}], ",", 
              RowBox[{"dl", "-", 
               RowBox[{"Abs", "[", "am", "]"}]}]}], "]"}]}], "]"}]}], "]"}]}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dl", ">", 
        RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
       RowBox[{"v", "\[LessEqual]", " ", 
        RowBox[{"Abs", "[", "am", "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "slow", ",",
         " ", "accekerate"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"accelerate", "[", "v", "]"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "True", ",", " ", 
      RowBox[{"Print", "[", "\"\<Problem (light)\>\"", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756936978093399*^9, 3.756937004813389*^9}, {
  3.7587410055360928`*^9, 3.758741005976446*^9}, {3.7587410478898993`*^9, 
  3.7587411230792713`*^9}, {3.7587479183347187`*^9, 3.758747918751042*^9}, {
  3.7587485279793167`*^9, 3.7587485468087*^9}, {3.758748611352149*^9, 
  3.758748611487352*^9}, {3.758748728494832*^9, 3.758748760548552*^9}, {
  3.759167156572847*^9, 3.75916715662593*^9}, {3.7591672695532417`*^9, 
  3.759167274901731*^9}, {3.759167611725483*^9, 3.759167652960013*^9}, {
  3.764849532455954*^9, 3.764849560896554*^9}, {3.766233516794079*^9, 
  3.766233540557798*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"3bafc472-5bf7-48bd-ad32-0ff4cc6af29c"],

Cell["The general case", "Text",
 CellChangeTimes->{{3.756937033515044*^9, 
  3.756937041992055*^9}},ExpressionUUID->"bf475897-90a2-4989-9f0c-\
3e7dbc4da0af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"move", "[", "track_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"movebottom", "[", 
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756937068503295*^9, 3.756937111262622*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"0d5beac3-50f7-4de8-8954-4e4c70b7450b"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["load/unload functions", "Section",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 3.75690904578677*^9}, {3.757533242646553*^9, 
  3.7575332510226316`*^9}},ExpressionUUID->"66c92979-ccc4-4f83-a469-\
90ab64ff3586"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["stopAndUnload",
     FontWeight->"Bold"], "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top",
       FontSlant->"Italic"], ",", 
      StyleBox["bottom",
       FontSlant->"Italic"]}], "}"}], "]"}], TraditionalForm]],ExpressionUUID->
  "3a1544af-a6ce-4c56-b74b-65e8d3f86306"],
 " performs the initial unloading operations, it stops the bus, changes the \
load status to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"1", ",", "r"}], "}"}], TraditionalForm]],ExpressionUUID->
  "0d4fa9c9-2581-4238-9dff-198ea1c5aead"],
 ", with ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "5de2cd4a-ab65-49b7-a590-f77a06cd523d"],
 " the number of ticks needed to unload ",
 Cell[BoxData[
  FormBox[
   StyleBox["pu",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "24517b4a-99ac-409a-91e5-371c667be3ba"],
 " of the passengers. If there are no passangers to unload, it changes the \
load status to 2."
}], "Text",
 CellChangeTimes->{{3.750275037726499*^9, 3.750275146969336*^9}, {
  3.757512530666684*^9, 3.757512531330861*^9}, {3.757512574160037*^9, 
  3.757512673164488*^9}, {3.771847271953664*^9, 
  3.771847299217411*^9}},ExpressionUUID->"ee7c4320-0366-4261-b339-\
c429b298de90"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["loadAndUnload",
     FontWeight->"Bold"], "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top",
       FontSlant->"Italic"], ",", 
      StyleBox["bottom",
       FontSlant->"Italic"]}], "}"}], "]"}], TraditionalForm]],ExpressionUUID->
  "feac3521-a8b1-4671-9b7a-c057f2a9676d"],
 " performs the loading or unloading operations, loading takes place if the \
status of the bus is 2, unloading if it is 1, if the state is 0 the bus tries \
to move forward.\nBoth operations happen with a ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "6ae5f60f-5c28-465b-ae34-9bfff3507bf9"],
 " rate (passengers per tick).\nLoading happens while there are passengers at \
the station and there is room in the bus.\nThe bus fills back to front and \
empties front to back (irrelevant, just a programming convinience).\nThis \
only works if stations are size 1."
}], "Text",
 CellChangeTimes->{{3.750275037726499*^9, 3.750275146969336*^9}, {
  3.757533406435816*^9, 3.75753347949089*^9}, {3.757533526146117*^9, 
  3.7575335586094933`*^9}, {3.7575342831970263`*^9, 3.757534329643838*^9}, {
  3.769342786132462*^9, 
  3.769342789991844*^9}},ExpressionUUID->"3d54aadb-d1c2-4dd7-a8fa-\
13109a4788d2"],

Cell[CellGroupData[{

Cell["Functions with messages", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.757533282870018*^9, 
  3.7575332833258257`*^9}},ExpressionUUID->"ab79bdd5-2ee2-4c4d-9a6b-\
806bf0fd543e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stopAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top_",
       FontSlant->"Italic"], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sequence", "@@", "sizepat"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "/;", 
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "0", ",", "_"}], "}"}], 
        ",", "___"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{
   "Print", "[", "\"\<At station, moving too fast, problem\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7575125363215714`*^9, 3.757512536786708*^9}, {
   3.757512689148435*^9, 3.757512839328857*^9}, {3.757533050406497*^9, 
   3.757533050970915*^9}, 
   3.777659204327037*^9},ExpressionUUID->"30394347-e4af-44ee-b562-\
11fe393b68b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stopAndUnload", "[", 
   RowBox[{"{", 
    RowBox[{
     StyleBox["top_",
      FontSlant->"Italic"], ",", 
     RowBox[{"{", 
      RowBox[{"wagons___", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v_", "/;", 
          RowBox[{"v", "<=", 
           RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "0", ",", "p_"}], "}"}], 
       ",", "rest___"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"time", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"pu", 
        FractionBox[
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
          "p"}], "\[Lambda]\[Upsilon]"]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Stop, change status to unload, calculate how much time to unload\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\\tTime to unload: \>\"", ",", "time"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"time", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\t\\tGo to load.\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"wagons", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}]}], 
               "}"}], ",", "p"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\t\\tGo to unload.\>\"", "]"}], ";", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"wagons", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "time"}], "}"}], ",", "p"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.757512846463655*^9, 3.757512964428207*^9}, {
   3.757512997865345*^9, 3.7575130112573757`*^9}, {3.7575131524227257`*^9, 
   3.757513217509941*^9}, 3.757513256787787*^9, {3.757533057237611*^9, 
   3.757533078107123*^9}, {3.7584800653496733`*^9, 3.758480067751424*^9}, {
   3.758480219690282*^9, 3.758480368583946*^9}, {3.758485824812153*^9, 
   3.758485841866559*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"2a98bf30-439f-4bb6-83d7-f651bce3af95"],

Cell["loadAndUnload", "Text",
 CellChangeTimes->{{3.757533322014868*^9, 
  3.7575333280150757`*^9}},ExpressionUUID->"ced5b0b9-f04b-4f44-9dab-\
73ddf2ec8200"],

Cell[TextData[{
 "Unload case, substract ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "bdc56779-d23d-4d61-b81a-0e6adc06a443"],
 " passengers from the total (front to back), diminish the unloading time by \
one (if it is 1, unload and change to loading state)."
}], "Text",
 CellChangeTimes->{{3.7575339547965183`*^9, 3.757533991056507*^9}, {
  3.7575342730283327`*^9, 3.7575342738358517`*^9}, {3.757534420409361*^9, 
  3.7575344728803177`*^9}, {3.7584801529855967`*^9, 3.7584801530493813`*^9}, {
  3.7584801894888277`*^9, 
  3.758480196640493*^9}},ExpressionUUID->"1b783c1b-9450-4aeb-935f-\
58331aa510e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadAndUnload", "[", 
   RowBox[{"{", 
    RowBox[{"top_List", ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "___"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", "ph_"}], "}"}], ",", "__"}], 
       "}"}]}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pass", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
        "ph"}]}], ",", "new", ",", "wntf", ",", "newn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Unloading, last tick, go to loading\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newn", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}], "<", "0"}], ",", "0", 
        ",", 
        RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "p", "}"}], ",", 
           RowBox[{"Floor", "[", 
            RowBox[{"newn", "/", "p"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Mod", "[", 
          RowBox[{"newn", ",", "p"}], "]"}], "}"}], ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"w", "-", 
            RowBox[{"Floor", "[", 
             RowBox[{"newn", "/", "p"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wntf", "=", 
      RowBox[{"Count", "[", 
       RowBox[{"new", ",", 
        RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\\t\>\"", ",", "new"}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\\tNumber of new empty wagons: \>\"", ",", "wntf"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"wntf", "\[GreaterEqual]", "1"}], 
       RowBox[{"(*", 
        RowBox[{"passengers", " ", "in", " ", "some", " ", "wagons"}], "*)"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\t\\tSome wagons, not head\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", 
             RowBox[{"Most", "[", "new", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "newn"}], "}"}], ",", "0"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"wntf", "\[Equal]", "0"}], 
       RowBox[{"(*", 
        RowBox[{"passengers", " ", "in", " ", "all", " ", "wagons"}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\t\\tAll wagons and head\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", 
             RowBox[{"Most", "[", "new", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "newn"}], "}"}], ",", 
              RowBox[{"new", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\\tProblem unloading\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.757541287829062*^9, 3.75754132055529*^9}, {
  3.757541370458226*^9, 3.757541382121005*^9}, {3.757541412657538*^9, 
  3.757541426014131*^9}, {3.7575414588648167`*^9, 3.757541468261582*^9}, {
  3.757541515886451*^9, 3.757541583750464*^9}, {3.758480127764936*^9, 
  3.75848012830846*^9}, {3.7584821049633217`*^9, 3.758482105097*^9}, {
  3.7584821506101427`*^9, 3.7584821529972563`*^9}, {3.758482462997675*^9, 
  3.758482473114874*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"dbefce7e-2a04-4a10-82c2-ab5ce2809688"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{"top_List", ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"tl_", "/;", 
              RowBox[{"tl", ">", "1"}]}]}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pass", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
         "ph"}]}], ",", "new", ",", "wntf"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Unloading, \>\"", ",", "tl", ",", "\"\< ticks to go.\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pass", "\[LessEqual]", "\[Lambda]\[Upsilon]"}], 
        RowBox[{"(*", 
         RowBox[{
         "only", " ", "a", " ", "small", " ", "percentage", " ", "of", " ", 
          "passengers", " ", "to", " ", "exit"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<\\tEmpty the bus, go to loading\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"top", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", "0", "}"}], ",", "w"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", "0"}], "}"}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<\\tNeed to unload\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"new", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}], "<", "0"}], ",", 
            "0", ",", 
            RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"new", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "p", "}"}], ",", 
               RowBox[{"Floor", "[", 
                RowBox[{"new", "/", "p"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Mod", "[", 
              RowBox[{"new", ",", "p"}], "]"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"w", "-", 
                RowBox[{"Floor", "[", 
                 RowBox[{"new", "/", "p"}], "]"}]}]}], "]"}]}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"wntf", "=", 
          RowBox[{"Count", "[", 
           RowBox[{"new", ",", 
            RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\\t\>\"", ",", "new"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\\tNumber of new empty wagons: \>\"", ",", "wntf"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"wntf", "\[GreaterEqual]", "1"}], 
           RowBox[{"(*", 
            RowBox[{"passengers", " ", "in", " ", "some", " ", "wagons"}], 
            "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<\\t\\tSome wagons, not head\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Most", "[", "new", "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"tl", "-", "1"}]}], "}"}], ",", "0"}], "}"}], ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], 
               "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"wntf", "\[Equal]", "0"}], 
           RowBox[{"(*", 
            RowBox[{"passengers", " ", "in", " ", "all", " ", "wagons"}], 
            "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\\t\\tAll wagons and head\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Most", "[", "new", "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"tl", "-", "1"}]}], "}"}], ",", 
                  RowBox[{"new", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], 
               "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<\\tProblem unloading\>\"", "]"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.757534502089514*^9, 3.7575345974077187`*^9}, {
   3.7575347521014633`*^9, 3.757534841108519*^9}, {3.757534879028319*^9, 
   3.757534925115703*^9}, {3.757534966403092*^9, 3.757534977090084*^9}, {
   3.7575350308988733`*^9, 3.757535075625945*^9}, {3.75753752464648*^9, 
   3.757537554421344*^9}, {3.757537681314261*^9, 3.757537787368505*^9}, {
   3.7575384214035997`*^9, 3.7575384913625927`*^9}, {3.7575385664964037`*^9, 
   3.757538576191337*^9}, {3.757539350187571*^9, 3.757539366516136*^9}, {
   3.757539414144938*^9, 3.757539553406385*^9}, {3.757539616181175*^9, 
   3.757539856232952*^9}, {3.7575400263023367`*^9, 3.757540125089189*^9}, {
   3.757540222461514*^9, 3.757540301544537*^9}, {3.757540334511167*^9, 
   3.7575403374233103`*^9}, {3.757541240900365*^9, 3.757541247508295*^9}, 
   3.757541621091655*^9, {3.7584821618748713`*^9, 3.758482164148896*^9}, 
   3.762443758914979*^9, {3.762443919647064*^9, 3.762443926169159*^9}, {
   3.762444057651415*^9, 3.762444069354136*^9}, {3.7624441107075377`*^9, 
   3.76244417336891*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"6cdcbdbc-6c35-4e3c-a6f7-1e31b3c9ab00"],

Cell[TextData[{
 "Load case, add ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "71035ee9-0553-4261-bf59-0a550bd12b6c"],
 " passengers from the total (back to front), check if bus is full or number \
of passengers is less than \[Lambda]\[Upsilon]  to change status to 0."
}], "Text",
 CellChangeTimes->{{3.7575339547965183`*^9, 3.757533991056507*^9}, {
   3.7575342730283327`*^9, 3.7575342738358517`*^9}, {3.757534420409361*^9, 
   3.7575344728803177`*^9}, {3.757542062227556*^9, 3.757542113274468*^9}, 
   3.758379643828998*^9, {3.77184736051274*^9, 
   3.7718473706325502`*^9}},ExpressionUUID->"e6c2ba97-8d0b-4008-b39a-\
ed940e98875d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"top", ":", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "_"}], "}"}], ",", "__"}], "}"}]}], ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "prev_"}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<No one to load, go to move\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"{", 
         RowBox[{"wagons", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "ph"}], "}"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"nothing", " ", "to", " ", "load"}], "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.758482973744182*^9, 3.7584831229263897`*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"b5df34bc-575c-4d2f-af32-5d82a7f86095"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"topprev___", ",", 
        RowBox[{"{", 
         RowBox[{"atstat_", ",", "\[Alpha]_"}], "}"}], ",", "aft__"}], "}"}], 
      ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "prev_"}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"newpass", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
         "ph"}]}], ",", "load", ",", "newwagons", ",", "newload", ",", 
       "newph"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Loading people.\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"load", "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"atstat", "\[GreaterEqual]", "\[Lambda]\[Upsilon]"}], "&&", 
          
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"enough", " ", "passengers"}], ",", " ", 
           RowBox[{"enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<\\tLoad all possible.\>\"", "]"}], ";", 
          "\[Lambda]\[Upsilon]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "\[GreaterEqual]", "\[Lambda]\[Upsilon]"}], "&&", 
          
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], ">", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"enough", " ", "passengers"}], ",", " ", 
           RowBox[{"not", " ", "much", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tLoad few, bus almost full.\>\"", "]"}], ";", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], "p"}], "-", "newpass"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "<", "\[Lambda]\[Upsilon]"}], "&&", 
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"not", " ", "enough", " ", "passengers"}], ",", " ", 
           RowBox[{"enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tLoad few, station almost empty.\>\"", "]"}], 
          ";", "atstat"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "<", "\[Lambda]\[Upsilon]"}], "&&", 
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], ">", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"not", " ", "enough", " ", "passengers"}], ",", " ", 
           RowBox[{"not", " ", "enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<\\tLoad few, station almost empty and bus almost full.\>\"", 
           "]"}], ";", 
          RowBox[{"Min", "[", 
           RowBox[{"atstat", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"w", "+", "1"}], ")"}], "p"}], "-", "newpass"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tProblem calculating how many to load.\>\"", 
           "]"}], ";", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Will load \>\"", ",", "load"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newpass", "=", 
       RowBox[{"newpass", "+", "load"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<New passangers = \>\"", ",", "newpass"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newwagons", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"newpass", "/", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Fill \>\"", ",", "newwagons", ",", "\"\< wagons\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newwagons", ",", "newph"}], "}"}], "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newwagons", "\[Equal]", 
          RowBox[{"w", "+", "1"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"all", " ", "wagons", " ", "full"}], ",", " ", 
           RowBox[{"passengers", " ", "to", " ", "head"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tall wagons full, all passengers to head.\>\"",
            "]"}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
            RowBox[{"ph", "+", "load"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"newwagons", "\[Equal]", "w"}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fill", " ", "all", " ", "wagons"}], ",", " ", 
           RowBox[{"excess", " ", "passengers", " ", "to", " ", "head"}]}], 
          "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<\\tfill all wagons, excess passengers to head.\>\"", "]"}], 
          ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"newpass", ",", "p"}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"newwagons", "\[Equal]", 
          RowBox[{"w", "-", "1"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fill", " ", "most", " ", "wagons"}], ",", " ", 
           RowBox[{
           "excess", " ", "passengers", " ", "to", " ", "first", " ", 
            "wagon"}]}], "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<\\tfill most wagons, excess passengers to first.\>\"", "]"}], 
          ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", "p", "}"}], ",", 
                RowBox[{"w", "-", "1"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Mod", "[", 
                RowBox[{"newpass", ",", "p"}], "]"}], "}"}]}], "]"}], ",", 
            "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"newwagons", "<", 
          RowBox[{"w", "-", "1"}]}], 
         RowBox[{"(*", 
          RowBox[{"fill", " ", "some", " ", "wagons"}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<\\tfill some wagons.\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", "p", "}"}], ",", "newwagons"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"Mod", "[", 
                 RowBox[{"newpass", ",", "p"}], "]"}], "}"}], "}"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"w", "-", "newwagons", "-", "1"}]}], "]"}]}], "]"}], 
            ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Print", "[", "\"\<\\tProblem filling wagons.\>\"", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{newwagons,newph} is \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"newwagons", ",", "newph"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newload", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"newwagons", ",", "newph"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"load", "<", "\[Lambda]\[Upsilon]"}], "||", 
         RowBox[{"newph", "\[Equal]", "p"}], "||", 
         RowBox[{"newload", "\[Equal]", "prev"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<\\tBus full, or no one to load.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"topprev", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"atstat", "-", "load"}], ",", "\[Alpha]"}], "}"}], ",",
              "aft"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sequence", "@@", "newwagons"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "newph"}], "}"}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<\\tBus filling.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"topprev", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"atstat", "-", "load"}], ",", "\[Alpha]"}], "}"}], ",",
              "aft"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sequence", "@@", "newwagons"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "newload"}], "}"}], ",", "newph"}], "}"}], 
             ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
          "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.750429589666932*^9, 3.750429594424943*^9}, {
   3.750429681248145*^9, 3.750429684552951*^9}, 3.757534488973434*^9, 
   3.758379839417145*^9, 3.7583861933498898`*^9, {3.758479177873212*^9, 
   3.758479211216147*^9}, {3.758482173526119*^9, 3.758482183410152*^9}, {
   3.7584837354864473`*^9, 3.7584837594366093`*^9}, {3.7584838647151318`*^9, 
   3.758483929031191*^9}, {3.758484057767179*^9, 3.758484069717186*^9}, {
   3.762442506346547*^9, 3.762442535597066*^9}, 3.76244264944569*^9, {
   3.7718489252056303`*^9, 3.7718489461963654`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"ce593845-1231-4d43-8e38-24da98c326d6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions without messages", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 
  3.7569089811333857`*^9}},ExpressionUUID->"4871f7f6-7b10-4097-9568-\
3ce7900f97a5"],

Cell["stopAndunload", "Text",
 CellChangeTimes->{{3.757533308336239*^9, 
  3.757533313790022*^9}},ExpressionUUID->"f97db9a5-e004-47c1-91c8-\
0af1b762e757"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stopAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top_",
       FontSlant->"Italic"], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sequence", "@@", "sizepat"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "/;", 
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "0", ",", "_"}], "}"}], 
        ",", "___"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{
   "Print", "[", "\"\<At station, moving too fast, problem\>\"", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7575125363215714`*^9, 3.757512536786708*^9}, {
   3.757512689148435*^9, 3.757512839328857*^9}, {3.757533050406497*^9, 
   3.757533050970915*^9}, 3.777659246204108*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"ef31de4e-6700-4eb9-afd1-1d11db1c2419"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stopAndUnload", "[", 
   RowBox[{"{", 
    RowBox[{
     StyleBox["top_",
      FontSlant->"Italic"], ",", 
     RowBox[{"{", 
      RowBox[{"wagons___", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v_", "/;", 
          RowBox[{"v", "<=", 
           RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "0", ",", "p_"}], "}"}], 
       ",", "rest___"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"time", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"pu", 
        FractionBox[
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
          "p"}], "\[Lambda]\[Upsilon]"]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"time", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"{", 
         RowBox[{"wagons", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}]}], 
             "}"}], ",", "p"}], "}"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"{", 
         RowBox[{"wagons", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "time"}], "}"}], ",", "p"}], "}"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
       "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.757512846463655*^9, 3.757512964428207*^9}, {
   3.757512997865345*^9, 3.7575130112573757`*^9}, {3.7575131524227257`*^9, 
   3.757513217509941*^9}, 3.757513256787787*^9, {3.757533057237611*^9, 
   3.757533078107123*^9}, {3.7584800653496733`*^9, 3.758480067751424*^9}, {
   3.758480219690282*^9, 3.758480368583946*^9}, {3.758485824812153*^9, 
   3.758485841866559*^9}, {3.7587332105885143`*^9, 3.758733215602498*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"291c116d-c3fe-48f3-aa6b-048793a66d2b"],

Cell["loadAndUnload", "Text",
 CellChangeTimes->{{3.757533322014868*^9, 
  3.7575333280150757`*^9}},ExpressionUUID->"70385013-3fb9-4587-b232-\
a85f419aca10"],

Cell[TextData[{
 "Unload case, substract ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "18a4229a-5948-4208-a5ca-8d52f84c644a"],
 " passengers from the total (front to back), diminish the unloading time by \
one (if it is 1, unload and change to loading state)."
}], "Text",
 CellChangeTimes->{{3.7575339547965183`*^9, 3.757533991056507*^9}, {
  3.7575342730283327`*^9, 3.7575342738358517`*^9}, {3.757534420409361*^9, 
  3.7575344728803177`*^9}, {3.7584801529855967`*^9, 3.7584801530493813`*^9}, {
  3.7584801894888277`*^9, 
  3.758480196640493*^9}},ExpressionUUID->"d42d4228-5715-4710-934f-\
bfc65a14dcf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadAndUnload", "[", 
   RowBox[{"{", 
    RowBox[{"top_List", ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "___"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", "ph_"}], "}"}], ",", "__"}], 
       "}"}]}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pass", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
        "ph"}]}], ",", "new", ",", "wntf", ",", "newn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newn", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}], "<", "0"}], ",", "0", 
        ",", 
        RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "p", "}"}], ",", 
           RowBox[{"Floor", "[", 
            RowBox[{"newn", "/", "p"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Mod", "[", 
          RowBox[{"newn", ",", "p"}], "]"}], "}"}], ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"w", "-", 
            RowBox[{"Floor", "[", 
             RowBox[{"newn", "/", "p"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wntf", "=", 
      RowBox[{"Count", "[", 
       RowBox[{"new", ",", 
        RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"wntf", "\[GreaterEqual]", "1"}], 
       RowBox[{"(*", 
        RowBox[{"passengers", " ", "in", " ", "some", " ", "wagons"}], "*)"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"top", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"Most", "[", "new", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "newn"}], "}"}], ",", "0"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"wntf", "\[Equal]", "0"}], 
       RowBox[{"(*", 
        RowBox[{"passengers", " ", "in", " ", "all", " ", "wagons"}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"top", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"Most", "[", "new", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "newn"}], "}"}], ",", 
             RowBox[{"new", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\\tProblem unloading\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.757541287829062*^9, 3.75754132055529*^9}, {
  3.757541370458226*^9, 3.757541382121005*^9}, {3.757541412657538*^9, 
  3.757541426014131*^9}, {3.7575414588648167`*^9, 3.757541468261582*^9}, {
  3.757541515886451*^9, 3.757541583750464*^9}, {3.758480127764936*^9, 
  3.75848012830846*^9}, {3.7584821049633217`*^9, 3.758482105097*^9}, {
  3.7584821506101427`*^9, 3.7584821529972563`*^9}, {3.758482462997675*^9, 
  3.758482473114874*^9}, {3.75873322821481*^9, 3.7587332391706877`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"535cf175-5ad7-4f43-a2ff-08d82520a41b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{"top_List", ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"tl_", "/;", 
              RowBox[{"tl", ">", "1"}]}]}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pass", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
         "ph"}]}], ",", "new", ",", "wntf"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pass", "\[LessEqual]", "\[Lambda]\[Upsilon]"}], 
       RowBox[{"(*", 
        RowBox[{
        "only", " ", "a", " ", "small", " ", "percentage", " ", "of", " ", 
         "passengers", " ", "to", " ", "exit"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"top", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", "w"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", "0"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"new", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}], "<", "0"}], ",", 
           "0", ",", 
           RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"new", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", 
              RowBox[{"Floor", "[", 
               RowBox[{"new", "/", "p"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"Mod", "[", 
             RowBox[{"new", ",", "p"}], "]"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"w", "-", 
               RowBox[{"Floor", "[", 
                RowBox[{"new", "/", "p"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"wntf", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"new", ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"wntf", "\[GreaterEqual]", "1"}], 
          RowBox[{"(*", 
           RowBox[{"passengers", " ", "in", " ", "some", " ", "wagons"}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{"Most", "[", "new", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"tl", "-", "1"}]}], "}"}], ",", "0"}], "}"}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"wntf", "\[Equal]", "0"}], 
          RowBox[{"(*", 
           RowBox[{"passengers", " ", "in", " ", "all", " ", "wagons"}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{"Most", "[", "new", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"tl", "-", "1"}]}], "}"}], ",", 
                RowBox[{"new", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
           "}"}], ",", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<\\tProblem unloading\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.757534502089514*^9, 3.7575345974077187`*^9}, {
   3.7575347521014633`*^9, 3.757534841108519*^9}, {3.757534879028319*^9, 
   3.757534925115703*^9}, {3.757534966403092*^9, 3.757534977090084*^9}, {
   3.7575350308988733`*^9, 3.757535075625945*^9}, {3.75753752464648*^9, 
   3.757537554421344*^9}, {3.757537681314261*^9, 3.757537787368505*^9}, {
   3.7575384214035997`*^9, 3.7575384913625927`*^9}, {3.7575385664964037`*^9, 
   3.757538576191337*^9}, {3.757539350187571*^9, 3.757539366516136*^9}, {
   3.757539414144938*^9, 3.757539553406385*^9}, {3.757539616181175*^9, 
   3.757539856232952*^9}, {3.7575400263023367`*^9, 3.757540125089189*^9}, {
   3.757540222461514*^9, 3.757540301544537*^9}, {3.757540334511167*^9, 
   3.7575403374233103`*^9}, {3.757541240900365*^9, 3.757541247508295*^9}, 
   3.757541621091655*^9, {3.7584821618748713`*^9, 3.758482164148896*^9}, {
   3.758733257685616*^9, 3.758733274258732*^9}, {3.762444247464937*^9, 
   3.762444249703003*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"9fbde3dc-3491-408d-b0c2-46127c7c7dd6"],

Cell[TextData[{
 "Load case, add ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "7df77c19-0529-4bac-a7b0-75b5929885c8"],
 " passengers from the total (back to front), check if bus is full or number \
of passengers remains the same to change status to 0."
}], "Text",
 CellChangeTimes->{{3.7575339547965183`*^9, 3.757533991056507*^9}, {
   3.7575342730283327`*^9, 3.7575342738358517`*^9}, {3.757534420409361*^9, 
   3.7575344728803177`*^9}, {3.757542062227556*^9, 3.757542113274468*^9}, 
   3.758379643828998*^9},ExpressionUUID->"0ef7b520-0c9e-45bd-ac02-\
04861c0c44a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"top", ":", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "_"}], "}"}], ",", "__"}], "}"}]}], ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "prev_"}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"top", ",", 
       RowBox[{"{", 
        RowBox[{"wagons", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "ph"}], "}"}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"nothing", " ", "to", " ", "load"}], "*)"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.758482973744182*^9, 3.7584831229263897`*^9}, {
  3.758733283601969*^9, 3.758733284240638*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"e58bc5d5-2d94-4b2b-84e3-decea4fe8cc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"topprev___", ",", 
        RowBox[{"{", 
         RowBox[{"atstat_", ",", "\[Alpha]_"}], "}"}], ",", "aft__"}], "}"}], 
      ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "prev_"}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"newpass", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
         "ph"}]}], ",", "load", ",", "newwagons", ",", "newload", ",", 
       "newph"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"load", "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"atstat", "\[GreaterEqual]", "\[Lambda]\[Upsilon]"}], "&&", 
          
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"enough", " ", "passengers"}], ",", " ", 
           RowBox[{"enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", "\[Lambda]\[Upsilon]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "\[GreaterEqual]", "\[Lambda]\[Upsilon]"}], "&&", 
          
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], ">", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"enough", " ", "passengers"}], ",", " ", 
           RowBox[{"not", " ", "much", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"w", "+", "1"}], ")"}], "p"}], "-", "newpass"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "<", "\[Lambda]\[Upsilon]"}], "&&", 
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"not", " ", "enough", " ", "passengers"}], ",", " ", 
           RowBox[{"enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", "atstat", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "<", "\[Lambda]\[Upsilon]"}], "&&", 
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], ">", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"not", " ", "enough", " ", "passengers"}], ",", " ", 
           RowBox[{"not", " ", "enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Min", "[", 
          RowBox[{"atstat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"w", "+", "1"}], ")"}], "p"}], "-", "newpass"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tProblem calculating how many to load.\>\"", 
           "]"}], ";", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newpass", "=", 
       RowBox[{"newpass", "+", "load"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newwagons", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"newpass", "/", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newwagons", ",", "newph"}], "}"}], "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newwagons", "\[Equal]", 
          RowBox[{"w", "+", "1"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"all", " ", "wagons", " ", "full"}], ",", " ", 
           RowBox[{"passengers", " ", "to", " ", "head"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
           RowBox[{"ph", "+", "load"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"newwagons", "\[Equal]", "w"}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fill", " ", "all", " ", "wagons"}], ",", " ", 
           RowBox[{"excess", " ", "passengers", " ", "to", " ", "head"}]}], 
          "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
           RowBox[{"Mod", "[", 
            RowBox[{"newpass", ",", "p"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"newwagons", "\[Equal]", 
          RowBox[{"w", "-", "1"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fill", " ", "most", " ", "wagons"}], ",", " ", 
           RowBox[{
           "excess", " ", "passengers", " ", "to", " ", "first", " ", 
            "wagon"}]}], "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "p", "}"}], ",", 
               RowBox[{"w", "-", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Mod", "[", 
               RowBox[{"newpass", ",", "p"}], "]"}], "}"}]}], "]"}], ",", 
           "0"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"newwagons", "<", 
          RowBox[{"w", "-", "1"}]}], 
         RowBox[{"(*", 
          RowBox[{"fill", " ", "some", " ", "wagons"}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "p", "}"}], ",", "newwagons"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"Mod", "[", 
                RowBox[{"newpass", ",", "p"}], "]"}], "}"}], "}"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"w", "-", "newwagons", "-", "1"}]}], "]"}]}], "]"}], 
           ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Print", "[", "\"\<\\tProblem filling wagons.\>\"", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newload", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"newwagons", ",", "newph"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"load", "<", "\[Lambda]\[Upsilon]"}], "||", 
         RowBox[{"newph", "\[Equal]", "p"}], "||", 
         RowBox[{"newload", "\[Equal]", "prev"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"topprev", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"atstat", "-", "load"}], ",", "\[Alpha]"}], "}"}], ",", 
            "aft"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", "newwagons"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "newph"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"topprev", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"atstat", "-", "load"}], ",", "\[Alpha]"}], "}"}], ",", 
            "aft"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", "newwagons"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "newload"}], "}"}], ",", "newph"}], "}"}], 
            ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750429589666932*^9, 3.750429594424943*^9}, {
   3.750429681248145*^9, 3.750429684552951*^9}, 3.757534488973434*^9, 
   3.758379839417145*^9, 3.7583861933498898`*^9, {3.758479177873212*^9, 
   3.758479211216147*^9}, {3.758482173526119*^9, 3.758482183410152*^9}, {
   3.7584837354864473`*^9, 3.7584837594366093`*^9}, {3.7584838647151318`*^9, 
   3.758483929031191*^9}, {3.758484057767179*^9, 3.758484069717186*^9}, {
   3.758733289407731*^9, 3.758733355283474*^9}, {3.762442693310566*^9, 
   3.762442694713149*^9}, {3.771849533895872*^9, 3.771849551974884*^9}, {
   3.771849595941947*^9, 3.771849616398591*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"8530aa09-bb3f-4d90-8784-834ef589db6c"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["other functions", "Section",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 3.75690904578677*^9}, {3.757533242646553*^9, 
  3.7575332510226316`*^9}, {3.758478677682332*^9, 
  3.758478678138625*^9}},ExpressionUUID->"28662e67-ae17-4ce0-88c0-\
7bfb4aede95c"],

Cell[TextData[{
 "This takes the position of the heads and the output from ",
 Cell[BoxData[
  FormBox[
   StyleBox["move",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "a0215bd5-c6c2-4fa8-b881-114f0f667396"],
 " and returns ",
 Cell[BoxData[
  FormBox[
   StyleBox["track",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "f3688344-6216-4d49-a62e-258a62431e55"],
 " to match"
}], "Text",
 CellChangeTimes->{{3.748019053120804*^9, 3.748019103412537*^9}, {
  3.748025710124076*^9, 
  3.748025711238422*^9}},ExpressionUUID->"6c904cce-eb26-43c4-91fc-\
56c81df5531d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"update", "[", 
    RowBox[{"h_List", ",", 
     RowBox[{"{", 
      RowBox[{"toptrack_", ",", "moved_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tr", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "[", "toptrack", "]"}]}], "]"}]}], ",", "ahead", 
        ",", "rlsup", ",", "rlsdown", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"rlsup", "=", 
           RowBox[{"rlsdown", "=", 
            RowBox[{"{", "}"}]}]}]}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "h", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ahead", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"moved", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "_List", ",", "1",
               ",", "1"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rlsdown", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "ahead", "-", "j"}], 
               "\[Rule]", 
               RowBox[{
                RowBox[{"moved", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"ahead", "+", "1", "+", "w", "-", "j"}], "]"}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"w", "+", "1"}]}], "}"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"moved", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"w", "+", "1"}], "]"}], "]"}], "!=", 
             RowBox[{"toptrack", "[", 
              RowBox[{"[", 
               RowBox[{"h", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"rlsup", ",", 
              RowBox[{
               RowBox[{"h", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"moved", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"w", "+", "1"}], "]"}], "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"toptrack", ",", "rlsup"}], "]"}], ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tr", ",", 
           RowBox[{"rlsdown", "//", "Flatten"}]}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{
     RowBox[{"Length", "[", "h", "]"}], "\[Equal]", 
     RowBox[{"Length", "[", "moved", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"update", "[", "___", "]"}], ":=", 
   RowBox[{"Print", "[", "\"\<Update problem\>\"", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750713124601812*^9, 3.750713196626897*^9}, {
   3.761935709187643*^9, 3.761935714919177*^9}, {3.76218717056458*^9, 
   3.762187188927704*^9}, {3.762189294778338*^9, 3.762189332001729*^9}, 
   3.762441723931707*^9, {3.762445985470942*^9, 3.762446030580633*^9}, {
   3.7754948238763227`*^9, 3.775494846602611*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"e588da51-99d7-430a-8264-2b9b91085515"],

Cell[BoxData[
 RowBox[{
  RowBox[{"update", "[", 
   RowBox[{"heads", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"move", "/@", "neighbors"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.747669641846209*^9, 3.747669644260633*^9}, {
   3.748024077553132*^9, 3.748024124635054*^9}, {3.748025465584773*^9, 
   3.7480255000676403`*^9}, {3.748025880261367*^9, 3.748025887581739*^9}, 
   3.748195688417997*^9, 3.748448720197466*^9, {3.750713586092608*^9, 
   3.750713596138451*^9}, 3.750772098813278*^9},
 CellLabel->
  "In[223]:=",ExpressionUUID->"374dd65b-1fe2-469f-9630-ea16b96fb6f4"],

Cell[TextData[{
 "This takes the track and cleans the last ",
 Cell[BoxData[
  FormBox[
   StyleBox["los",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "26da4fee-55e8-4217-bf96-11f956a9a40f"],
 " spaces."
}], "Text",
 CellChangeTimes->{{3.7481063654737453`*^9, 3.748106379688794*^9}, {
  3.7481064366359997`*^9, 3.748106438145303*^9}, {3.7481064779143248`*^9, 
  3.748106488288312*^9}, {3.748106629179949*^9, 3.7481066344510612`*^9}, {
  3.748545809815675*^9, 3.748545822751485*^9}, {3.775491989349339*^9, 
  3.7754919896042833`*^9}},ExpressionUUID->"de8a89b0-9fbf-4465-8316-\
cc8ef2c770e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"clean", "[", 
    RowBox[{"all", ":", 
     RowBox[{"{", 
      RowBox[{"_List", ",", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "los"}], "]"}]}]}], "}"}]}], "}"}]}], "]"}], ":=",
    "all"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clean", "[", 
   RowBox[{"{", 
    RowBox[{"t1_List", ",", "t2_List"}], "}"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", "t2", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"t1", ",", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"t2", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "-", "i"}], "\[Rule]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "los"}], "}"}]}], "]"}]}], "]"}]}], 
     "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7481066660100803`*^9, 3.748106685247014*^9}, {
   3.748106743132887*^9, 3.748106761068407*^9}, {3.748107027024304*^9, 
   3.7481071442706327`*^9}, {3.748107180389435*^9, 3.7481072174488573`*^9}, {
   3.748107248958696*^9, 3.748107288491646*^9}, {3.748107342364038*^9, 
   3.74810734250038*^9}, {3.7481964835278273`*^9, 3.7481964836049347`*^9}, 
   3.7485491187972517`*^9, 3.759169047796501*^9, {3.775492000424283*^9, 
   3.775492000708544*^9}, {3.775495459073104*^9, 3.775495459566978*^9}, {
   3.777302436676429*^9, 3.7773024385221148`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"2990deab-e4cb-4f86-8c84-ed040d38d255"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["fillstations",
     FontWeight->"Bold"], "[", 
    StyleBox["station",
     FontSlant->"Italic"], "]"}], TraditionalForm]],ExpressionUUID->
  "fdce66b4-7efb-494b-972d-aa1c25cfa021"],
 " takes a ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["station",
      FontSlant->"Italic"], "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["p", "i"], ",", "\[Alpha]"}], "}"}]}], ","}], 
   TraditionalForm]],ExpressionUUID->"89f66209-f0a3-4c48-9bbe-d27fb0e66b18"],
 " and fills it adding ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "0c9ad181-72c9-46b3-82db-f9053a0ae093"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "i"], TraditionalForm]],ExpressionUUID->
  "85d0a01a-e539-4882-aa9d-8f4b05057b43"],
 " (limit at 100000). It also advances time."
}], "Text",
 CellChangeTimes->{{3.750451760153961*^9, 3.750451801496479*^9}, {
  3.750451863165938*^9, 3.750451953050598*^9}, {3.759170251443931*^9, 
  3.759170260019424*^9}, {3.7591703516335707`*^9, 3.7591703528964453`*^9}, {
  3.769791755389563*^9, 
  3.7697917733276787`*^9}},ExpressionUUID->"2ea49c77-28c1-4db0-937b-\
a1b173a5cb9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fillstations", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p_", "/;", 
       RowBox[{"p", "\[GreaterEqual]", "100000"}]}], ",", "\[Alpha]_"}], 
     "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"100000", ",", "\[Alpha]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fillstations", "[", 
    RowBox[{"{", 
     RowBox[{"p_", ",", "\[Alpha]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "+", "\[Alpha]"}], ",", "\[Alpha]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fillstations", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\[Omega]_", ",", "\[Phi]_", ",", "t_"}], "}"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\[Omega]", ",", "\[Phi]", ",", 
      RowBox[{"t", "+", "1"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fillstations", "[", 
    RowBox[{"s", ":", "___"}], "]"}], ":=", "s"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750452030147706*^9, 3.750452215151544*^9}, {
  3.750712458308178*^9, 3.750712458763319*^9}, {3.750712572336907*^9, 
  3.750712591551587*^9}, {3.75088318501324*^9, 3.75088321785758*^9}, {
  3.759170359193892*^9, 3.7591704191315928`*^9}, {3.769791790456608*^9, 
  3.769791814614616*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"2f324dec-e31c-4c2c-a892-c518afac5b28"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["advanceOne",
     FontWeight->"Bold"], "[", 
    StyleBox["track",
     FontSlant->"Italic"], "]"}], TraditionalForm]],ExpressionUUID->
  "0a996ae8-21b8-4cef-9560-5c648b06e374"],
 " takes a ",
 Cell[BoxData[
  FormBox[
   StyleBox["track",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "4bd3792c-6645-49e5-bb48-120a10061dce"],
 ", advances the buses, loads and unloads passengers, loads stations, \
advances time and tries to place a new bus at the start."
}], "Text",
 CellChangeTimes->{{3.7507034546438026`*^9, 3.750703471506812*^9}, {
  3.750703503691321*^9, 3.750703598192567*^9}, {3.750879305360405*^9, 
  3.7508793280955353`*^9}},ExpressionUUID->"f66e121d-c02b-43bf-bcc3-\
a0343fe9c62c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"advanceOne", "[", 
    RowBox[{"all", ":", 
     RowBox[{"{", 
      RowBox[{"ut_List", ",", "lt_List"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"heads", ",", "neighbors", ",", "moved"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"find", " ", "the", " ", "buses"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"step", "++"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"heads", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"lt", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "build", " ", "the", " ", "neighborhoods", " ", "of", " ", "the", " ", 
        "buses"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"neighbors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ut", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"#", "-", "w"}], ";;", 
              RowBox[{"#", "+", "los"}]}], "]"}], "]"}], ",", 
           RowBox[{"lt", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"#", "-", "w"}], ";;", 
              RowBox[{"#", "+", "los"}]}], "]"}], "]"}]}], "}"}], "&"}], "/@",
         "heads"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "find", " ", "new", " ", "positions", " ", "of", " ", "the", " ", 
        "buses"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "update", " ", "bus", " ", "positions", " ", "and", " ", "passenger", 
        " ", "loads"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"update", "[", 
        RowBox[{"heads", ",", 
         RowBox[{"{", 
          RowBox[{"ut", ",", 
           RowBox[{"move", "/@", "neighbors"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Load", " ", "stations"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"update", " ", "time"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"moved", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"fillstations", "/@", 
        RowBox[{"moved", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Clean", " ", "the", " ", "end", " ", "of", " ", "the", " ", "track"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"clean", "[", "moved", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Place", " ", "a", " ", "new", " ", "bus"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"newbus", "[", "moved", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "done", "*)"}], "\[IndentingNewLine]", "moved"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"advanceOne", "[", "___", "]"}], ":=", 
  RowBox[{"Print", "[", "\"\<Not a valid track\>\"", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750703374508174*^9, 3.750703412379362*^9}, {
   3.7507113229467278`*^9, 3.750711331036972*^9}, {3.750711369088517*^9, 
   3.750711383352607*^9}, {3.750711463423234*^9, 3.7507115905496073`*^9}, {
   3.750711656093367*^9, 3.75071170273173*^9}, {3.750712413281527*^9, 
   3.750712429202321*^9}, {3.750712614848542*^9, 3.750712706667368*^9}, {
   3.7507127837172813`*^9, 3.750712865447394*^9}, {3.750713609060687*^9, 
   3.750713752794245*^9}, {3.750714162888832*^9, 3.7507142303763647`*^9}, {
   3.750714398970551*^9, 3.7507144028406553`*^9}, {3.750714441229477*^9, 
   3.750714442444865*^9}, {3.750794461899194*^9, 3.750794480977352*^9}, {
   3.750794545981142*^9, 3.750794559962837*^9}, {3.7507956449906178`*^9, 
   3.750795693881771*^9}, {3.750797980814268*^9, 3.750798000355988*^9}, {
   3.750798041051797*^9, 3.750798045767384*^9}, 3.7508797088417053`*^9, {
   3.750881503081153*^9, 3.750881504817297*^9}, {3.750883574151743*^9, 
   3.7508835880154963`*^9}, {3.762183584158002*^9, 3.762183608990088*^9}, {
   3.766335163007577*^9, 3.7663351716368027`*^9}, {3.7669473090954723`*^9, 
   3.766947312899055*^9}, {3.7693436190024767`*^9, 3.7693436457611437`*^9}, {
   3.769344251076123*^9, 3.769344251484008*^9}, {3.775491901032976*^9, 
   3.77549194036677*^9}, {3.7754942550798397`*^9, 3.775494275726572*^9}, {
   3.77549465653857*^9, 3.775494698779525*^9}, {3.775495017222496*^9, 
   3.775495073725129*^9}, {3.775495215585044*^9, 3.775495235374208*^9}, {
   3.775495357640321*^9, 3.7754953699927807`*^9}, {3.775495992039385*^9, 
   3.775495992548934*^9}, {3.775496771374064*^9, 3.775496800924754*^9}, {
   3.7776399507994556`*^9, 3.777639971638246*^9}, {3.777642129846613*^9, 
   3.7776421445490723`*^9}, {3.777652431268732*^9, 3.777652436939636*^9}, {
   3.778514281298046*^9, 3.77851428430937*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"3c419cf4-7e2d-4c7c-98c6-7e02bc850427"],

Cell["with messages", "Text",
 CellChangeTimes->{{3.7776421600861807`*^9, 
  3.777642165042425*^9}},ExpressionUUID->"565d0048-299d-4b1e-850d-\
40055f15c9e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"advanceOne", "[", 
    RowBox[{"all", ":", 
     RowBox[{"{", 
      RowBox[{"ut_List", ",", "lt_List"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"heads", ",", "neighbors", ",", "moved"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"find", " ", "the", " ", "buses"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"heads", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"lt", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<heads ok\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "build", " ", "the", " ", "neighborhoods", " ", "of", " ", "the", " ", 
        "buses"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"neighbors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ut", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"#", "-", "w"}], ";;", 
              RowBox[{"#", "+", "los"}]}], "]"}], "]"}], ",", 
           RowBox[{"lt", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"#", "-", "w"}], ";;", 
              RowBox[{"#", "+", "los"}]}], "]"}], "]"}]}], "}"}], "&"}], "/@",
         "heads"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<neighbors ok\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "find", " ", "new", " ", "positions", " ", "of", " ", "the", " ", 
        "buses"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "update", " ", "bus", " ", "positions", " ", "and", " ", "passenger", 
        " ", "loads"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"update", "[", 
        RowBox[{"heads", ",", 
         RowBox[{"{", 
          RowBox[{"ut", ",", 
           RowBox[{"move", "/@", "neighbors"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<moved ok\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Load", " ", "stations"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"update", " ", "time"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"moved", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"fillstations", "/@", 
        RowBox[{"moved", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<stations ok\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Clean", " ", "the", " ", "end", " ", "of", " ", "the", " ", "track"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"clean", "[", "moved", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<clean ok\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Place", " ", "a", " ", "new", " ", "bus"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"newbus", "[", "moved", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<new ok\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "done", "*)"}], "\[IndentingNewLine]", "moved"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"advanceOne", "[", "___", "]"}], ":=", 
  RowBox[{"Print", "[", "\"\<Not a valid track\>\"", "]"}]}]}], "Input",
 CellChangeTimes->{{3.750703374508174*^9, 3.750703412379362*^9}, {
   3.7507113229467278`*^9, 3.750711331036972*^9}, {3.750711369088517*^9, 
   3.750711383352607*^9}, {3.750711463423234*^9, 3.7507115905496073`*^9}, {
   3.750711656093367*^9, 3.75071170273173*^9}, {3.750712413281527*^9, 
   3.750712429202321*^9}, {3.750712614848542*^9, 3.750712706667368*^9}, {
   3.7507127837172813`*^9, 3.750712865447394*^9}, {3.750713609060687*^9, 
   3.750713752794245*^9}, {3.750714162888832*^9, 3.7507142303763647`*^9}, {
   3.750714398970551*^9, 3.7507144028406553`*^9}, {3.750714441229477*^9, 
   3.750714442444865*^9}, {3.750794461899194*^9, 3.750794480977352*^9}, {
   3.750794545981142*^9, 3.750794559962837*^9}, {3.7507956449906178`*^9, 
   3.750795693881771*^9}, {3.750797980814268*^9, 3.750798000355988*^9}, {
   3.750798041051797*^9, 3.750798045767384*^9}, 3.7508797088417053`*^9, {
   3.750881503081153*^9, 3.750881504817297*^9}, {3.750883574151743*^9, 
   3.7508835880154963`*^9}, {3.762183584158002*^9, 3.762183608990088*^9}, {
   3.766335163007577*^9, 3.7663351716368027`*^9}, {3.7669473090954723`*^9, 
   3.766947312899055*^9}, {3.7693436190024767`*^9, 3.7693436457611437`*^9}, {
   3.769344251076123*^9, 3.769344251484008*^9}, {3.775491901032976*^9, 
   3.77549194036677*^9}, {3.7754942550798397`*^9, 3.775494275726572*^9}, {
   3.77549465653857*^9, 3.775494698779525*^9}, {3.775495017222496*^9, 
   3.775495073725129*^9}, {3.775495215585044*^9, 3.775495235374208*^9}, {
   3.775495357640321*^9, 3.7754953699927807`*^9}, {3.775495992039385*^9, 
   3.775495992548934*^9}, {3.775496771374064*^9, 3.775496800924754*^9}, {
   3.7776399507994556`*^9, 3.777639971638246*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"c70c1c1d-fd90-4bff-9903-3bcc91cc911b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation", "Section",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 3.75690904578677*^9}, {3.757533242646553*^9, 
  3.7575332510226316`*^9}, {3.758478677682332*^9, 3.758478678138625*^9}, {
  3.765714671591254*^9, 
  3.765714672966627*^9}},ExpressionUUID->"74037869-b1c7-4b44-ae05-\
0b5b338b2cd6"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["busSimulation",
     FontWeight->"Bold"], "[", 
    RowBox[{
     StyleBox["size",
      FontSlant->"Italic"], ",", " ", 
     StyleBox["time",
      FontSlant->"Italic"]}], "]"}], TraditionalForm]],ExpressionUUID->
  "f8647d32-e58b-4828-9927-4a4904bb42ee"],
 " returns a simulation of ",
 Cell[BoxData[
  FormBox[
   StyleBox["times",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "d01cec52-007b-4df9-b764-95965230381e"],
 " steps and size ",
 Cell[BoxData[
  FormBox[
   RowBox[{"5", 
    RowBox[{"w", "\[Cross]", 
     StyleBox["size",
      FontSlant->"Italic"], 
     StyleBox[" ",
      FontSlant->"Italic"]}]}], TraditionalForm]],ExpressionUUID->
  "d4737d0c-5895-4e29-b7a5-6e0eefa0e2d2"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["busSimulation",
     FontWeight->"Bold"], "[", 
    RowBox[{
     StyleBox["track",
      FontSlant->"Italic"], ",", " ", 
     StyleBox["time",
      FontSlant->"Italic"]}], "]"}], TraditionalForm]],ExpressionUUID->
  "47e0d09e-8244-4401-9af4-9a7f37f920f6"],
 " returns a simulation of ",
 Cell[BoxData[
  FormBox[
   StyleBox["time",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "cafebf02-a024-4e64-adf4-f2d89e34e3c3"],
 " steps using ",
 Cell[BoxData[
  FormBox[
   StyleBox["track",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "cebf28cc-e29f-4ff4-a401-fc5972c2c42f"],
 " as an initial condition (",
 Cell[BoxData[
  FormBox[
   StyleBox["track",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "bd9a9c62-6790-4ef6-8c31-20cb142d3511"],
 " must be of the form described in Data Structures)"
}], "Text",
 CellChangeTimes->{{3.7507034546438026`*^9, 3.750703471506812*^9}, {
  3.750703503691321*^9, 3.750703598192567*^9}, {3.75087964707157*^9, 
  3.7508796934709167`*^9}, {3.750879856803959*^9, 3.750879883689027*^9}, {
  3.750880252854711*^9, 3.750880287725559*^9}, {3.7718709181458263`*^9, 
  3.771870975664253*^9}, {3.771871099397027*^9, 3.771871100202199*^9}, {
  3.775480468117394*^9, 
  3.775480474036118*^9}},ExpressionUUID->"06fa6ddb-b5bd-406f-a7ce-\
85e5e674227b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"busSimulation", "[", 
   RowBox[{"size_Integer", ",", "time_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"track", ",", "base"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"track", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "2", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"size", " ", "5", "  ", "w"}], "+", "vmax", "-", "am"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"put", " ", "statios"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"stations", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"put", " ", "lights"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"lights", "[", 
       RowBox[{"1", "/", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"fill", " ", "with", " ", "test", " ", "stuff"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vmax", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "ahead"}], ",", " ", 
       RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"15", ";;", "19"}], "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"vmax", "/", "2"}], "]"}], ",", "0", ",", "0"}], "}"}]}], 
       "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "ahead"}], ",", " ", 
       RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"26", ";;", "29"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "30", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "ahead"}], ",", " ", "stoped", ",", " ", "wait"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"31", ";;", "34"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "35", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "ahead"}], ",", " ", 
       RowBox[{"going", " ", "slow"}], ",", " ", "hold"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"94", ";;", "97"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "98", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
      "red", " ", "light", " ", "ahead", " ", "with", " ", "bus", " ", 
       "before", " ", "light"}], "*)"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"37", ";;", "40"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "41", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "station", " ", "ahead", " ", "with", " ", "bus", " ", "before", " ", 
        "station"}], ",", " ", "brake"}], "*)"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"236", ";;", "239"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "240", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vmax", "-", "2"}], ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"station", " ", "ahead"}], ",", " ", "fast", ",", " ", 
       "brake"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"344", ";;", "347"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "348", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"station", " ", "ahead"}], ",", " ", "close", ",", " ", "slow",
        ",", " ", "accelerate"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"444", ";;", "447"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "448", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"station", " ", "ahead"}], ",", " ", "close", ",", " ", "fast",
        ",", " ", "brake"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"60", ";;", "63"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "64", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{"accelerate", ",", " ", 
       RowBox[{"nothing", " ", "nearby"}]}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"100", ";;", "103"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "104", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{"light", " ", "behind"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"283", ";;", "286"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "287", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "far", " ", "ahead"}], ",", " ", 
       RowBox[{"going", " ", "slow"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"46", ";;", "49"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "50", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", 
       RowBox[{"ready", " ", "to", " ", "move"}]}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"146", ";;", "149"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "150", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", 
       "brake", ",", " ", 
       RowBox[{"go", " ", "directly", " ", "to", " ", "loading"}]}], "*)"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"546", ";;", "549"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
        RowBox[{"{", "p", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "550", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"\[Lambda]\[Upsilon]", "-", "1"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}],
        ",", 
       RowBox[{
       "unload", " ", "and", " ", "change", " ", "status", " ", "to", " ", 
        "load"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"646", ";;", "649"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
        RowBox[{"{", "p", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "650", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"p", "/", "2"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}],
        ",", " ", 
       RowBox[{"keeps", " ", "unloading"}]}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"746", ";;", "748"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "3"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
        RowBox[{"{", "p", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "749", "]"}], "]"}], "=", 
      RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "750", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}],
        ",", 
       RowBox[{
       "unload", " ", "and", " ", "change", " ", "status", " ", "to", " ", 
        "load"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"846", ";;", "849"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "850", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "0"}], "}"}], ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "950", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]\[Upsilon]", "-", "4"}], ",", "3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"946", ";;", "949"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
        RowBox[{"{", "p", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "950", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1050", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"3", "\[Lambda]\[Upsilon]"}], ",", "4"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1046", ";;", "1049"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
        RowBox[{"{", "p", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1050", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], ",", 
        RowBox[{"p", "-", "\[Lambda]\[Upsilon]", "+", "3"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
       ",", " ", "fill", ",", " ", 
       RowBox[{"change", " ", "to", " ", "0"}]}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1150", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"5", "\[Lambda]\[Upsilon]"}], ",", "4"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1146", ";;", "1149"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
        RowBox[{"{", "p", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1150", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"p", " ", "w"}], "+", "\[Lambda]\[Upsilon]"}]}], "}"}], 
        ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
       ",", " ", 
       RowBox[{"tricked", " ", "to", " ", "change", " ", "to", " ", "0"}]}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1246", ";;", "1249"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
        RowBox[{"{", "p", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1250", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "am", "]"}], "-", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Abs", "[", "am", "]"}], "/", "2"}], "]"}]}], ",", "0", 
        ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", 
       "brake", ",", " ", 
       RowBox[{"go", " ", "start", " ", "unloading"}]}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"196", ";;", "199"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "200", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"red", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "moving"}], ",", " ", "stop"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"296", ";;", "299"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "300", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"red", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "stoped"}], ",", " ", "wait"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"396", ";;", "399"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "400", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "am", "]"}], "+", "1"}], ",", "0", ",", "0"}], 
       "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Red", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "moving", " ", "fast"}], ",", " ", "move"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "500", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
      "1"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"491", ";;", "494"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "495", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"vmax", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"green", " ", "light"}], ",", " ", "move"}], "*)"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"590", ";;", "593"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "594", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", ",", 
       " ", "hold"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"694", ";;", "697"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "698", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"red", " ", "light"}], ",", " ", "close", ",", " ", "slow", 
       ",", "hold"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"run", " ", "the", " ", "sim"}], "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"NestList", "[", 
      RowBox[{"advanceOne", ",", "track", ",", "time"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750879886678226*^9, 3.750879931146599*^9}, {
   3.750880194227602*^9, 3.7508802466453133`*^9}, {3.750880292820417*^9, 
   3.75088034522744*^9}, {3.7508805441847343`*^9, 3.750880632335047*^9}, {
   3.750881292069434*^9, 3.750881293882012*^9}, {3.750881443022756*^9, 
   3.7508815275254593`*^9}, {3.750942369152068*^9, 3.7509423786740627`*^9}, 
   3.7509430739033623`*^9, {3.7509559081852617`*^9, 3.750955917080933*^9}, {
   3.750958990547008*^9, 3.750958991167016*^9}, 3.7510497546901283`*^9, {
   3.765715954857749*^9, 3.765716019525608*^9}, 3.769344281939747*^9, {
   3.769797458587947*^9, 3.769797460818404*^9}, {3.7697974916549387`*^9, 
   3.76979749201223*^9}, {3.771871104313047*^9, 3.771871124559811*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"1dfd8066-84d7-48a6-ab5e-1f8875cb14e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"busSimulation", "[", 
   RowBox[{
    RowBox[{"track_", "/;", 
     RowBox[{
      RowBox[{"Length", "[", "track", "]"}], "\[Equal]", "2"}]}], ",", 
    "time_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "base", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"run", " ", "the", " ", "sim"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"NestList", "[", 
     RowBox[{"advanceOne", ",", "track", ",", "time"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7718710174978647`*^9, 3.7718710474736023`*^9}, {
  3.7718711150737123`*^9, 3.771871153326518*^9}, {3.775480586397819*^9, 
  3.7754805987699842`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"f88fbbf8-463c-4049-991d-9cbb1c12d6eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"busSimulation", "[", 
    RowBox[{"100", ",", "100"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.771176404774928*^9, 3.771176415294702*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"390bde7c-55fb-41dc-8119-4724cc27307b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorRulesUp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[Rule]", "White"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pi_", ",", "pt_", ",", "_"}], "}"}], "\[RuleDelayed]", 
      RowBox[{"Opacity", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"pi", "+", "1"}], 
         RowBox[{"pt", "+", "1"}]], ",", "Purple"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]_", ",", "\[Phi]_"}], "}"}], ",", "t_"}], "}"}], 
      "\[RuleDelayed]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Green", ",", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}], ">", 
            "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}], 
            "\[LessEqual]", " ", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Black", ",", "True"}], "}"}]}], "}"}], "]"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.750957353615466*^9, 3.750957382987009*^9}, {
   3.7509574245019817`*^9, 3.7509574638451853`*^9}, {3.750957513102743*^9, 
   3.750957515364036*^9}, 3.750958130452462*^9, 3.750958183242405*^9, 
   3.75105209176762*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"4b2150d6-b459-4533-a394-8b2a7a9ef4b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorRulesDown", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[Rule]", 
      RowBox[{"GrayLevel", "[", ".8", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], "->", "Blue"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}], "->", "Blue"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.75095826705075*^9, 3.75095839339187*^9}, {
   3.750958429094742*^9, 3.7509584850718412`*^9}, {3.7509585520499477`*^9, 
   3.750958560895981*^9}, {3.751049942274742*^9, 3.751049955834237*^9}, {
   3.7510500018962803`*^9, 3.751050015564953*^9}, {3.7510500708045197`*^9, 
   3.7510500716330214`*^9}, {3.751050859183445*^9, 3.7510508723251*^9}, {
   3.751051090579206*^9, 3.7510511218157167`*^9}, 3.751052099734272*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"5bb59abc-f8ba-4a77-869e-91442da3477d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ArrayPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"280", ";;", "610"}], "]"}], "]"}], "/.", "colorRulesUp"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"280", ";;", "610"}], "]"}], "]"}], "/.", 
         "colorRulesDown"}]}], "}"}], ",", 
      RowBox[{"AspectRatio", "->", 
       RowBox[{"1", "/", "4"}]}]}], "]"}], "&"}], "/@", "data"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.750958844342145*^9, 3.750958857206452*^9}, {
   3.750959091158309*^9, 3.750959095848509*^9}, {3.7509594601460457`*^9, 
   3.750959464471355*^9}, 3.751049843862733*^9, {3.751050952986011*^9, 
   3.751051051574519*^9}, {3.751052128927947*^9, 3.751052133611301*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"79b1ac0a-bda1-4998-8541-ca3f8c336a4e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i11$$ = 100, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {
    "\"min\"" :> {$CellContext`i11$$ = 1}, 
     "\"max\"" :> {$CellContext`i11$$ = 101}}, Typeset`bookmarkMode$$ = 
    "Menu", Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`i11$$], 1, ""}, 1, 101, 1}}, Typeset`size$$ = 
    Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i11$22196$$ = 0}, 
    PaneBox[
     PanelBox[
      DynamicWrapperBox[GridBox[{
         {
          ItemBox[
           ItemBox[
            TagBox[
             StyleBox[GridBox[{
                {"\<\"\"\>", 
                 AnimatorBox[Dynamic[$CellContext`i11$$], {1, 101, 1},
                  AnimationRate->Automatic,
                  AnimationRunTime->51.25951623916626,
                  AnimationRunning->False,
                  AnimationTimeIndex->4.909516239166351,
                  
                  AppearanceElements->{
                   "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons",
                     "DirectionButton"},
                  AutoAction->False,
                  DisplayAllSteps->True]}
               },
               AutoDelete->False,
               
               GridBoxAlignment->{
                "Columns" -> {Right, {Left}}, "Rows" -> {{Baseline}}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "ListAnimateLabel",
              StripOnInput->False],
             {"ControlArea", Top}],
            Alignment->{Automatic, Inherited},
            StripOnInput->False],
           Background->None,
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            StyleBox[
             PaneBox[
              TagBox[
               PaneSelectorBox[{1->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2U0KgkAYgOGvn4t0hg7QAdp1hKB156nTCa3aeYTMVumEYIijPh/EA76b
IWNsane+ni6biFhXr+MqYlt5v73neWga9ZSt61PrkZwym/Utvbs/uq7ry+yR
HPu/ruu6PmyP5Hj+6Lquz71Hcuz/uq7rU++RHPu7ruu6/l//WHQ8Z4buv66P
//7ouq7PtUdy7L/69+eAHM/m98cik3WRJPO26/cHkiRTOn+QJPvo/EGS7GP7
/LGv55HJ+kiSeer8QZLso/8/hvIFqd1q5Q==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 2->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwkAQgNHxpxFrsAAL8GYJgmfr0eoCnrylBGOOyUogGHYIb0Ae5Lss
Oey6erjeL7ddRGy7z3kTse98Pr7zPg2NftrRcz1Xj+K0ada39vXruq7rdXoU
x/mh67qu60v2KI7zV9f19fcojv1P13Vd12v2KI7zWdf1f+0vzcQ+s3T/9bz+
+9F1Xddz9iiO8+O/75es6fD7Y5NkXSTJ3E79/kCSZEn3D5LkHN0/SJJzHN8/
jv28kqyPJJlT9w+S5Bz9/7GUH9k3auU=
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 3->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2bEJwkAUgOGncRFncAAHsHMEwdp5dLqAlV1GSEyZnASOhJz6PZAP8jen
RL3T/eV2vlYRse0ep03ErvNxf8/rODT6aUbX9e/qkZymmPV5frqu63pOj+T4
/Nd1Xdd1/Xd7JMf+R9e9/3Rd13Vd1/+vR3Lsz/Q576964j5bun+6vv7ro+u6
rusl9kjOfN+f5PoO9491IesiSZbt1O8PJEmmdP4gSebo/EGSzHF8/jj08yxk
fSTJMnX+IEnm6P+PpWwBgTdq5Q==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 4->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6crePLWEaz1Im2KWNAE8gTkgb6X
UKTkazfH8+G0iohl99svItad18tz3XdDo1/t6LpeV4/kaovZX+7u/ui6Xmt/
2Uw+Bz1/dV3XdV3X9W96JJfznf7+PzB/6Lqu67qu67rza/754z996nr++6Pr
uq7rNXYyv8PzY1PIvkiSZfvp/QNJkinNHyTJOZo/SJJzHM8f237dCtkfSbJM
zR8kyTn6/vErH1kRXbc=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 5->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0JwkAYgOFP4yLO4AAOkM4RBGvn0ekCVnYZwZgyPwin5k58DuSBvM2Z
4rhPt8fz4VRFxLr71KuITef18lz3/dDoVzt6rutL9phcbTH7+/Xu/eq6/t75
0cyeI84vXdd1Xdd1XXf//ez3N3/ouq7ruq7ruvtv/vljmT73PP/70XVd1/V/
7GR+h/fHppB9kSTL9tXvDyRJTmn+IEmmaP4gSaY4nj92/boVsj+SZJmaP0iS
Kfr/41s+AJ/PXbc=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 6->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2U0KglAUgNHbz0ZaQwtoAc1aQtC49dTqhEbNXEJmM32SvEgfeC7EAb+J
IA+8tjtfT5dNRKyb33EVsW28397zPHSNduredV3Xx/dITl3M/S29ez66/uv5
qQbPkfOr67qu67qu6/rYHsmpO93+oeu6ruu6rutL6JGc6d6/Pw7vH9P0oevz
Px9d13VdX2In57f7/lgVcl8kybL99v2BJMmU9g+SZI72D5Jkjv39Y9/Oo5D7
I0mWqf2DJJmj/z/+5Qtt9l23
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 7->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwkAQgNHxpxFrsAAL8GYJgmfr0eoCnrxtCcaAl2SDshCzkDcgD/wu
i9mDo7vz9XTZRMS6fR1XEdvW++09z0Pf6CYN3td1Xf/0yE6q5nxL756PPv39
akbvmfut67qu67qu6/qvPbKTet3+oeu6ruu6ruv6/PvHf/r4+eb+/HRd13V9
iZ2c3/73x6aSc5Ek6/bb7w8kSea0f5AkS7R/kCRLHO4f+24elZyPJFmn9g+S
ZIn+/5jKFy1aXbc=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 8->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwkAQgNHxpxFrsAAL8GYJgmfr0eoCnrxtCcYcNxuUgO5C3oA88Lss
m0tGd+fr6bKJiHX/Oa4itr3323ueh9wYJo2+13VdX0qP4qRmzqd7vvXvr5u8
R89P13Vd13Vd1/VvexQnZd3+oeu6ruu6rut6/f3jP336fLXvT9d1XdeX2Mn6
5u+PXSPnIkm27affH0iSLGn/IEnO0f5BkpzjeP/YD/No5HwkyTa1f5Ak5+j/
j1/5AkrgXbc=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 9->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwkAQgNHxpxFrsAAL8GYJgmfr0eoCnrxtCcZ422xQAprFvIHwwO+y
7CljNsfz4bSKiGX77BcR69br5Tn3XW50k3q/67qu6//RozipmvPV3ud+fy+b
wXtw/7qu67qu67quf9qjOCnr9g9d13Vd13Vd16ffP37Th8839f3puq7r+hw7
Ob35+2NTyblIknX77v8HkiRL2j9IkmO0f5Akx9jfP7bd3Co5H0myTu0fJMkx
+v7xLR/7cl23
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 10->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHPn0WcwQEcwM4RTKydR6cjsbJjBJHrAENyETjjcwl5Et7m
oLoPdufr6bKJiHVzHVcR28b77b2eh67Rrrp3X9d1Xdfn6DG46mL2t3Rf+v0k
q5F9fO6//vy6ruu6ruu6rs833yTNH7qu67qu67qul3++T+bPL9/p0z2fruu6
rv9jJ5e3e/6rCtkXSbJsx74fkCQ5pPmDJJmj+YMkmWN//ti361HI/kiSZWr+
IEnm6P/HVL4ApR9Dew==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 11->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwkAQgNHxpxFrsAAL8GYJgmfr0eoCnrylBGOCl2RDYFF2wTcQHuTz
sNFLBnfn6+myiYh1dx1XEdvO++09z8PY6Ked3Nd1Xdf1f+iRnLaa85V+/sFm
4XPz3e+j67qu67qu6/qnR3LsH7qu67qu67qu19cjOfXsB4P5+9N3+tz98t+P
ruu6rud0srzj96+mknORJOt2aX8nSTKl/YMkmaP9gySZ43T/2PfzqOR8JMk6
tX+QJHP0/8evfAEar0N7
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 12->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2bsNglAUgOHjYxFncAAHsHMEE2vn0elIrOwYQYSOR4hXDFf9TkK+hJ/i
hooTNsfz4bSKiGV17RcR68rr5Tn3Xduop+zc13Vd13X9/R69U37N+RqLkeeG
+6+/P13XdV3XdV3X7R+6ruu6ruu6ruuv9uid/9k/GtP3v2n60P3534+u67o+
Tyfnt/39UmRyLpJk3o7tvyRJ9mn/IEmmaP8gSabY3T+29dwyOR9JMk/tHyTJ
FP3/+JQPDSRDew==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 13->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2bsJwlAUgOHjYxFncAAHsHMEwdp5dLqAlV1GMCZdHgSvkVz1OxA+yG9x
SZFwcHM8H06riFhW134Rsa68Xp5z37WNesrOfV3XdV3X3+/RO+XXnK+xGPnd
cP/156fruq7ruq7ruv1D13Vd13Vd13X91R69Y//4l96Yvv9O04fuz/98dF3X
530/k3Pa/n4XmZyLJJm3Y/sfSZJ92j9IkinaP0iSKXb3j209t0zOR5LMU/sH
STJF/398ygeW80N7
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 14->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHnpxFrsAALcGcJgmvr0eoCrtxZgjHZ5UNkYshEzkA4kCtk
mIXy4u58PV02EbEur+MqYlt6v33W89A0qvVq3dd1Xdd1fXyPzvVazP5qi4HP
9fd/Pz9d13Vd13Vd180fuq7ruq7ruq4vr9dON1989/z2c3M5H13Pudemvz/4
Te+7P//56Lo+9vuFnNPm70+Ryb5Iknk7NL+QJNml+YMkmaL5gySZYnv+2Ffr
kcn+SJJ5av4gSabo/4+pfAOrmzZd
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 15->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHnpxFrsAALcGcJgmvr0eoCrtylBGOyy4fISMxEzoAcyA1k
mEXwkd35erpsImJd/Y6riG3l/fZez0PbqFfZua7ruq7r+vc9ele5mP01FiP3
Dfd/Pz9d13Vd13Vd180fuq7ruq7ruq4vrzdON1989vzuc3M5H13X9dT352/6
0PX5z0dfdifnt/3+KzLZF0kyb8f+P5Mk2af5gySZovmDJJlid/7Y1+uRyf5I
knlq/iBJpuj7x1S+APpZNl0=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 16->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHnpxFrsAALcGcJgmvr0eoCrtylBGOyy4fIaHASzkA4kCtk
GBB8cXe+ni6biFhX13EVsa28397reWgb9So793Vd13Vd/75H7ypns7/GYuRz
w33p56fruq7ruq7ruvlD13Vd13Vd1/X59cbp5ovPnt99bi7no+u6ri+zN6a/
f/tNH7qfy/mQ/7T9/Sky2RdJMm/Hfn+RJNmn+YMkmaL5gySZYnf+2Nfrkcn+
SJJ5av4gSabo/4+pfAGrljZd
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 17->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6crePLWEaztrSkUotIEn0B5oG+h
Iad+dHe+ni6biFh313EVse28397reRgb/WqT+7qu67quf95jcrXV7G+wmXku
v9d+frqu67qu67qumz90Xdd1Xdd1Xa+vD+bPD995f/reUs5H13Vd1/+xk8s7
/j5tCtkXSbJs5/6fkiQ5pfmDJJmj+YMkmWM6f+z79ShkfyTJMjV/kCRz9P/j
V74Al9xdpw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 18->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6crePLWEaztrSkUotIEn0B5oG+h
Iad+dHe+ni6biFh313EVse28397reRgb/WqT+7qu67quf95jcrXV7G+wmXku
v9d+frqu67qu67qumz90Xdd1Xdd1Xa+vD+bPD995f/reUs5H13Vd1/+xk8s7
/j5tCtkXSbJs5/6fkiQ5pfmDJJmj+YMkmWM6f+z79ShkfyTJMjV/kCRz9P/j
V74Al9xdpw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 19->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6crePLWEaztrSkUotIEn0B5oG+h
Iad+dHe+ni6biFh313EVse28397reRgb/WqT+7qu67quf95jcrXV7G+wmXku
v9d+frqu67qu67qumz90Xdd1Xdd1Xa+vD+bPD995f/reUs5H13Vd1/+xk8s7
/j5tCtkXSbJs5/6fkiQ5pfmDJJmj+YMkmWM6f+z79ShkfyTJMjV/kCRz9P/j
V74Al9xdpw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 20->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2U0KgkAYgOGvn4t0hg7QAdp1hKB156nTCa3aeYRMd2oYE+IMPQPygK/g
4MpPd+fr6bKJiHVzHFcR28b77b2eh77RrnpwXtd1Xdf133uMrrqY/XVWE9el
99Kfn67ruq7ruq7r5g9d13Vd13Vd18vrnfPNF9/d/9N9l38+uq7ruv6PnVze
/vtnlcm+SJJ5O/V9gyTJMc0fJMkUzR8kyRSH88e+XY9M9keSzFPzB0kyRf8/
5vIFZBRQiQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 21->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2U0KgkAYgOGvn4t0hg7QAdp1hKB156nTCa3aeYRMd2oYE+IMPQPygK/g
4MpPd+fr6bKJiHVzHFcR28b77b2eh77RrnpwXtd1Xdf133uMrrqY/XVWE9el
99Kfn67ruq7ruq7r5g9d13Vd13Vd18vrnfPNF9/d/9N9l38+uq7ruv6PnVze
/vtnlcm+SJJ5O/V9gyTJMc0fJMkUzR8kyRSH88e+XY9M9keSzFPzB0kyRf8/
5vIFZBRQiQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 22->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2U0KgkAYgOGvn4t0hg7QAdp1hKB156nTCa3aeYRMd2oYE+IMPQPygK/g
4MpPd+fr6bKJiHVzHFcR28b77b2eh77RrnpwXtd1Xdf133uMrrqY/XVWE9el
99Kfn67ruq7ruq7r5g9d13Vd13Vd18vrnfPNF9/d/9N9l38+uq7ruv6PnVze
/vtnlcm+SJJ5O/V9gyTJMc0fJMkUzR8kyRSH88e+XY9M9keSzFPzB0kyRf8/
5vIFZBRQiQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 23->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2U0KgkAYgOGvn4t0hg7QAdp1hKB156nTCa3aeYRMd2oYE+IMPQPygK/g
4MpPd+fr6bKJiHVzHFcR28b77b2eh77RrnpwXtd1Xdf133uMrrqY/XVWE9el
99Kfn67ruq7ruq7r5g9d13Vd13Vd18vrnfPNF9/d/9N9l38+uq7ruv6PnVze
/vtnlcm+SJJ5O/V9gyTJMc0fJMkUzR8kyRSH88e+XY9M9keSzFPzB0kyRf8/
5vIFZBRQiQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 24->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ+Em+KVvgvygb/g
xZFHD9f75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf133v0rnI1+2ssRq6b
uw/vb+nnp+u6ruu6ruu6+UPXdV3XdV3X9fX1xvT5YZr7D913+eej67qu6//Y
yeVtv38WmeyLJJm3Y983SJLs0/xBkkzR/EGSTLE7fxzr9cpkfyTJPDV/kCRT
9P9jLj+KCjZN
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 25->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ+Em+KVvgvygb/g
xZFHD9f75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf133v0rnI1+2ssRq6b
uw/vb+nnp+u6ruu6ruu6+UPXdV3XdV3X9fX1xvT5YZr7D913+eej67qu6//Y
yeVtv38WmeyLJJm3Y983SJLs0/xBkkzR/EGSTLE7fxzr9cpkfyTJPDV/kCRT
9P9jLj+KCjZN
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 26->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ+Em+KVvgvygb/g
xZFHD9f75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf133v0rnI1+2ssRq6b
uw/vb+nnp+u6ruu6ruu6+UPXdV3XdV3X9fX1xvT5YZr7D913+eej67qu6//Y
yeVtv38WmeyLJJm3Y983SJLs0/xBkkzR/EGSTLE7fxzr9cpkfyTJPDV/kCRT
9P9jLj+KCjZN
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 27->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ8M5eKVvgvygb/k
xZHHDtf75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf1+T16V7ma/TUWI9el
7sP7W/r56bqu67qu67pu/tB1Xdd1Xdd1fX29Md188dv9h353+eej67qu6//Y
yeVtv18WmeyLJJm3Y98vSJLs0/xBkpyi+YMkOcXu/HGs1yuT/ZEk89T8QZKc
ov8/UvkB+hEpLw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 28->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ8M5eKVvgvygb/k
xZHHDtf75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf1+T16V7ma/TUWI9el
7sP7W/r56bqu67qu67pu/tB1Xdd1Xdd1fX29Md188dv9h353+eej67qu6//Y
yeVtv18WmeyLJJm3Y98vSJLs0/xBkpyi+YMkOcXu/HGs1yuT/ZEk89T8QZKc
ov8/UvkB+hEpLw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 29->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ8M5eKVvgvygb/k
xZHHDtf75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf1+T16V7ma/TUWI9el
7sP7W/r56bqu67qu67pu/tB1Xdd1Xdd1fX29Md188dv9h353+eej67qu6//Y
yeVtv18WmeyLJJm3Y98vSJLs0/xBkpyi+YMkOcXu/HGs1yuT/ZEk89T8QZKc
ov8/UvkB+hEpLw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 30->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ8M5eKVvgvygb/k
xZHHDtf75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf1+T16V7ma/TUWI9el
7sP7W/r56bqu67qu67pu/tB1Xdd1Xdd1fX29Md188dv9h353+eej67qu6//Y
yeVtv18WmeyLJJm3Y98vSJLs0/xBkpyi+YMkOcXu/HGs1yuT/ZEk89T8QZKc
ov8/UvkB+hEpLw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 31->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ8M5eKVvgvygb/k
xZHHDtf75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf1+T16V7ma/TUWI9el
7sP7W/r56bqu67qu67pu/tB1Xdd1Xdd1fX29Md188dv9h353+eej67qu6//Y
yeVtv18WmeyLJJm3Y98vSJLs0/xBkpyi+YMkOcXu/HGs1yuT/ZEk89T8QZKc
ov8/UvkB+hEpLw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 32->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ8M5eKVvgvygb/k
xZHHDtf75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf1+T16V7ma/TUWI9el
7sP7W/r56bqu67qu67pu/tB1Xdd1Xdd1fX29Md188dv9h353+eej67qu6//Y
yeVtv18WmeyLJJm3Y98vSJLs0/xBkpyi+YMkOcXu/HGs1yuT/ZEk89T8QZKc
ov8/UvkB+hEpLw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 33->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UsKglAUgOHTYyOtoQW0gGYtIWjcemp1QqNmLiHTmQ8M5eKVvgvygb/k
xZHHDtf75baLiG11nDcR+8rn47vep7ZRr7JzXtd1Xdf1+T16V7ma/TUWI9el
7sP7W/r56bqu67qu67pu/tB1Xdd1Xdd1fX29Md188dv9h353+eej67qu6//Y
yeVtv18WmeyLJJm3Y98vSJLs0/xBkpyi+YMkOcXu/HGs1yuT/ZEk89T8QZKc
ov8/UvkB+hEpLw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 34->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UEKgkAUgOGXdZHO4AE6QLuOELTuPHU6oVU7j5DpbjSECXGEb0A+8Hcx
uJqnx+v9cttHRNVd513EofP5+K73KTX61Y7u67qu67r+f4/J1W5mf4PNzHNL
99/7W/v96bqu67qu67pu/tB1Xdd1Xdd1fXt90Pyh67qu63p6PiDXND0/NoXs
iyRZtnPfH0iSnNL8QZLM0fxBksxxPH/U/XoVsj+SZJmaP0iSOfr/sZQfDgUc
EQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 35->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UEKgkAUgOGXdZHO4AE6QLuOELTuPHU6oVU7j5DpbjSECXGEb0A+8Hcx
uJqnx+v9cttHRNVd513EofP5+K73KTX61Y7u67qu67r+f4/J1W5mf4PNzHNL
99/7W/v96bqu67qu67pu/tB1Xdd1Xdd1fXt90Pyh67qu63p6PiDXND0/NoXs
iyRZtnPfH0iSnNL8QZLM0fxBksxxPH/U/XoVsj+SZJmaP0iSOfr/sZQfDgUc
EQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 36->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UEKgkAUgOGXdZHO4AE6QLuOELTuPHU6oVU7j5DpbjSECXGEb0A+8Hcx
uJqnx+v9cttHRNVd513EofP5+K73KTX61Y7u67qu67r+f4/J1W5mf4PNzHNL
99/7W/v96bqu67qu67pu/tB1Xdd1Xdd1fXt90Pyh67qu63p6PiDXND0/NoXs
iyRZtnPfH0iSnNL8QZLM0fxBksxxPH/U/XoVsj+SZJmaP0iSOfr/sZQfDgUc
EQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 37->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2UEKgkAUgOGXdZHO4AE6QLuOELTuPHU6oVU7j5DpbjSECXGEb0A+8Hcx
uJqnx+v9cttHRNVd513EofP5+K73KTX61Y7u67qu67r+f4/J1W5mf4PNzHNL
99/7W/v96bqu67qu67pu/tB1Xdd1Xdd1fXt90Pyh67qu63p6PiDXND0/NoXs
iyRZtnPfH0iSnNL8QZLM0fxBksxxPH/U/XoVsj+SZJmaP0iSOfr/sZQfDgUc
EQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 38->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2bENgkAUgOGnuIgzOIAD0DmCibXz6HQkVnaMIGJ3kJCcnl7idwn5Ev6C
u44H2+P5cGoiYj1c7SpiM3i9PNd9nxrj6if3dV3XdV1/v8fs6v9mfy+7heeU
7uXOp+u6ruu6ruu6+eNb59N1Xdd1Xdd1/dPziflB13Vd1/X0/YD8pen7Y1fJ
vkiSdbv0/YEkyTnNHyTJHM0fJMkcp/PHbly3SvZHkqxT8wdJMkf/P0r5ANLl
HBE=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 39->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwkAQgNHxpxFrsAAL8GYJgmfr0eoCOXlLCcbsbRMJREI28gbkQb7L
mtOOHq73y20XEdv2c95E7Fufj8+8TrnRTdN7ruu6ruv67z0GpynmfP/+/ZLV
yDnn7t+eL/9+dF3XdV3XdX1NPQannPt10v6h67qu67qu62voSfd3Xdd1Xdfz
+wG5pPn9sSrkXCTJsh37/YEkySHtHyTJKdo/SJJT7O8fx27qQs5HkixT+wdJ
cor+/5jLN+QdHBE=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 40->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHPn0WcwQEcwM4RTKydR6cjsbJjBBG6A0NChLuE5xLyJLzN
QXUfHK73y20XEdvmOm8i9o3Px3e9T6nRrrp3X9d1Xdf1/D0GV13M/jz/Es9f
jbyHufuv+/nfj67ruq7ruq7/s8fgWs/5t9P8oeu6ruu6rq+jdzr/6rqu67qe
ng/InKbnx6qQfZEky3bs+wNJkkOaP0iSUzR/kCSn2J8/ju16FbI/kmSZmj9I
klP0/2MuP0GtHBE=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 41->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwkAQgNHxpxFrsAAL8GYJgmfr0eoCOXlLCcbsbRMJBEMW8wbkQb7L
Ijns6OF6v9x2EbFtP+dNxL71+fjM65Qb3TS957qu67qu/3+PwWmcTy+iJ6uR
92Du/u358t+Pruu6ruu6/tseg+P+t5aetH/ouq7ruq6vpSfd/3Rd13Vdz+8H
5JLm98eqkHORJMt27PcHkiSHtH+QJKdo/yBJTrG/fxy7qQs5H0myTO0fJMkp
+v9jLt865RwR
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 42->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6crePLWEazNLW0RCppUnkB5oK+H
UCjkq7vz9XTZRMS6u46riG3n/fZez0Nu9Ksd3Nd1Xdd1/f97jK42683k70rv
r/Tz0/Wae3L6/f1Nn7pf/vnouq7rul5fT5o/dH2JPWn+0HVd13V9OT3p/KLr
uq7ren4+IEuanx+bSvZFkqzbT98fSJIc0/xBkpyj+YMkOcfh/LHv16OS/ZEk
69T8QZKco/8/vuULYmEB1Q==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 43->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6crePLWEfwpXtpEoWgT5AmUB/p6
CDmkTV3tj7vDIiLm92s7i1hGbrSbl+fTY1wH6rqu67r+vz2So+31Jvu70vMr
vX66ruvv96/8/jlNz90vvz66ruu6nuqdzh+6ruvf3j+n6bn75ddH13Vd11O9
0/NT13Vd1/X++wFZ0v77Y1PJvEiSdfvp+wNJkimdP0iSY3T+IEmOcXj+WD/H
pZL5kSTr1PmDJDlG/3/8yhsCNfS4
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 44->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT946grX1IGmLELAJ7ROQB/Ie
WnJo/XR3vp4umxDCuvkcVyFsG++393oeYkO76t7+3Hpn9TFeU/Wx/fzno+u6
ri+zh8FVR338/Zb7/nKfn67ruj7P3ml+1HVdL+35O831+9ct5Xx0Xdf1efZO
84eu67rn7/d+/vPRdV3X9SV2Mr/x98eqkPsiSZbtr98fSJIc0vxBkkzR/EGS
TLE/f+zb9Sjk/kiSZWr+IEmm6P+Pf/kC8hfAQA==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 45->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+5SgjFxNTEIETOPeAbkwNxF
wkCCTzfH8+G0Siktm89+kdK68Xp5rvsuN7Wr7u3reqTeWb3M11R9aL/8+ei6
rn/3fs1XnfXh92Pp+yt9frqu67quz693mj91PeLzN831+9eNcj66ruu6rs+v
d5o/dN3zl++XPx9d13Vd/8dOljf//lgFuS+SZGw//f5AkuQ7zR8kyTGaP0iS
Y+zPH9t23YLcH0kypuYPkuQY/f/xKx/KrsBA
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 46->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp4ag1CxeZDn4A80Pdg
CSn009X+uDssUkrz9rOdpbRsPZ8e67rpm7p1G1zXdV2P0rPN0/6aqpeu198f
Xf/8+Sqf72z5+ah9f7X3T9d1Xdd1/d961nym1zlf03y/86Xruq7ruh6lZ80f
uvMVcf90Xdd1/Rc7Wd/++2MT5L5IkrF99/sDSZKvNH+QJMdo/iBJjnE4f6y7
dQlyfyTJmJo/SJJj9P/Ht7wDVIfAQA==
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 47->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp4SlsqBZton4A8kPdg
SD346eZ4PpxWIYRl/dovQljXXi+vdd+lhmY9Wvu6ruv6b/Ro9TZdU/W+/fz3
o3/y+el/fkPPP/f5ct+fruu6ruu6/l89ar4q9f6nef/53r+u67qu67o+bY+a
P9x/137++9F1Xdf1OXYyv+n3x6qQc5Eky3bo9weSJLs0f5Akx2j+IEmOsT1/
bJt1K+R8JMkyNX+QJMfo/49v+QTAy8BA
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 48->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0NgjAYgOH6s4gzOIADeHMEE8/Oo9ORePLmCCJ4KhIMiC36NCFPwpuY
Wi5+uNofd4dFCGFeXttZCMvS8+mxrpvYUK1b476u67r+H722eBqvb/W2++nP
59d71/m/9/za+9j7S31+uq7ruq7ruj6lXpvv/Df08z9zPu37S/38dF3XdV3X
dX1KvTbf+cP303Vd13U97mR6499/RSb7Iknmbdf7A5IkX2n+IEn20fxBkuxj
c/5YV+uSyf5Iknlq/iBJ9tH/H2N5B82EpgQ=
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 49->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp6aq1CapOIT0Ae6AsS
Py9+uNofd4dFCGFev7azEJa159PjXDddQ3Nuvee6ruu6nqK3Vk+7J1Ufep5/
PmnmP/z5x8536vvlnp+u67qu67qu/1JvLXf/Gvv+35nP8P1yf3+6ruu6ruu6
/k+9tdz9xXzePc8/H13XdV2P6WR+u7+/qkLuRZIs20/7O0mSr7R/kCRjtH+Q
JGPs7x/r5lwKuR9JskztHyTJGP3/MZV3udKmBA==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 50->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZi4SgxCPs5Tz4AcyAUZ
nxsfrvbH3WGRUpqXr+0spWXp+fQ4103TVJ1b67mu67qu/0KvLZ42z6d61/Mo
8+m+39DPP/X9cs9P13Vd13Vd17+p18bdj4a+/zjz6b5f7u9P13Vd13Vd1/X/
2Y9yz8f8Y89P13Vdn6aT+W3+fimC3IskGdt3+y9Jkq+0f5Ak+2j/IEn2sb1/
rKtzCXI/kmRM7R8kyT76/2Mq7wifpgQ=
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 51->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp6Si1Ka0zUJyAP9AVJ
Y1E+XGz3m90shDCtX+tJCPPa4+G2zqvY0KxL57qu67qu/0Jvre7G61O973op
59O/v7H3n3p/uc9P13Vd13Vd17+pt5Y7H419//ecT//+cn9+uq7ruq7ruq7/
z3yU+3z0tP2158Pzp+u6nuf7mcxp/PtdFbIvkmTZPpv/SJJ8pPmDJDlE8wdJ
cojd+WPZrFMh+yNJlqn5gyQ5RP9/pPIKkm6mBA==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 52->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZi4SgxCPs5Tz0A4kAsy
jkR5uNofd4dFSmleXttZSsvS8+mxrpumqVq31n1d13Vd/4VeWzxtrk/1rvtR
zqd7f0Pf/9T7y31+uq7ruq7ruv5NvTbufDT09cc5n+795f78dF3XdV3XdV3/
n/ko9/noeuRe6/nVdX2q7xcyp83fnyLIvkiSsX03v5Ak+UrzB0myj+YPkmQf
2/PHulqXIPsjScbU/EGS7KP/P6byDn68pgQ=
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 53->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp6Sg1Ca020T6A80Bck
Rij9cLU/7g6LEMK8vrazEJa159NjXTexoVm3zn1d13Vd/4feWj2N17d66n4p
55Pe39DvP/b+cp+fruu6ruu6rv9Sby13Phr6+Z85n/T+cv9+uq7ruq7ruq5P
Zz7KfT66ruuen/oUO5nf+PlXFbIvkmTZvnt/JknyleYPkmQfzR8kyT525491
sy6F7I8kWabmD5JkH/3/MZZ3zXqmBA==
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 54->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp4ai1Cak2qT0Ae6AuS
Ril+uNofd4dFCGFev7azEJa159NjXTdtQ7Nuneu6ruu6/gs9Wj1tr2/1vuul
nE///obe/9j7y31+uq7ruq7ruj6lHi13Phr6/p85n/795f78dF3XdV3XdV3/
n/ko9/nouq5PtUc93/Uh3x8yp+3nS1XIvkiSZfvu9ylJkq80f5AkUzR/kCRT
7M4f62ZdCtkfSbJMzR8kyRT9/zGWd8OhpgQ=
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 55->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0NgjAYgOH6s4gzOIADeHMEE8/Oo9ORePLmCCJ4AhoNiK34NCFPwnuw
1hD94mp/3B0WIYR5eW1nISxLz6fHum6ahmrdWvd1Xdd1fQq9tnjaXN/qsfu5
nE98f595//E+dH+pz0/XdV3XdV3Xf6nX5jsfjf36751PfH+pPz9d13Vd13Vd
1/9nPkp9Prqu63p3r/X9MdVOprf5/BeZ7Iskmbevfj+SJNml+YMk2UfzB0my
j+35Y12tSyb7I0nmqfmDJNlH/3+M5R01oYvI
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 56->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0NgjAYgOH6s4gzOIADeHMEE8/Oo9ORePLmCCJ4AhoNiK34NCFPwnuw
1hD94mp/3B0WIYR5eW1nISxLz6fHum6ahmrdWvd1Xdd1fQq9tnjaXN/qsfu5
nE98f595//E+dH+pz0/XdV3XdV3Xf6nX5jsfjf36751PfH+pPz9d13Vd13Vd
1/9nPkp9Prqu63p3r/X9MdVOprf5/BeZ7Iskmbevfj+SJNml+YMk2UfzB0my
j+35Y12tSyb7I0nmqfmDJNlH/3+M5R01oYvI
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 57->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0NgjAYgOH6s4gzOIADeHMEE8/Oo9ORePLmCCJ4AhoNiK34NCFPwnuw
1hD94mp/3B0WIYR5eW1nISxLz6fHum6ahmrdWvd1Xdd1fQq9tnjaXN/qsfu5
nE98f595//E+dH+pz0/XdV3XdV3Xf6nX5jsfjf36751PfH+pPz9d13Vd13Vd
1/9nPkp9Prqu63p3r/X9MdVOprf5/BeZ7Iskmbevfj+SJNml+YMk2UfzB0my
j+35Y12tSyb7I0nmqfmDJNlH/3+M5R01oYvI
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 58->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0NgjAYgOH6s4gzOIADeHMEE8/Oo9ORePLmCCJ4AhoNiK34NCFPwnuw
1hD94mp/3B0WIYR5eW1nISxLz6fHum6ahmrdWvd1Xdd1fQq9tnjaXN/qsfu5
nE98f595//E+dH+pz0/XdV3XdV3Xf6nX5jsfjf36751PfH+pPz9d13Vd13Vd
1/9nPkp9Prqu63p3r/X9MdVOprf5/BeZ7Iskmbevfj+SJNml+YMk2UfzB0my
j+35Y12tSyb7I0nmqfmDJNlH/3+M5R01oYvI
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 59->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0NgjAYgOH6s4gzOIADeHMEE8/Oo9ORePLmCCJ4AhoNiK34NCFPwnuw
1hD94mp/3B0WIYR5eW1nISxLz6fHum6ahmrdWvd1Xdd1fQq9tnjaXN/qsfu5
nE98f595//E+dH+pz0/XdV3XdV3Xf6nX5jsfjf36751PfH+pPz9d13Vd13Vd
1/9nPkp9Prqu63p3r/X9MdVOprf5/BeZ7Iskmbevfj+SJNml+YMk2UfzB0my
j+35Y12tSyb7I0nmqfmDJNlH/3+M5R01oYvI
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 60->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0NgjAYgOH6s4gzOIADeHMEE8/Oo9ORePLmCCJ4AhoNiK34NCFPwnuw
1hD94mp/3B0WIYR5eW1nISxLz6fHum6ahmrdWvd1Xdd1fQq9tnjaXN/qsfu5
nE98f595//E+dH+pz0/XdV3XdV3Xf6nX5jsfjf36751PfH+pPz9d13Vd13Vd
1/9nPkp9Prqu63p3r/X9MdVOprf5/BeZ7Iskmbevfj+SJNml+YMk2UfzB0my
j+35Y12tSyb7I0nmqfmDJNlH/3+M5R01oYvI
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 61->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0NgjAYgOH6s4gzOIADeHMEE8/Oo9ORePLmCCJ4AhoNiK34NCFPwnuw
1hD94mp/3B0WIYR5eW1nISxLz6fHum6ahmrdWvd1Xdd1fQq9tnjaXN/qsfu5
nE98f595//E+dH+pz0/XdV3XdV3Xf6nX5jsfjf36751PfH+pPz9d13Vd13Vd
1/9nPkp9Prqu63p3r/X9MdVOprf5/BeZ7Iskmbevfj+SJNml+YMk2UfzB0my
j+35Y12tSyb7I0nmqfmDJNlH/3+M5R01oYvI
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 62->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZhxlQ9CUPMcz0A4kLsZ
RyR5uNofd4dFSmleX9tZSsva8+mxrpu2qVm3zn1d13VdL6Fnq6ft9a0+dD/K
+Qzv7z2fv9zz03Vd13Vd1/Vf6tm47/fR9zf196fruq7ruq7r+v/MR1Ofj67r
ut7fs54fpXZyetu//yrIvkiSsX31/kiSZJ/mD5LkGM0fJMkxduePdbMuQfZH
koyp+YMkOUb/f3zKO1uXcYw=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 63->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZhxlQ9CUPMcz0A4kLsZ
RyR5uNofd4dFSmleX9tZSsva8+mxrpu2qVm3zn1d13VdL6Fnq6ft9a0+dD/K
+Qzv7z2fv9zz03Vd13Vd1/Vf6tm47/fR9zf196fruq7ruq7r+v/MR1Ofj67r
ut7fs54fpXZyetu//yrIvkiSsX31/kiSZJ/mD5LkGM0fJMkxduePdbMuQfZH
koyp+YMkOUb/f3zKO1uXcYw=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 64->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZhxlQ9CUPMcz0A4kLsZ
RyR5uNofd4dFSmleX9tZSsva8+mxrpu2qVm3zn1d13VdL6Fnq6ft9a0+dD/K
+Qzv7z2fv9zz03Vd13Vd1/Vf6tm47/fR9zf196fruq7ruq7r+v/MR1Ofj67r
ut7fs54fpXZyetu//yrIvkiSsX31/kiSZJ/mD5LkGM0fJMkxduePdbMuQfZH
koyp+YMkOUb/f3zKO1uXcYw=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 65->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZhxlRiEwZhnPAPhQO5m
HJHk4Wp/3B0WKaV5fW1nKS1rz6fHum7apmbdOvd1Xdd1fQo9Wz1tr2/1vvtR
zqd/f5/5/NM9P13XdV3XdV3/pZ6N+34ffX9jf3+6ruu6ruu6rv/PfDT2+ei6
ruvD9KznT9ROjm/791sF2RdJMrbv3v9Iknyl+YMkWaL5gyRZYnf+WDfrEmR/
JMmYmj9IkiX6/2Mo774HcYw=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 66->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZhxlRiFQc0znoFwIHcz
jkjycLHdb3azlNK0vtaTlOa1x8NtnVdtU7Munfu6ruu6Poaere6217d63/0o
59O/v/d8/vGen67ruq7ruq7/Us/Gfb+Pvr+hvz9d13Vd13Vd1/9nPhr6fHRd
1/Vx9qzn3/PzIYe0/fupguyLJBnbV+9fJEk+0vxBkizR/EGSLLE7fyybdQqy
P5JkTM0fJMkS/f/xKa+C9nGM
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 67->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0JwkAYgOHzZxFncAAHsHMEwdp5dLqAlZ0jGHNWCWkO433G5yA8kLc5
TyH5cHM8H06rlNKyvfaLlNat18tr3Xd9U7ceg/u6ruu6Poeebd7217f62P0o
5zO+v898/vmen67ruq7ruq7/Us/Gfb+Pvr/a35+u67qu67qu6/8zH9U+H13X
dV2P2LNTP5/JmvZ/n02QfZEkY+v9hiRZovmDJFmi+YMkWeJw/th26xZkfyTJ
mJo/SJIl+v9jKp8A+ou4
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 68->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHzZxFncAAHsHMEE2vn0elIrOwcQQSrQ2JC1PuE5xLyJLzN
eTR8uNofd4dFSmleX9tZSsva8+mxrpvc1Kxb576u67quj6G3Vk/z9avedz/K
+fTv7zO/f7znp+u6ruu6ruv/1Fvjvt9H31/p56fruq7ruq7r+nTmo9Lno+u6
rutT7GR58/fHKsi+SJKxfff9gSTJV5o/SJJDNH+QJIfYnT/WzboE2R9JMqbm
D5LkEP3/8S3vkPOzEg==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 69->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHzZxFncAAHsHMEE2vn0elIrOwcQQSrQ2JC1PuE5xLyJLzN
eTR8uNofd4dFSmleX9tZSsva8+mxrpvc1Kxb576u67quj6G3Vk/z9avedz/K
+fTv7zO/f7znp+u6ruu6ruv/1Fvjvt9H31/p56fruq7ruq7r+nTmo9Lno+u6
rutT7GR58/fHKsi+SJKxfff9gSTJV5o/SJJDNH+QJIfYnT/WzboE2R9JMqbm
D5LkEP3/8S3vkPOzEg==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 70->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHzZxFncAAHsHMEE2vn0elIrOwcQQSrQ2JC1PuE5xLyJLzN
eTR8uNofd4dFSmleX9tZSsva8+mxrpvc1Kxb576u67quj6G3Vk/z9avedz/K
+fTv7zO/f7znp+u6ruu6ruv/1Fvjvt9H31/p56fruq7ruq7r+nTmo9Lno+u6
rutT7GR58/fHKsi+SJKxfff9gSTJV5o/SJJDNH+QJIfYnT/WzboE2R9JMqbm
D5LkEP3/8S3vkPOzEg==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 71->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHzZxFncAAHsHMEE2vn0elIrOwcQQSrQ2JC1PuE5xLyJLzN
eTR8uNofd4dFSmleX9tZSsva8+mxrpvc1Kxb576u67quj6G3Vk/z9avedz/K
+fTv7zO/f7znp+u6ruu6ruv/1Fvjvt9H31/p56fruq7ruq7r+nTmo9Lno+u6
rutT7GR58/fHKsi+SJKxfff9gSTJV5o/SJJDNH+QJIfYnT/WzboE2R9JMqbm
D5LkEP3/8S3vkPOzEg==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 72->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHzZxFncAAHsHMEE2vn0elIrOwcQeSsDokJUfm8PJeQJ+Ft
Dmj4YLU/7g6LlNK8PbazlJat59NjXTelqVu33nld13Vdr6Fnm6fl+lUfOh/l
/gzv7zPXX+/903Vd13Vd1/V/6tm47/fR9zf189N1Xdd1Xdd1PU7Pml90Xdd1
vaZOTm/5/tcE2RdJMrbvvh+QJPlK8wdJcozmD5LkGPvzx7pblyD7I0nG1PxB
khyj/x/f8g7zY7MS
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 73->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHzZxFncAAHsHMEE2vn0elIrOwcQeS0AYnJBeWTPJeQJ+Ft
jqPhC6v9cXdYpJTm9bWdpbSsPZ8e67ppm5p169zXdV3X9Sn0bPW0vX7V++5H
OZ/+/Q3z/NM9P13XdV3XdV3/p56N+30ffX9jvz9d13Vd13Vd1/VXz5qfdF3X
dX3ITo5v+/urCrIvkmRsP83vJEm+0/xBkizR/EGSLLE7f6ybdQmyP5JkTM0f
JMkS/f/4lne4UrMS
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 74->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0JwkAYgOHzZxFncAAHsHMEwdp5dLqAlZ0jGHNWF4MQ1Hwez0F4IG9z
uTT5yGp/3B0WKaV5e21nKS1bz6fHum5KU7duvfu6ruu6XkPPNk/L9as+dD/K
+Qzv7zPPX+/56bqu67qu6/o/9Wzc7/vo+5v6/em6ruu6ruu6rtfSs+Y/Xdd1
PVYnp7f8fmmC7IskGdt38y9Jkq80f5Akx2j+IEmOsT9/rLt1CbI/kmRMzR8k
yTH6//Et79+xsxI=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 75->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b0NgkAYgOHzZxFncAAHsHMEE2vn0elIrOwcQeSsDokJUfm8PJeQJ+Ft
DijgC6v9cXdYpJTm7bGdpbRsPZ8e67opTd269c7ruq7reg092zwt16/60Pko
92d4f5+5/nrvn67ruq7ruq7/U8/G/b6Pvr+pn5+u67qu67qu67peR8+af3Vd
16N1cnrL93cTZF8kydi+m/9Iknyl+YMkOUbzB0lyjP35Y92tS5D9kSRjav4g
SY7R/49veQdpj7MS
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 76->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6crePLmCNbWU6oIoa0hPAF5IO8l
5tD64eZ4PpxWEbFsP/tFxLr1enmt+y41uvUY7Ou6rut6Db23eZuuufq3/VLu
Z7rzjXN/9d6/ruu6ruu6rs/Ze+v9fV7799N1Xdd1Xdd1Xdd13fyv6/rUzxfy
n6bvn6aQc5Eky/bX/EKS5CfNHyTJHM0fJMkch/PHtlu3Qs5HkixT8wdJMkf/
f0zlExrMsxI=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 77->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2U0KgkAYgOGvn4t0hg7QAdx1hKB156nTCa3aeYRMW42FMVQO8gzIA74b
nQFxdHM47Y+riFi2R7WIWLdezo9x26VGN5rBeV3XdV2fQ++tn6bjX/3d+enn
5zvzW+79fbY+1l/XdV3XdV3XvV+bH13XdV3XdV3XdV3X9bHe6/uHPs9OTm/6
/KsLuS6SZNmOvT+TJPlK+w+SZI72HyTJHIf7j203roVcH0myTO0/SJI5+v/x
K++ZhbMS
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 78->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT946grXtKa0KgTaRPoHyQN5L
/VBo6u58PV02IYR1cx1XIWwb77f3eh5iQ7vqwb6u67qu63Vv1Ruvufqn/fzz
mWf+S//8vn+6ruu6ruv6Mnqn51/zH9vPPx9d13Vd13Vd13Vd1/V/753e/3yf
D5nT+PdTFXJfJMmy/fX8RZLkmM4fJMkUnT9IkikOzx/7dj0KuT+SZJk6f5Ak
U/T/x1S+AHUysxI=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 79->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6cr9OTNEayNp1RRCrFBn0B5IO8l
lBSadrU/7g6LiJh313YWsew8n+7jssmNflwH87qu67qul+/J5mE+vtVfzddy
f+pdn162Jz0fuq7ruq7r/9KT3v/0afpn+8P+03Vd13Vd13Vd13Vd/9VOTm/+
/bCpZF0kybp99/+JJMlnOn+QJMfo/EGSHOPw/LHuR1vJ+kiSder8QZIco/8f
pbwBKpP0mA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 80->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2U0KgkAYgOHp5yKdoQN0gHYdIWjdeep0gqt2HSFzWmkiDKif8AzIA74I
g6I4erjeL7ddSmnbbOdNSvvG5+M7XqeuqR3v3n5d13Vd16fv2epnd8zVh/aP
Hz/P+Rme39LXT9cj92zc58vS50fXdV3X9Xg96/1F19fYs+5fXdd1Xdd1Xdd1
XdfX28nl7X7/qoLMiyQZ27H/JyRJ/tP6gyRZovUHSbLE/vrj2I46yPxIkjG1
/iBJluj/x1R+ACpR53o=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 81->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOHPn0WcwQEcwJsjCJ6dR6crePLmCP5UL21DodAkwhMoD/Sl
EFJoSbs5ng+nVUQsX8d+EbGO1Hjsfl4v73Hvqeu6ruv6fL21+doduXrq/Pj1
edYnPb/S90/Xdf1fn++l10fXdV3Xh3qr96eu67rnp67ruq7ruq7ruq7n72R5
u99fmkrmRZKs27Hv9yRJDmn/QZKcov0HSXKK/f3H9jNulcyPJFmn9h8kySn6
/zGXT8oW2mw=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 82->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp4ai2FQpvP8gTKA30R
QgoNqbvz9XTZpJTW9XVcpbStvd8+43lom5rx6txfWs9WX9tjrt53v/z66Lqu
62V6Nu7+NPT7edanf36ln5+u6/q/9mzc/af0+ui6rutletb+pOu6vrSe9X7X
dV3XdV3XdV3XY3eyvO3vG1WQeZEkYzv0fZwkyV86f5Akx+j8QZIcY/f8sW/G
I8j8SJIxdf4gSY7R/x9T+QZD6qX0
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 83->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4SluKEZsgL1Ae9EMI
KTSkbo7nw2kVQli2134Rwrr1enmN+y41dOPRu6/P26PN23TM1cful18fXdf1
f+3Ret//U7+fZ33G51f6+em6ruvDPVrv/lZ6fXRd1/XhHrV/6Lqu65/1qP1D
13Vd13Vd13Vd/66T5U2/PzSVzIskWbdT369JkhzS+YMkmaPzB0kyx/75Y9uN
WyXzI0nWqfMHSTJH/3/8yidhcKX0
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 84->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alOKEZsgLyAP8iGE
FAypm+P5cFqFEJbtZ78IYd16vbzGfdc3dOMxmNf/q0ebt/0xVx+bL78/uq7r
fp9T89Pfn2d/xtdX+vnpuq7r6R6t93wrvT+6rut6ukedH7qu6/pnPer80HVd
13Vd13Vd17/rZHn77x+aStZFkqzbqffXJEmmdP8gSebo/kGSzHF4/9h241bJ
+kiSder+QZLM0f8fv/IJ9Ril9A==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 85->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alOKEZsgLyAP8iGE
FAypm+P5cFqFEJbtZ78IYd16vbzGfdc3dOMxmNf/q0ebt/0xVx+bL78/uq7r
fp9T89Pfn2d/xtdX+vnpuq7r6R6t93wrvT+6rut6ukedH7qu6/pnPer80HVd
13Vd13Vd17/rZHn77x+aStZFkqzbqffXJEmmdP8gSebo/kGSzHF4/9h241bJ
+kiSder+QZLM0f8fv/IJ9Ril9A==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 86->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alPEVE2QF5AH+UBC
CobU1f64OyxCCPP2s52FsGw9nx7juukbunEbzOv/1aPN0/74VR+bL78/uq7r
fp9T89O//zP7M76+0s9P13VdT/dovedb6f3RdV3X0z3q/NB1Xdff61Hnh67r
uq7ruq7ruj6tk+Xtv39oKlkXSbJuX72/JkkypfsHSTJH9w+SZI7D+8e6G5dK
1keSrFP3D5Jkjv7/+JZ3wBiY1g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 87->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alPEVE2QF5AH+UBC
CobU1f64OyxCCPP2s52FsGw9nx7juukbunEbzOv/1aPN0/74VR+bL78/uq7r
fp9T89O//zP7M76+0s9P13VdT/dovedb6f3RdV3X0z3q/NB1Xdff61Hnh67r
uq7ruq7ruj6tk+Xtv39oKlkXSbJuX72/JkkypfsHSTJH9w+SZI7D+8e6G5dK
1keSrFP3D5Jkjv7/+JZ3wBiY1g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 88->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alPEVE2QF5AH+UBC
CobU1f64OyxCCPP2s52FsGw9nx7juukbunEbzOv/1aPN0/74VR+bL78/uq7r
fp9T89O//zP7M76+0s9P13VdT/dovedb6f3RdV3X0z3q/NB1Xdff61Hnh67r
uq7ruq7ruj6tk+Xtv39oKlkXSbJuX72/JkkypfsHSTJH9w+SZI7D+8e6G5dK
1keSrFP3D5Jkjv7/+JZ3wBiY1g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 89->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alPEVE2QF5AH+UBC
CobU1f64OyxCCPP2s52FsGw9nx7juukbunEbzOv/1aPN0/74VR+bL78/uq7r
fp9T89O//zP7M76+0s9P13VdT/dovedb6f3RdV3X0z3q/NB1Xdff61Hnh67r
uq7ruq7ruj6tk+Xtv39oKlkXSbJuX72/JkkypfsHSTJH9w+SZI7D+8e6G5dK
1keSrFP3D5Jkjv7/+JZ3wBiY1g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 90->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alPEVE2QF5AH+UBC
CobU1f64OyxCCPP2s52FsGw9nx7juukbunEbzOv/1aPN0/74VR+bL78/uq7r
fp9T89O//zP7M76+0s9P13VdT/dovedb6f3RdV3X0z3q/NB1Xdff61Hnh67r
uq7ruq7ruj6tk+Xtv39oKlkXSbJuX72/JkkypfsHSTJH9w+SZI7D+8e6G5dK
1keSrFP3D5Jkjv7/+JZ3wBiY1g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 91->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alPEVE2QF5AH+UBC
CobU1f64OyxCCPP2s52FsGw9nx7juukbunEbzOv/1aPN0/74VR+bL78/uq7r
fp9T89O//zP7M76+0s9P13VdT/dovedb6f3RdV3X0z3q/NB1Xdff61Hnh67r
uq7ruq7ruj6tk+Xtv39oKlkXSbJuX72/JkkypfsHSTJH9w+SZI7D+8e6G5dK
1keSrFP3D5Jkjv7/+JZ3wBiY1g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 92->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4SlOEqk3QF5AH+UBC
CobU1f64OyxCCPP2s52FsGw9nx7jukkN3bj15vXf6tHmaTqm6kPz5fdH13Xd
73Nu/v3v/8z+DK+v9PPTdV3X8z1a7/lWen90Xdf1fI86P3Rd1/Vpe9T5o+u6
ruu6ruu6/u+dLG/6/qCpZF0kybp99f6ZJMmc7h8kyTG6f5Akx9i/f6y7calk
fSTJOnX/IEmO0f8f3/IOIpeY1g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 93->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HSFnrw5grXx1KYogZqgL1Ae5DsY
IhhSN8fz4bQKISy7Z78IYd15vTzHbTc09OM+mtd/q0ebl8PxrT41X35/dF3X
/T6n5uf//M/2Z3p9pb8/Xdd1Pd2j9Z5vpfdH13VdT/eo80PXdV3/rx51/um6
ruu6ruu6rpfuZHmH9/emknWRJOv23ftfkiRTun+QJHN0/yBJ5ji+f2z70Vay
PpJknbp/kCRz9P/HXD4AVlWLuA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 94->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alOUQE0qL1Ae5DsY
IhhSN8fz4bQKISzbZ78IYd16vbzGfdc3dOMxmNf/q0ebt/3xqz42X35/dF3X
/T6n5qf//O/2Z3x9pb8/Xdd1Pd2j9Z5vpfdH13VdT/eo80PXdV3X59Sjzm9d
13Vd13Vd1+ffyfL2779NJesiSdbtp/enJEmmdP8gSebo/kGSzHF4/9h241bJ
+kiSder+QZLM0f8fU/kEfbSLuA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 95->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp4alOUQE0sLyAP8h0a
UrCNbo7nw2kVQli2n/0ihHXr9fIa913f0I3HYF6fV482b/vjV31svvz+6Lqu
+35OzU9//e/2Z3x9pe+fruu6nu7Rep9vpfdH13VdT/eo54eu67qu6//To95f
dF3XdV3XdX0OnSxv//zXVLIukmTdfvr9kCTJlM4fJMkcnT9IkjkOzx/bbtwq
WR9Jsk6dP0iSOfr/YyqfB5KLuA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 96->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HSFnrw5grXx1KYogZqgLyAP8h0a
UrCNbo7nw2kVQlh2n/0ihHXn9fIct93Q0I/7aF7/rR5tXg7Ht/rUfPn90XVd
9/2cmp//+p/tz/T6St8/Xdd1Pd2j9T7fSu+Pruu6nu5Rzw9d13Vd1/V/6VHv
f7qu67qu63odnSzv8PzSVLIukmTdvvv9iyTJlM4fJMkcnT9IkjmOzx/bfrSV
rI8kWafOHyTJHP3/MZcP89GLuA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 97->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAAgNH4s4gzOIADeHMEwbPz6HQFT94cwdp6kNSiBNKE8gLlQb9D
Q4TatJvj+XBahRCW7bFfhLBuvV5e476LDd14DM7r+mfvbd7GY6o+dr78+ui6
rs/1/pr7+v+tz/j8Sv9+uq7rep7eW+//Y+n10XVdn2vvdf/XdV3XdV3Xdc/P
uq7ruq7r03eyvPHzd1PJvEiSdfvr/Q1Jkt+0/yBJpmj/QZJMcbj/2HbjVsn8
SJJ1av9BkkzR949cPgGlDou4
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 98->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZhxlRiUQDLPcAbkQO7C
YYSYp5vj+XBapZSW9Wu/SGlde7281n3XNjXr0bmu65F6tnrbXlP1vuvlz0fX
9f/t2bj3t7Hf/7fz6d9f6c9P13Vdn2fPxv1+Ln0+uq7r7r8xz0/XdV3XdV3X
59Sz5gNd13Vd16d+/iBL2n4+rYLsiyQZ22+/b5Ak+UnzB0lyiOYPkuQQu/PH
tlm3IPsjScbU/EGSHKL/P8byCYeDi7g=
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 99->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2csJwkAUQNHx04g1WIAFuLMEwbX1aHUBV+4swZhxlRiUkDgPcgbkQO7C
YQIhTzfH8+G0Sikt689+kdK69np5rfuubWrWo3Nd1/XxerZ6217/6n3Xy5+P
rs+5Z+M+H6b+/t/Op39/pe+fruu6rkfs2bjvF6XPR9f1uD3r+aXruq7ruq7r
uvmj9Pnouq7r+hw7Wd72+2MVZF8kydh++/2BJMlPmj9IkkM0f5Akh9idP7bN
ugXZH0kypuYPkuQQ/f8xlU9p+Iu4
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 100->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp4ahUlVPNBn0B5oO8l
qIV8dbU/7g6LlNK8vbazlJat59NjXTd9U7dug/u6rutj9WzztL/+1d/dr//5
6NPu3/1+6z0f0fdX+/vTdV3XdT1ezzq/6PoUe9bzr+u6ruu6ruu6+UHXdV3X
9dLzAVnT/vmxCbIvkmRsP71/IEnyleYPkmSJ5g+SZInD+WPdrUuQ/ZEkY2r+
IEmW6P+PX3kH8sJ+mg==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}], 101->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2c0JwjAYgOH4s4gzOIADeHMEwbPz6HQFT94cwdp4ShWl0OYrPIHyQN9L
6A8k7eZ4PpxWKaVle+wXKa1br5fXuO9KUzcevfO6ruv6fz3bvC3HVP3b+frX
R5/38xN9frXvn67ruq7r+tQ9a32m6xF71vup67qu67qu63PoWet3Xdd1XdfL
9QFZ03L92ASZF0kytr++P5Ak+Un7D5LkEO0/SJJD7O8/tt24BZkfSTKm9h8k
ySH6/zGWT2jufpo=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, 
                   "DefaultGraphicsInteraction" -> {
                    "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                    "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                   "DefaultPlotStyle" -> Automatic}]}, 
                Dynamic[$CellContext`i11$$],
                Alignment->Automatic,
                BaseStyle->"ListAnimateCore",
                ImageSize->All,
                TransitionDirection->Horizontal,
                TransitionDuration->0.5,
                TransitionEffect->Automatic],
               Identity,
               Editable->True,
               Selectable->True],
              ImageMargins->10],
             Deployed->False,
             StripOnInput->False,
             ScriptLevel->0,
             GraphicsBoxOptions->{PreserveImageOptions->True},
             Graphics3DBoxOptions->{PreserveImageOptions->True}],
            Identity,
            Editable->False,
            Selectable->False],
           Alignment->{Left, Center},
           Background->GrayLevel[1],
           Frame->1,
           FrameStyle->GrayLevel[0, 0.2],
           ItemSize->Automatic,
           StripOnInput->False]}
        },
        AutoDelete->False,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Top}}},
        GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.7], {
             Offset[0.5599999999999999]}, 
            Offset[0.7]}, "Rows" -> {
            Offset[0.4], {
             Offset[0.8]}, 
            Offset[0.4]}}], If[
        And[
         CurrentValue["NotebookSelected"], 
         CurrentValue["SelectionOver"]], 
        Manipulate`Dump`ReadControllerState[
         Map[Manipulate`Dump`updateOneVar[#, 
           CurrentValue["PreviousFormatTime"], 
           CurrentValue["CurrentFormatTime"]]& , {
           
           Manipulate`Dump`controllerLink[{$CellContext`i11$$, \
$CellContext`i11$22196$$}, "X1", 
            If["DefaultAbsolute", True, "JB1"], False, {1, 101, 1}, 101, 
            1.]}], 
         CurrentValue[{
          "ControllerData", {
           "Gamepad", "Joystick", "Multi-Axis Controller"}}], {}]],
       ImageSizeCache->{491., {88.25, 96.25}}],
      DefaultBaseStyle->{},
      FrameMargins->{{5, 5}, {5, 5}}],
     BaselinePosition->Automatic,
     ImageMargins->0],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "ListAnimate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.75105214075482*^9, 3.771176420858123*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"af8cd4db-183a-4b14-a417-8538e6a85cc5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1024, 700},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 242, 4, 125, "Title",ExpressionUUID->"96147a4d-7515-4828-be64-976d91bea8e8"],
Cell[CellGroupData[{
Cell[847, 30, 166, 3, 89, "Chapter",ExpressionUUID->"6fca091b-9b9a-406e-a508-43cb7455b9fa"],
Cell[1016, 35, 6381, 134, 908, "Text",ExpressionUUID->"4b1e53e0-cadb-4068-a1b0-2ada61edd588"],
Cell[7400, 171, 210, 4, 45, "Text",ExpressionUUID->"bc79c9d6-9b1d-4c13-b73c-c855212371b9"],
Cell[7613, 177, 2613, 65, 437, "Input",ExpressionUUID->"06561019-91e5-4895-98ec-ea625464ae94",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10263, 247, 179, 2, 89, "Chapter",ExpressionUUID->"34a485e1-db54-494d-bd09-bd8e00ac5eae"],
Cell[CellGroupData[{
Cell[10467, 253, 156, 3, 85, "Section",ExpressionUUID->"e8573741-344c-41ec-98bf-aeb18d62369a"],
Cell[10626, 258, 738, 18, 105, "Text",ExpressionUUID->"8fe7bb2e-b8a4-42e3-9fa4-4a94ea0f459a"],
Cell[11367, 278, 612, 13, 59, "Input",ExpressionUUID->"29371a8c-7808-401c-8a44-7fa1feab8cfb",
 InitializationCell->True],
Cell[11982, 293, 325, 7, 45, "Text",ExpressionUUID->"b89e8d06-e6e1-4670-9e35-cd61f5ecabec"],
Cell[12310, 302, 429, 10, 59, "Input",ExpressionUUID->"a1a47536-9a1c-4457-b7ab-597eb0c6c9c7",
 InitializationCell->True],
Cell[12742, 314, 1591, 44, 105, "Text",ExpressionUUID->"0121c219-e4e1-41b9-a68f-bf0115741663"],
Cell[14336, 360, 2103, 54, 262, "Input",ExpressionUUID->"571c3f2c-de0e-4e1b-8c09-ca43eeae9abc",
 InitializationCell->True],
Cell[16442, 416, 328, 8, 59, "Input",ExpressionUUID->"e26c2684-30e8-4eb8-b904-115724ea3ad9",
 InitializationCell->True],
Cell[16773, 426, 2053, 54, 105, "Text",ExpressionUUID->"d74bbd24-d0f1-42bd-bb3a-675cd6db6fe4"],
Cell[18829, 482, 1384, 37, 182, "Input",ExpressionUUID->"841bd5b4-19a2-4ebf-9fdf-b991f32c62c0",
 InitializationCell->True],
Cell[20216, 521, 381, 9, 59, "Input",ExpressionUUID->"74d04a73-a54a-4b31-8fb9-e91ce118eb78",
 InitializationCell->True],
Cell[20600, 532, 5135, 151, 263, "Text",ExpressionUUID->"04974618-db90-4061-908a-01d776eee45d"],
Cell[25738, 685, 9645, 244, 1188, "Input",ExpressionUUID->"b7869e27-90a2-4a54-92e6-482fc99ea5ce",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[35420, 934, 150, 3, 66, "Section",ExpressionUUID->"a8b112f3-2448-4781-88eb-341c7082f57f"],
Cell[35573, 939, 3175, 81, 164, "Text",ExpressionUUID->"ac33a864-65c0-4f37-b150-38ae66143e2f"]
}, Closed]],
Cell[CellGroupData[{
Cell[38785, 1025, 206, 4, 66, "Section",ExpressionUUID->"b0d0f650-268d-4607-8117-169c38e036ce"],
Cell[38994, 1031, 545, 8, 45, "Text",ExpressionUUID->"63d0b6a7-1d72-4561-8aee-350d800681da"],
Cell[39542, 1041, 8382, 261, 669, "Input",ExpressionUUID->"66ef6297-4ac6-4ef5-819e-ec40d1288576",
 InitializationCell->True],
Cell[47927, 1304, 301, 5, 45, "Text",ExpressionUUID->"9f7925ca-5235-4f99-b779-fd5f8b16794b"],
Cell[48231, 1311, 2959, 83, 205, "Input",ExpressionUUID->"8df18c66-b716-420e-b945-a5db70389fb8",
 InitializationCell->True],
Cell[51193, 1396, 968, 16, 75, "Text",ExpressionUUID->"4ec388ea-1684-4fb1-bde0-166c3d766324"],
Cell[CellGroupData[{
Cell[52186, 1416, 540, 13, 39, "Input",ExpressionUUID->"657c5e0a-a3a4-457a-88a1-52b23694d15f"],
Cell[52729, 1431, 834, 14, 44, "Output",ExpressionUUID->"4c7f16d7-1e6a-4748-adc3-521923ca3826"]
}, Open  ]],
Cell[53578, 1448, 13752, 415, 809, "Input",ExpressionUUID->"b64af6ad-5580-4c4a-8833-42682b32afa8",
 InitializationCell->True],
Cell[67333, 1865, 417, 9, 75, "Text",ExpressionUUID->"86d18cb1-de72-4495-ba5d-675fa7c601e7"],
Cell[CellGroupData[{
Cell[67775, 1878, 460, 12, 39, "Input",ExpressionUUID->"38fa66e0-66e7-492a-b4e0-40048fa82e3f"],
Cell[68238, 1892, 769, 13, 44, "Output",ExpressionUUID->"c5df0ecc-02df-462e-b671-46742a4134f7"]
}, Open  ]],
Cell[69022, 1908, 6383, 198, 408, "Input",ExpressionUUID->"048bab5f-774c-4caa-96dd-24eff9fbbb55",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75454, 2112, 156, 3, 89, "Chapter",ExpressionUUID->"9dc19ae6-ecbb-48d3-bb5c-448b820f668c"],
Cell[CellGroupData[{
Cell[75635, 2119, 159, 3, 85, "Section",ExpressionUUID->"b8432c32-f3a0-48bd-b0e7-4529f055a04e"],
Cell[75797, 2124, 1129, 31, 105, "Text",ExpressionUUID->"cef8119a-37ae-403f-8a67-fd6459261552"],
Cell[76929, 2157, 1407, 41, 147, "Input",ExpressionUUID->"facaedda-76bc-402b-9b48-ae74826e3f46",
 InitializationCell->True],
Cell[78339, 2200, 1252, 27, 105, "Text",ExpressionUUID->"e38bb641-3464-41d7-8566-b58e1838f651"],
Cell[79594, 2229, 1820, 49, 205, "Input",ExpressionUUID->"0186486b-a385-4862-bf74-d6471580f8ed",
 InitializationCell->True],
Cell[81417, 2280, 489, 9, 105, "Text",ExpressionUUID->"ea6d7524-6856-450f-a7bb-9bb6fc170580"],
Cell[CellGroupData[{
Cell[81931, 2293, 521, 14, 39, "Input",ExpressionUUID->"eef9f21a-f8a4-46b2-abf0-a43456a436a7"],
Cell[82455, 2309, 1327, 22, 74, "Output",ExpressionUUID->"f84c7d5e-a62f-4ede-9023-084e62dac5bb"]
}, Open  ]],
Cell[83797, 2334, 1101, 29, 39, "Input",ExpressionUUID->"b9edf46c-6814-4145-ba3d-ac497645b49d"],
Cell[CellGroupData[{
Cell[84923, 2367, 234, 5, 39, "Input",ExpressionUUID->"fe0e60b6-0fa0-4d03-9d9e-50ccccd554d0"],
Cell[85160, 2374, 1645, 35, 132, "Output",ExpressionUUID->"7dd270f5-d41c-4d9e-a6f6-a7d7f0a4d488"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[86854, 2415, 155, 3, 66, "Section",ExpressionUUID->"9f4601e7-c16a-4a11-ae70-d9556c56ef94"],
Cell[87012, 2420, 846, 15, 224, "Text",ExpressionUUID->"762e159f-6c29-48ae-96d6-8d744d67d444"],
Cell[87861, 2437, 1163, 31, 135, "Text",ExpressionUUID->"857ad2ee-84cc-4eca-9153-fc7e0901a58d"],
Cell[CellGroupData[{
Cell[89049, 2472, 316, 7, 59, "Input",ExpressionUUID->"b6fe9b39-403a-48ca-a22f-369edabf4140",
 InitializationCell->True],
Cell[89368, 2481, 2024, 33, 44, "Output",ExpressionUUID->"ee8418da-5ad3-4493-adac-cd4e7c328068"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91429, 2519, 223, 4, 69, "Subsection",ExpressionUUID->"1b690565-d7a8-4daf-a73a-e64f5e361117"],
Cell[91655, 2525, 531, 15, 75, "Text",ExpressionUUID->"650a71d8-a1d4-46d8-a336-8c95c3f7f5db"],
Cell[92189, 2542, 1208, 31, 214, "Input",ExpressionUUID->"26c4a5c2-d440-417b-9b6e-c13caa272be0"],
Cell[93400, 2575, 261, 5, 45, "Text",ExpressionUUID->"02bc87b7-057e-4382-90b7-2e1b09d3eec5"],
Cell[93664, 2582, 1281, 35, 98, "Input",ExpressionUUID->"df0d7e60-5734-4a19-bf5c-6e35fa3269d6"],
Cell[94948, 2619, 440, 8, 75, "Text",ExpressionUUID->"f7471d36-930f-47f4-a38b-f2c67e930994"],
Cell[95391, 2629, 12030, 270, 1809, "Input",ExpressionUUID->"60f3bc51-7978-4172-a3c9-266eb01db6a9"],
Cell[107424, 2901, 233, 4, 45, "Text",ExpressionUUID->"a5bc851e-c1bc-475f-89eb-ee224d278c9e"],
Cell[107660, 2907, 1815, 51, 185, "Input",ExpressionUUID->"e786b857-499b-4342-bdcf-81639d94143b"],
Cell[109478, 2960, 242, 4, 45, "Text",ExpressionUUID->"78b5fb41-b0ee-40e9-aafb-4fa4afeddaa2"],
Cell[109723, 2966, 3838, 102, 533, "Input",ExpressionUUID->"58671395-5e14-4f70-a2ad-d87756323ad1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113598, 3073, 175, 3, 69, "Subsection",ExpressionUUID->"4a4f8ff1-3e91-4026-8c5c-254aac57d883"],
Cell[113776, 3078, 531, 15, 75, "Text",ExpressionUUID->"ebb24cef-a7ba-4f7d-ba87-2f2568e16180"],
Cell[114310, 3095, 1081, 26, 205, "Input",ExpressionUUID->"9b3e417d-b36a-4d53-aa44-62cf3cc44e76",
 InitializationCell->True],
Cell[115394, 3123, 261, 5, 45, "Text",ExpressionUUID->"d935f2f6-e259-44ff-afde-1805f0cf7e90"],
Cell[115658, 3130, 1068, 30, 89, "Input",ExpressionUUID->"3de749d7-95f7-45f7-985d-6e0ad577b796",
 InitializationCell->True],
Cell[116729, 3162, 440, 8, 75, "Text",ExpressionUUID->"2a9eb7e4-d5e3-46e8-9e5f-87861d5ec0e4"],
Cell[117172, 3172, 8127, 197, 1336, "Input",ExpressionUUID->"0aa5dc25-205d-4ce8-8008-b877d55b3705",
 InitializationCell->True],
Cell[125302, 3371, 233, 4, 45, "Text",ExpressionUUID->"5599b516-7616-4046-b1b5-f31ac645588c"],
Cell[125538, 3377, 1431, 42, 147, "Input",ExpressionUUID->"ee15f134-8a5e-4328-b909-90eea1a659fe",
 InitializationCell->True],
Cell[126972, 3421, 242, 4, 45, "Text",ExpressionUUID->"a6716cbf-eca8-49aa-99cb-70c3eb21c05e"],
Cell[127217, 3427, 3535, 94, 495, "Input",ExpressionUUID->"2c13f073-2afa-4d73-b607-335cd3fa16d6",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130801, 3527, 200, 4, 85, "Section",ExpressionUUID->"767e1ff4-6555-41a0-8123-a690763a0701"],
Cell[131004, 3533, 981, 23, 194, "Text",ExpressionUUID->"96023d43-f806-4569-b1ec-637f7a9d8804"],
Cell[CellGroupData[{
Cell[132010, 3560, 225, 4, 69, "Subsection",ExpressionUUID->"6b1112fd-c70d-4b7c-b3c2-94080786cd88"],
Cell[132238, 3566, 369, 7, 45, "Text",ExpressionUUID->"0597a4b6-9903-4e49-bd63-5cddd837ea41"],
Cell[132610, 3575, 12633, 291, 1635, "Input",ExpressionUUID->"69253122-35ca-4058-9099-46da0bcd3052"],
Cell[145246, 3868, 419, 8, 45, "Text",ExpressionUUID->"72455a84-5ab5-4b98-b5e0-6b0ae55a534f"],
Cell[145668, 3878, 9666, 236, 1374, "Input",ExpressionUUID->"cef49b94-fd30-4618-ae62-1da42ac03ebe"],
Cell[155337, 4116, 418, 8, 45, "Text",ExpressionUUID->"798ba209-42b3-46b4-9073-9098b61a53b4"],
Cell[155758, 4126, 8566, 219, 1026, "Input",ExpressionUUID->"6a76a04e-b9f7-41e0-9b36-6f66f27f36d3"],
Cell[164327, 4347, 419, 8, 45, "Text",ExpressionUUID->"31761617-6c00-4a73-8c27-00b2ddbf2c32"],
Cell[164749, 4357, 7775, 197, 939, "Input",ExpressionUUID->"31344346-ab83-462e-9142-6e4db4359187"],
Cell[172527, 4556, 158, 3, 45, "Text",ExpressionUUID->"0c65a689-f771-4657-a434-386005c0e307"],
Cell[172688, 4561, 499, 15, 39, "Input",ExpressionUUID->"6b1af498-60c4-41ff-b067-9c3f75c61a26"]
}, Closed]],
Cell[CellGroupData[{
Cell[173224, 4581, 175, 3, 48, "Subsection",ExpressionUUID->"9d6afb35-47f6-47d7-aec3-3fc3f26a5d0a"],
Cell[173402, 4586, 369, 7, 45, "Text",ExpressionUUID->"40ec76a3-fa87-442d-9e32-508b804466e0"],
Cell[173774, 4595, 8997, 217, 1249, "Input",ExpressionUUID->"5707bd90-bddf-4a1d-8e3e-a50fe218a7dc",
 InitializationCell->True],
Cell[182774, 4814, 419, 8, 45, "Text",ExpressionUUID->"9bbc4881-7e9e-4ec3-acf9-ec0df59a2268"],
Cell[183196, 4824, 8477, 206, 1075, "Input",ExpressionUUID->"8d548be1-acb1-4f15-b6b9-42d9a99ff27e",
 InitializationCell->True],
Cell[191676, 5032, 418, 8, 45, "Text",ExpressionUUID->"fc96c2f1-fd53-4fbc-a444-115c8dec0d58"],
Cell[192097, 5042, 6828, 180, 785, "Input",ExpressionUUID->"2d94b5fd-5659-4397-bc4a-9fefc344bc7c",
 InitializationCell->True],
Cell[198928, 5224, 419, 8, 45, "Text",ExpressionUUID->"38fd9f21-2f2f-44ca-9230-5ec59ea7953d"],
Cell[199350, 5234, 6577, 169, 756, "Input",ExpressionUUID->"3bafc472-5bf7-48bd-ad32-0ff4cc6af29c",
 InitializationCell->True],
Cell[205930, 5405, 158, 3, 45, "Text",ExpressionUUID->"bf475897-90a2-4989-9f0c-3e7dbc4da0af"],
Cell[206091, 5410, 522, 15, 59, "Input",ExpressionUUID->"0d5beac3-50f7-4de8-8954-4e4c70b7450b",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[206662, 5431, 265, 4, 85, "Section",ExpressionUUID->"66c92979-ccc4-4f83-a469-90ab64ff3586"],
Cell[206930, 5437, 1294, 37, 105, "Text",ExpressionUUID->"ee7c4320-0366-4261-b339-c429b298de90"],
Cell[208227, 5476, 1290, 29, 194, "Text",ExpressionUUID->"3d54aadb-d1c2-4dd7-a8fa-13109a4788d2"],
Cell[CellGroupData[{
Cell[209542, 5509, 223, 4, 69, "Subsection",ExpressionUUID->"ab79bdd5-2ee2-4c4d-9a6b-806bf0fd543e"],
Cell[209768, 5515, 836, 24, 69, "Input",ExpressionUUID->"30394347-e4af-44ee-b562-11fe393b68b4"],
Cell[210607, 5541, 3182, 83, 397, "Input",ExpressionUUID->"2a98bf30-439f-4bb6-83d7-f651bce3af95"],
Cell[213792, 5626, 157, 3, 45, "Text",ExpressionUUID->"ced5b0b9-f04b-4f44-9dab-73ddf2ec8200"],
Cell[213952, 5631, 648, 13, 75, "Text",ExpressionUUID->"1b783c1b-9450-4aeb-935f-58331aa510e2"],
Cell[214603, 5646, 5041, 129, 620, "Input",ExpressionUUID->"dbefce7e-2a04-4a10-82c2-ab5ce2809688"],
Cell[219647, 5777, 7590, 177, 852, "Input",ExpressionUUID->"6cdcbdbc-6c35-4e3c-a6f7-1e31b3c9ab00"],
Cell[227240, 5956, 678, 13, 75, "Text",ExpressionUUID->"e6c2ba97-8d0b-4008-b39a-ed940e98875d"],
Cell[227921, 5971, 1466, 41, 156, "Input",ExpressionUUID->"b5df34bc-575c-4d2f-af32-5d82a7f86095"],
Cell[229390, 6014, 12055, 299, 1577, "Input",ExpressionUUID->"ce593845-1231-4d43-8e38-24da98c326d6"]
}, Closed]],
Cell[CellGroupData[{
Cell[241482, 6318, 175, 3, 48, "Subsection",ExpressionUUID->"4871f7f6-7b10-4097-9568-3ce7900f97a5"],
Cell[241660, 6323, 155, 3, 45, "Text",ExpressionUUID->"f97db9a5-e004-47c1-91c8-0af1b762e757"],
Cell[241818, 6328, 881, 24, 89, "Input",ExpressionUUID->"ef31de4e-6700-4eb9-afd1-1d11db1c2419",
 InitializationCell->True],
Cell[242702, 6354, 2649, 70, 301, "Input",ExpressionUUID->"291c116d-c3fe-48f3-aa6b-048793a66d2b",
 InitializationCell->True],
Cell[245354, 6426, 157, 3, 45, "Text",ExpressionUUID->"70385013-3fb9-4587-b232-a85f419aca10"],
Cell[245514, 6431, 648, 13, 75, "Text",ExpressionUUID->"d42d4228-5715-4710-934f-bfc65a14dcf3"],
Cell[246165, 6446, 4430, 113, 495, "Input",ExpressionUUID->"535cf175-5ad7-4f43-a2ff-08d82520a41b",
 InitializationCell->True],
Cell[250598, 6561, 6348, 151, 669, "Input",ExpressionUUID->"9fbde3dc-3491-408d-b0c2-46127c7c7dd6",
 InitializationCell->True],
Cell[256949, 6714, 610, 12, 75, "Text",ExpressionUUID->"0ef7b520-0c9e-45bd-ac02-04861c0c44a5"],
Cell[257562, 6728, 1406, 40, 147, "Input",ExpressionUUID->"e58bc5d5-2d94-4b2b-84e3-decea4fe8cc5",
 InitializationCell->True],
Cell[258971, 6770, 9967, 246, 1278, "Input",ExpressionUUID->"8530aa09-bb3f-4d90-8784-834ef589db6c",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[268987, 7022, 308, 5, 85, "Section",ExpressionUUID->"28662e67-ae17-4ce0-88c0-7bfb4aede95c"],
Cell[269298, 7029, 595, 18, 45, "Text",ExpressionUUID->"6c904cce-eb26-43c4-91fc-56c81df5531d"],
Cell[269896, 7049, 4270, 111, 408, "Input",ExpressionUUID->"e588da51-99d7-430a-8264-2b9b91085515",
 InitializationCell->True],
Cell[274169, 7162, 676, 15, 39, "Input",ExpressionUUID->"374dd65b-1fe2-469f-9630-ea16b96fb6f4"],
Cell[274848, 7179, 609, 14, 45, "Text",ExpressionUUID->"de8a89b0-9fbf-4465-8316-cc8ef2c770e7"],
Cell[275460, 7195, 2044, 53, 176, "Input",ExpressionUUID->"2990deab-e4cb-4f86-8c84-ed040d38d255",
 InitializationCell->True],
Cell[277507, 7250, 1228, 36, 75, "Text",ExpressionUUID->"2ea49c77-28c1-4db0-937b-a1b173a5cb9b"],
Cell[278738, 7288, 1466, 42, 147, "Input",ExpressionUUID->"2f324dec-e31c-4c2c-a892-c518afac5b28",
 InitializationCell->True],
Cell[280207, 7332, 778, 21, 75, "Text",ExpressionUUID->"f66e121d-c02b-43bf-bcc3-a0343fe9c62c"],
Cell[280988, 7355, 5226, 114, 611, "Input",ExpressionUUID->"3c419cf4-7e2d-4c7c-98c6-7e02bc850427",
 InitializationCell->True],
Cell[286217, 7471, 157, 3, 45, "Text",ExpressionUUID->"565d0048-299d-4b1e-850d-40055f15c9e5"],
Cell[286377, 7476, 5498, 120, 736, "Input",ExpressionUUID->"c70c1c1d-fd90-4bff-9903-3bcc91cc911b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291912, 7601, 352, 6, 85, "Section",ExpressionUUID->"74037869-b1c7-4b44-ae05-0b5b338b2cd6"],
Cell[292267, 7609, 2166, 67, 135, "Text",ExpressionUUID->"06fa6ddb-b5bd-406f-a7ce-85e5e674227b"],
Cell[294436, 7678, 27801, 804, 2467, "Input",ExpressionUUID->"1dfd8066-84d7-48a6-ab5e-1f8875cb14e1",
 InitializationCell->True],
Cell[322240, 8484, 838, 21, 147, "Input",ExpressionUUID->"f88fbbf8-463c-4049-991d-9cbb1c12d6eb",
 InitializationCell->True],
Cell[323081, 8507, 289, 7, 39, "Input",ExpressionUUID->"390bde7c-55fb-41dc-8119-4724cc27307b"],
Cell[323373, 8516, 1592, 45, 139, "Input",ExpressionUUID->"4b2150d6-b459-4533-a394-8b2a7a9ef4b8"],
Cell[324968, 8563, 916, 21, 39, "Input",ExpressionUUID->"5bb59abc-f8ba-4a77-869e-91442da3477d"],
Cell[CellGroupData[{
Cell[325909, 8588, 1112, 30, 98, "Input",ExpressionUUID->"79b1ac0a-bda1-4998-8541-ca3f8c336a4e"],
Cell[327024, 8620, 133341, 2767, 225, "Output",ExpressionUUID->"af8cd4db-183a-4b14-a417-8538e6a85cc5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

