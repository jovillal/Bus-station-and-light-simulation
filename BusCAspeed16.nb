(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    425327,      10473]
NotebookOptionsPosition[    408940,      10229]
NotebookOutlinePosition[    409332,      10246]
CellTagsIndexPosition[    409289,      10243]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["An agent model for buses", "Title",
 CellChangeTimes->{{3.747229971380108*^9, 3.747229976524006*^9}, 
   3.747230014017823*^9, {3.756054684824004*^9, 
   3.7560546889496613`*^9}},ExpressionUUID->"96147a4d-7515-4828-be64-\
976d91bea8e8"],

Cell[CellGroupData[{

Cell["Assumptions and rules", "Subchapter",
 CellChangeTimes->{{3.747237266723563*^9, 
  3.747237273297133*^9}},ExpressionUUID->"6fca091b-9b9a-406e-a508-\
43cb7455b9fa"],

Cell[TextData[{
 "A ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Cross]", "n"}], TraditionalForm]],ExpressionUUID->
  "e12e3cb7-c7eb-4db2-a6ce-555be44cdc56"],
 " agent model, the top row marks stations and traffic lights, the bottom \
line holds the buses.\nPositive is taken to be to the left, there is no \
negative movent. Also, lights and stations are assumed to be sufficiently far \
apart so that it is impossible to have two of them within a bus\
\[CloseCurlyQuote] line of sight (LOS). \nBuses are characterized by the \
following parameters: \n\t\[FilledSmallCircle] Speed ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],ExpressionUUID->
  "1109c317-6ee4-4dfb-9580-7962e4c8972e"],
 " (number of cells that were advanced in the previous tick), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "\[Element]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "\[Ellipsis]", ",", 
      SubscriptBox["v", "max"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "c37779fd-cd46-444d-94a8-de81252e85b1"],
 ". The speed of each bus changes through the simulation. \n\t\
\[FilledSmallCircle] A negative acceleration ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "-"], TraditionalForm]],ExpressionUUID->
  "655cbb13-91e9-423d-808c-80f8d33421ed"],
 ", maximum negative speed change per tick, its fixed.\n\t\
\[FilledSmallCircle] A positive acceleration ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "+"], TraditionalForm]],ExpressionUUID->
  "19cf9dba-fad7-4625-8358-d889a8e7118d"],
 ", the maximum positive speed change per tick, its fixed.\n\t\
\[FilledSmallCircle] A number of cars or wagons ",
 Cell[BoxData[
  FormBox["w", TraditionalForm]],ExpressionUUID->
  "939d5e2a-fedb-4fda-9978-db9fdf7f2e10"],
 ", this is how many doors the bus has, its fixed. \n\t\[FilledSmallCircle] \
The carrying capacity of the wagons ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "4c59c80a-8c19-402a-8f5f-e42605d1c7f4"],
 ", fixed.\n\t\[FilledSmallCircle] Stations don\[CloseCurlyQuote]t have size, \
they are supposed to be able to fit an infinite number of commuters.\n\t\
\[FilledSmallCircle] The LOS of a bus is used to determine its reactions \
(according to the rules below), it is taken to be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["v", "max"], "+"}], "|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],ExpressionUUID->
  "55cba4af-d3d3-449d-9acb-90ac4eca1970"],
 ".\nBuses move according to the following rules:\n\t\[FilledSmallCircle] \
They must stop at red lights\n\t\[FilledSmallCircle] They must stop at \
stations and remain stationary while loading or unloading passengers\n\t\
\[FilledSmallCircle] They must brake if they may crash into the bus ahead.\n\t\
\[FilledSmallCircle] Otherwise they accelerate to maximum speed and keep \
cruising at that speed.\n\t\[FilledSmallCircle] A bus enters the simulation \
every tick, if possible, from the left with probability ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "b"], TraditionalForm]],ExpressionUUID->
  "a6aff739-ffa3-45d4-a78c-25aa5b9407fc"],
 ".\n Stations\n \t\[FilledSmallCircle] Unloading happens before loading.\n \t\
\[FilledSmallCircle] There is a load/unload rate ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "e0af1a2b-a2be-44a2-bac0-b014126201af"],
 " (units: passengers per tick), same for both cases.\n \t\
\[FilledSmallCircle] The bus unloads a percentage of passengers ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "u"], TraditionalForm]],ExpressionUUID->
  "bc90a4d9-6dd9-4946-b571-fff27286ebf6"],
 " each time it stops.\n \t\[FilledSmallCircle] The bus loads all possible \
passengers.\n \t\[FilledSmallCircle] Loading happens back to front (the back \
wagons fill first).\n \t\[FilledSmallCircle] Unloading happens front to back \
(the front wagons empty first).\n Lights\n \t\[FilledSmallCircle] Lights are \
green if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Sin", "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "i"], " ", "t"}], "+", 
      SubscriptBox["\[Phi]", "i"]}], ")"}], ">", "0"}], TraditionalForm]],
  ExpressionUUID->"7e0f9fc9-a06a-4671-911d-ecb75cee73c5"],
 ", red otherwise. "
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvUXeSNPt9WvHBTPsfUD0vcvGa0H0/TcvN4FornCb
/SDajz31KIj+UeX7DUTf4p7F5Q6kz8RJioDoTVOLFEH0xPx+OxA9d5e2B4j2
6XZ84QmkG5Y/eQ2i55Qd1vIC0qoLX+mD6ANr5e75AGm5xYefgejo7E+b7gBp
L3/pzSB6gtqWyzPfvnYMSuy6D6JvhO/wmAWkC17vAdNR/95+//TutaOrRw3/
ZyDNFFLDL/rhtWPk0quKIPrKLDUx6T+vHS/q14Npo/8Lp4NoC3vVDSC6b1rS
lrf/gOrPv90Don+cWyjczfDGUWpTpCSIjvkQKhvF/Mbx0rsnYBoAzkup2g==

  "],ExpressionUUID->"4b1e53e0-cadb-4068-a1b0-2ada61edd588"],

Cell["These are global parameters, don\[CloseCurlyQuote]t change them.", \
"Text",
 CellChangeTimes->{{3.7507030594127502`*^9, 
  3.750703078231501*^9}},ExpressionUUID->"bc79c9d6-9b1d-4c13-b73c-\
c855212371b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vmax", "=", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"am", "=", 
   RowBox[{"-", "7"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ap", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]\[Upsilon]", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pu", "=", ".3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]b", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"100", " ", "5", "  ", "w"}], "+", "vmax", "-", "am"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "size", " ", "of", " ", "the", " ", 
    "track"}], "*)"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.747241804141075*^9, 3.747241843917441*^9}, {
  3.747243802616193*^9, 3.747243807511299*^9}, {3.749750972493256*^9, 
  3.7497509834113073`*^9}, {3.749751077356114*^9, 3.749751080601962*^9}, {
  3.751050641282873*^9, 3.751050641793276*^9}, {3.7560547300347652`*^9, 
  3.756054736054923*^9}, {3.756055955596019*^9, 3.756055995492115*^9}, {
  3.7619340856716757`*^9, 3.761934114192047*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"06561019-91e5-4895-98ec-ea625464ae94"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data structures", "Subchapter",
 CellChangeTimes->{{3.747237279729944*^9, 3.747237285174081*^9}},
 Background->RGBColor[
  1, 0.5, 0.5],ExpressionUUID->"34a485e1-db54-494d-bd09-bd8e00ac5eae"],

Cell[CellGroupData[{

Cell["The track", "Section",
 CellChangeTimes->{{3.7481913999814157`*^9, 
  3.748191404425782*^9}},ExpressionUUID->"e8573741-344c-41ec-98bf-\
aeb18d62369a"],

Cell[TextData[{
 "The track is a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Cross]", "n"}], TraditionalForm]],ExpressionUUID->
  "1a11cbe8-58c2-4bca-a8f1-c8966d91c723"],
 " list, it has lights and stations on the first row, buses on the second. \
The last ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "max"], TraditionalForm]],ExpressionUUID->
  "defae4cf-506b-43bb-a338-dacbf7f86413"],
 " spaces should be kept empty for cleaning reasons. \nTime is kept at the \
first cell of the top track."
}], "Text",
 CellChangeTimes->{{3.7472399463468*^9, 3.747239983674673*^9}, {
  3.748193780234787*^9, 3.7481937806380243`*^9}, {3.748545672591663*^9, 
  3.7485457312808733`*^9}},ExpressionUUID->"8fe7bb2e-b8a4-42e3-9fa4-\
4a94ea0f459a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"track", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "size", "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.747239525393776*^9, 3.747239552026145*^9}, {
  3.74724186540729*^9, 3.747241874799971*^9}, {3.748193790292995*^9, 
  3.7481937926727962`*^9}, {3.749234045669479*^9, 3.7492340470936937`*^9}, {
  3.749234361393118*^9, 3.74923436320299*^9}, {3.761934122294231*^9, 
  3.7619341228938017`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"29371a8c-7808-401c-8a44-7fa1feab8cfb"],

Cell["This is the line-of-sight neighborhood of the bus", "Text",
 CellChangeTimes->{{3.747535848893268*^9, 3.747535874339202*^9}, {
  3.759165983311802*^9, 
  3.75916598525012*^9}},ExpressionUUID->"b89e8d06-e6e1-4670-9e35-\
cd61f5ecabec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"w", "+", "vmax", "-", "am"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.747535879203615*^9, {3.7481230980325623`*^9, 3.7481230981929903`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"a1a47536-9a1c-4457-b7ab-597eb0c6c9c7"],

Cell[TextData[{
 "This puts stations on ",
 Cell[BoxData[
  FormBox[
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "7187a5a9-7a0a-453a-83c1-1d4eaa977db4"],
 ", stations are lists of two elements ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["p", "i"], ",", "\[Alpha]"}], "}"}], TraditionalForm]],
  ExpressionUUID->"7dc45d96-a0bd-4bc8-a0af-fecb33a0fc2a"],
 ", with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "i"], TraditionalForm]],ExpressionUUID->
  "bb8992db-51a9-4e73-acfe-897b00d0f8dd"],
 " the amount of people at the station (0 at the start),  and ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "d55f4b61-7de0-4478-9470-3cea55ba0c06"],
 "(random uniform) the arrives per unit time. \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["stations",
     FontWeight->"Bold"], "[", "]"}], TraditionalForm]],ExpressionUUID->
  "59720332-a58c-4b45-860a-a09572588dfa"],
 " modifies ",
 Cell[BoxData[
  FormBox[
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "1fbf4245-6b10-4dea-bd50-3ce88de2830a"],
 " so that there is one station at place 50, and another every 100 cells \
ahead."
}], "Text",
 CellChangeTimes->{{3.748449050358139*^9, 3.7484490570423717`*^9}, {
  3.748449129449112*^9, 3.7484493006948357`*^9}, {3.748449863765726*^9, 
  3.748449927284923*^9}, {3.748450359501688*^9, 3.748450442338331*^9}, {
  3.756055667108514*^9, 
  3.756055718083351*^9}},ExpressionUUID->"0121c219-e4e1-41b9-a68f-\
bf0115741663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stations", "[", "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Rule", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"100", "j"}], "+", "50"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"Floor", "[", 
             FractionBox[
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"track", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"50", "+", "w"}], ";;", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "100"], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"RandomReal", "[", "]"}], "p"}], "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"Floor", "[", 
            FractionBox[
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"track", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"50", "+", "w"}], ";;", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "100"], "]"}], 
           "+", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.748450448663639*^9, 3.748450455068112*^9}, {
   3.748452778824389*^9, 3.748452822799199*^9}, {3.748453286218829*^9, 
   3.748453297003031*^9}, {3.748547155263887*^9, 3.74854719268616*^9}, {
   3.75105070964937*^9, 3.751050710735236*^9}, {3.751050773472084*^9, 
   3.7510507744685993`*^9}, 3.756056681275782*^9, {3.7591702094892387`*^9, 
   3.7591702099321012`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"571c3f2c-de0e-4e1b-8c09-ca43eeae9abc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"stations", "[", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.748452828024149*^9, 3.748452873157044*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"e26c2684-30e8-4eb8-b904-115724ea3ad9"],

Cell[TextData[{
 "This puts lights on ",
 Cell[BoxData[
  FormBox[
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "688a1300-b610-49de-b427-1c1b6c349caf"],
 ", lights are lists of one element ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Omega]", "i"], ",", 
      SubscriptBox["\[Phi]", "i"], ",", "t"}], "}"}], "}"}], 
   TraditionalForm]],ExpressionUUID->"f65af5af-0ffb-4630-b19e-31dbe4239d6c"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["lights",
     FontWeight->"Bold"], "[", "\[Omega]", "]"}], TraditionalForm]],
  ExpressionUUID->"b42b4dcb-5a9f-446e-878b-e274f1fbc0d9"],
 " modifies ",
 Cell[BoxData[
  FormBox[
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "b414d706-f17b-4784-b939-d79c8982c883"],
 " so that there is one light at place 100, and another every 100 cells \
ahead, lights all have frequency ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Omega]", "i"], "=", "\[Omega]"}], TraditionalForm]],
  ExpressionUUID->"e0383a17-2e4e-49ac-aabe-65e813fca9bb"],
 " and phase ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "i"], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"993a80b1-25d0-4a34-b61d-e0ba03c7da9c"],
 "."
}], "Text",
 CellChangeTimes->{{3.748449050358139*^9, 3.7484490570423717`*^9}, {
   3.748449129449112*^9, 3.7484493006948357`*^9}, {3.748449863765726*^9, 
   3.748449927284923*^9}, {3.748450359501688*^9, 3.748450442338331*^9}, {
   3.748452907098782*^9, 3.748452978784439*^9}, {3.748453317977995*^9, 
   3.748453319302793*^9}, {3.748454113668767*^9, 3.7484541519938297`*^9}, {
   3.750882340499102*^9, 3.7508823434670267`*^9}, {3.750882407066264*^9, 
   3.750882407433631*^9}, {3.756056748227737*^9, 3.75605677434754*^9}, {
   3.7560568346410503`*^9, 3.756056839241097*^9}, {3.7569250499703817`*^9, 
   3.756925050088746*^9}, 
   3.759165998325706*^9},ExpressionUUID->"d74bbd24-d0f1-42bd-bb3a-\
675cd6db6fe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lights", "[", "\[Omega]_", "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Rule", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"100", "j"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Floor", "[", 
             FractionBox[
              RowBox[{"Length", "[", 
               RowBox[{"track", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "100"], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\[Omega]", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
          RowBox[{"Floor", "[", 
           FractionBox[
            RowBox[{"Length", "[", 
             RowBox[{"track", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "100"], "]"}]}], "]"}]}],
        "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.748455991674415*^9, 3.748456047084758*^9}, {
   3.750882364420525*^9, 3.750882369073826*^9}, 3.756056864179556*^9, {
   3.75692507691663*^9, 3.756925077464826*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"841bd5b4-19a2-4ebf-9fdf-b991f32c62c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"track", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"lights", "[", "15", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.748456053981888*^9, 3.748456061577868*^9}, {
  3.748457261281228*^9, 3.748457286771179*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"74d04a73-a54a-4b31-8fb9-e91ce118eb78"]
}, Closed]],

Cell[CellGroupData[{

Cell["Buses", "Section",
 CellChangeTimes->{{3.747237625158515*^9, 
  3.747237629684988*^9}},ExpressionUUID->"a8b112f3-2448-4781-88eb-\
341c7082f57f"],

Cell[TextData[{
 "A bus is modeled as a sequence of lists, the head of the bus (rightmost \
list) is different from the wagons (lists to the left of the head).\n\t\
\[EmptySmallCircle] head: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["v", "i"], ",", 
     SubscriptBox["s", "i"], ",", 
     SubscriptBox["p", "i"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "3c45a063-a12f-4626-8611-1dd5a179b3aa"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", " ", 
    SubscriptBox["v", "i"], "\[LessEqual]", " ", 
    SubscriptBox["v", "max"]}], TraditionalForm]],ExpressionUUID->
  "3a7b5a57-c963-4cc1-a4cb-596e9fef70db"],
 " the speed that the bus had the previous tick, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "5bebefe3-1f68-439b-a6bf-c87e7ce1f7d6"],
 " the load status, and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", " ", 
    SubscriptBox["p", "i"], "\[LessEqual]", " ", "p"}], TraditionalForm]],
  ExpressionUUID->"21c6c373-48e8-400a-b92a-99019bde4748"],
 " the amount of passengers.\n\t\t\[EmptySquare] The load status: 0 is moving \
or ready to move, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"1", ",", "r"}], "}"}], TraditionalForm]],ExpressionUUID->
  "9a76100d-c8e1-4a7b-abed-a9ca337b755d"],
 " is unloading (",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "d266a3dc-0188-45a7-b203-5b298eec932a"],
 " keeps track of the ticks needed to finish unloading), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"2", ",", 
     StyleBox["pl",
      FontSlant->"Italic"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "6eedadfa-633e-4a86-a0c1-cedaf9172eef"],
 " is loading (loading happens until the bus is filled or there are no \
passengers in the station; ",
 Cell[BoxData[
  FormBox[
   StyleBox["pl",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "fc9b0b80-6d45-42f0-91dd-0b02bef9ae5b"],
 " is the amount of passengers in the previous tick).\n\t\[EmptySmallCircle] \
wagon: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    SubscriptBox["p", "i"], "}"}], TraditionalForm]],ExpressionUUID->
  "87ebd38d-de71-4c1e-9f67-bcffa70dbe8b"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", " ", 
    SubscriptBox["p", "i"], "\[LessEqual]", " ", "p"}], TraditionalForm]],
  ExpressionUUID->"899f5d7a-4cd1-4c67-afe8-b5c5ffeaec46"],
 " the amount of passengers."
}], "Text",
 CellChangeTimes->{{3.7472376720919437`*^9, 3.7472376938466043`*^9}, {
   3.747237736903092*^9, 3.74723773942349*^9}, {3.7472380818491497`*^9, 
   3.74723824407439*^9}, {3.747238279177437*^9, 3.747238491476478*^9}, 
   3.747239473691678*^9, {3.7472395184087467`*^9, 3.747239519296631*^9}, {
   3.748548537738312*^9, 3.748548597135934*^9}, {3.756057117985715*^9, 
   3.7560571493445587`*^9}, {3.756057443403653*^9, 3.756057548794032*^9}, {
   3.756057659153483*^9, 3.756057694817011*^9}, {3.756058162447485*^9, 
   3.7560581786216917`*^9}, {3.7563223359281273`*^9, 
   3.7563223867498093`*^9}, {3.759166008448511*^9, 
   3.7591660154793863`*^9}},ExpressionUUID->"ac33a864-65c0-4f37-b150-\
38ae66143e2f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test cases", "Section",
 CellChangeTimes->{{3.748191431513535*^9, 3.7481914360603037`*^9}, {
  3.748193741121952*^9, 
  3.748193744500205*^9}},ExpressionUUID->"b0d0f650-268d-4607-8117-\
169c38e036ce"],

Cell["brake cases (5, 19, 30, 35, 41, 99, 240, 348, 448)", "Text",
 CellChangeTimes->{{3.7476741400739202`*^9, 3.74767414502923*^9}, {
  3.749233177449691*^9, 3.7492332006821947`*^9}, {3.756060843143116*^9, 
  3.756060844087327*^9}, {3.7560609735645037`*^9, 3.756060982565888*^9}, {
  3.7560655931760197`*^9, 3.756065595599769*^9}, {3.758474141551765*^9, 
  3.758474153263773*^9}, {3.7584746502872343`*^9, 
  3.75847467908674*^9}},ExpressionUUID->"63d0b6a7-1d72-4561-8aee-\
350d800681da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vmax", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "ahead"}], ",", " ", 
    RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"15", ";;", "19"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Round", "[", 
        RowBox[{"vmax", "/", "2"}], "]"}], ",", "0", ",", "0"}], "}"}]}], 
    "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "ahead"}], ",", " ", 
    RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"26", ";;", "29"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "30", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "ahead"}], ",", " ", "stoped", ",", " ", "wait"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"31", ";;", "34"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "35", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "ahead"}], ",", " ", 
    RowBox[{"going", " ", "slow"}], ",", " ", "hold"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"94", ";;", "97"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "98", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "red", " ", "light", " ", "ahead", " ", "with", " ", "bus", " ", "before",
      " ", "light"}], "*)"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"37", ";;", "40"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "41", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "station", " ", "ahead", " ", "with", " ", "bus", " ", "before", " ", 
      "station"}], ",", " ", "brake"}], "*)"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"236", ";;", "239"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "240", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vmax", "-", "2"}], ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"station", " ", "ahead"}], ",", " ", "fast", ",", " ", "brake"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"344", ";;", "347"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "348", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"station", " ", "ahead"}], ",", " ", "close", ",", " ", "slow", 
    ",", " ", "accelerate"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"444", ";;", "447"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "448", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"station", " ", "ahead"}], ",", " ", "close", ",", " ", "fast", 
    ",", " ", "brake"}], "*)"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756059840119279*^9, 3.756059849189701*^9}, {
   3.756060024289875*^9, 3.7560600333432713`*^9}, 3.756060071721843*^9, {
   3.756060147244348*^9, 3.756060147531188*^9}, {3.756060252081932*^9, 
   3.7560602824468184`*^9}, 3.756060362438233*^9, {3.756060444090375*^9, 
   3.756060446986011*^9}, {3.7560607345780563`*^9, 3.7560607410603228`*^9}, {
   3.756060895490984*^9, 3.756060911931713*^9}, 3.7560609466636057`*^9, {
   3.75606558284133*^9, 3.756065604194254*^9}, 3.75615383516625*^9, 
   3.756328893796135*^9, {3.758474135025779*^9, 3.758474137009102*^9}, {
   3.758474637728314*^9, 3.75847467382403*^9}, {3.758748199542674*^9, 
   3.758748199965823*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"66ef6297-4ac6-4ef5-819e-ec40d1288576"],

Cell["Acceleration cases (41, 64, 104) ", "Text",
 CellChangeTimes->{{3.747671810465378*^9, 3.74767181610982*^9}, {
   3.749233208241004*^9, 3.7492332245197573`*^9}, {3.7560656239748983`*^9, 
   3.756065629520073*^9}, 
   3.756325187479982*^9},ExpressionUUID->"9f7925ca-5235-4f99-b779-\
fd5f8b16794b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"60", ";;", "63"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "64", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{"accelerate", ",", " ", 
    RowBox[{"nothing", " ", "nearby"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"100", ";;", "103"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "104", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{"light", " ", "behind"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"283", ";;", "286"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "287", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "far", " ", "ahead"}], ",", " ", 
    RowBox[{"going", " ", "slow"}]}], "*)"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7475737958997793`*^9, 3.747573863856892*^9}, {
   3.747593846473525*^9, 3.747593957424458*^9}, {3.7476697584490433`*^9, 
   3.747669783575808*^9}, {3.747674290254483*^9, 3.747674320003202*^9}, {
   3.747674394556715*^9, 3.7476744124883347`*^9}, {3.747674513886142*^9, 
   3.747674514523498*^9}, 3.748017642108061*^9, {3.748549182680806*^9, 
   3.748549186622135*^9}, {3.749231595382606*^9, 3.749231690972623*^9}, {
   3.749232133349145*^9, 3.749232142193492*^9}, {3.7496728178797703`*^9, 
   3.749672823718334*^9}, {3.749672872318117*^9, 3.749672892045418*^9}, 
   3.7560656207968807`*^9, {3.756328903066265*^9, 3.756328908441016*^9}, {
   3.7575322236909733`*^9, 3.757532225588779*^9}, {3.757532359152289*^9, 
   3.757532432470152*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"8df18c66-b716-420e-b945-a5db70389fb8"],

Cell["\<\
station cases (50, 150,  550, 650, 750, 850, 950, 1050, 1150, 1250). 
The stations are at positions\
\>", "Text",
 CellChangeTimes->{{3.749232087222259*^9, 3.749232094536237*^9}, {
   3.749233228061178*^9, 3.749233251411971*^9}, {3.7492333903928556`*^9, 
   3.74923339296726*^9}, {3.749317776101987*^9, 3.749317786615075*^9}, {
   3.749388042887443*^9, 3.74938805303113*^9}, {3.7493883328334827`*^9, 
   3.7493883354817142`*^9}, {3.750013165417955*^9, 3.7500131689215612`*^9}, {
   3.750013344677369*^9, 3.750013348294696*^9}, {3.756327588526321*^9, 
   3.7563276392772303`*^9}, 3.7584748085402203`*^9, {3.758474912547195*^9, 
   3.7584749138191*^9}, {3.758475003673604*^9, 3.758475007025482*^9}, {
   3.7584751785191803`*^9, 3.7584751847029963`*^9}, {3.758475296023569*^9, 
   3.758475297447941*^9}, {3.758475373800145*^9, 3.758475383135778*^9}, {
   3.758481105934627*^9, 
   3.758481107127142*^9}},ExpressionUUID->"4ec388ea-1684-4fb1-bde0-\
166c3d766324"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "_", "}"}]}], "]"}], "//", "Flatten"}]], "Input",
 CellChangeTimes->{{3.7493174650087757`*^9, 3.7493174651688766`*^9}, {
   3.756066174662869*^9, 3.756066175125661*^9}, 3.756066329708254*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"657c5e0a-a3a4-457a-88a1-52b23694d15f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "50", ",", "150", ",", "250", ",", "350", ",", "450", ",", "550", ",", 
   "650", ",", "750", ",", "850", ",", "950", ",", "1050", ",", "1150", ",", 
   "1250", ",", "1350", ",", "1450", ",", "1550", ",", "1650", ",", "1750", 
   ",", "1850", ",", "1950"}], "}"}]], "Output",
 CellChangeTimes->{3.749233377341728*^9, 3.749234402266046*^9, 
  3.749317399541057*^9, 3.7493174658738623`*^9, 3.756066330402842*^9, 
  3.7561519225414457`*^9, 3.756322284349333*^9, 3.756903818957389*^9, 
  3.757513353660935*^9, 3.758379683918743*^9, 3.758473157362357*^9, 
  3.758475483175642*^9, 3.758481535225829*^9, 3.758729043679577*^9, 
  3.759166035584758*^9, 3.759853848115035*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"f039b292-0e31-433c-8fef-a1829e8a004c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"46", ";;", "49"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "50", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", 
    RowBox[{"ready", " ", "to", " ", "move"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"146", ";;", "149"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "150", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", "am", "]"}], ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", "brake", 
    ",", " ", 
    RowBox[{"go", " ", "directly", " ", "to", " ", "loading"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"546", ";;", "549"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "550", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"\[Lambda]\[Upsilon]", "-", "1"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}], 
    ",", 
    RowBox[{
    "unload", " ", "and", " ", "change", " ", "status", " ", "to", " ", 
     "load"}]}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"646", ";;", "649"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "650", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"p", "/", "2"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}], 
    ",", " ", 
    RowBox[{"keeps", " ", "unloading"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"746", ";;", "748"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "749", "]"}], "]"}], "=", 
   RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "750", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}], 
    ",", 
    RowBox[{
    "unload", " ", "and", " ", "change", " ", "status", " ", "to", " ", 
     "load"}]}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"846", ";;", "849"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "850", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "950", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]\[Upsilon]", "-", "4"}], ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"946", ";;", "949"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "950", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1050", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3", "\[Lambda]\[Upsilon]"}], ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1046", ";;", "1049"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1050", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"p", "-", "\[Lambda]\[Upsilon]", "+", "3"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], ",",
     " ", "fill", ",", " ", 
    RowBox[{"change", " ", "to", " ", "0"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1150", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"5", "\[Lambda]\[Upsilon]"}], ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1146", ";;", "1149"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1150", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"p", " ", "w"}], "+", "\[Lambda]\[Upsilon]"}]}], "}"}], ",", 
     "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], ",",
     " ", 
    RowBox[{"tricked", " ", "to", " ", "change", " ", "to", " ", "0"}]}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1246", ";;", "1249"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", "d_", "}"}], "\[RuleDelayed]", 
     RowBox[{"{", "p", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1250", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "am", "]"}], "-", 
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "am", "]"}], "/", "2"}], "]"}]}], ",", "0", ",", 
     "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", "brake", 
    ",", " ", 
    RowBox[{"go", " ", "start", " ", "unloading"}]}], "*)"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.749317231138932*^9, 3.74931728316156*^9}, {
   3.749317316717847*^9, 3.7493173171099977`*^9}, {3.749317356872324*^9, 
   3.7493173694272413`*^9}, {3.749317479179035*^9, 3.749317491500669*^9}, {
   3.749317796545979*^9, 3.749317857822126*^9}, {3.749320181729562*^9, 
   3.749320193659864*^9}, {3.7493205179167957`*^9, 3.749320574429921*^9}, 
   3.749320648712331*^9, {3.749320979940587*^9, 3.749320989193927*^9}, {
   3.74932102644475*^9, 3.749321051214665*^9}, {3.7493880692412367`*^9, 
   3.749388116121711*^9}, {3.749388149060318*^9, 3.749388153250551*^9}, {
   3.7496710280966873`*^9, 3.749671073461565*^9}, {3.7496734160135393`*^9, 
   3.749673418484551*^9}, {3.74967390433278*^9, 3.74967390731649*^9}, {
   3.749674096257251*^9, 3.749674177336266*^9}, {3.7497520458958673`*^9, 
   3.749752050405943*^9}, {3.7500131243418903`*^9, 3.750013225442363*^9}, {
   3.750013322455677*^9, 3.750013376686771*^9}, {3.7500134126628847`*^9, 
   3.7500134144064817`*^9}, {3.750272068575433*^9, 3.750272072341571*^9}, {
   3.750273716985381*^9, 3.750273745950739*^9}, {3.750273807916534*^9, 
   3.750273836998466*^9}, {3.7502738762159033`*^9, 3.750273958340926*^9}, {
   3.756151936184614*^9, 3.756151936551824*^9}, 3.756327575610566*^9, 
   3.7584741268360157`*^9, {3.758474631201727*^9, 3.758474710255578*^9}, {
   3.7584747733179893`*^9, 3.758474780253954*^9}, {3.758474818245137*^9, 
   3.758474891547885*^9}, {3.758474979458723*^9, 3.758474999492812*^9}, {
   3.7584750725923634`*^9, 3.758475135856126*^9}, {3.758475167167807*^9, 
   3.7584754428810453`*^9}, {3.758475506051469*^9, 3.758475515408648*^9}, {
   3.758481077138793*^9, 3.758481162094837*^9}, {3.758483235566243*^9, 
   3.758483250100576*^9}, {3.75848328054144*^9, 3.758483303763611*^9}, {
   3.758483403986442*^9, 3.758483423857025*^9}, {3.758485655180566*^9, 
   3.758485676682671*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"b64af6ad-5580-4c4a-8833-42682b32afa8"],

Cell["\<\
light cases (200, 300, 400, 495, 594, 698).
The lights are at positions\
\>", "Text",
 CellChangeTimes->{{3.749232087222259*^9, 3.749232094536237*^9}, {
  3.74923220678028*^9, 3.749232207480122*^9}, {3.7492333974422283`*^9, 
  3.749233407700226*^9}, {3.7493200417502413`*^9, 3.749320078524002*^9}, {
  3.756328922896523*^9, 
  3.756328952344543*^9}},ExpressionUUID->"86d18cb1-de72-4495-ba5d-\
675fa7c601e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Position", "[", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}], "}"}]}], "]"}], "//", 
  "Flatten"}]], "Input",
 CellChangeTimes->{{3.756327852828023*^9, 3.756327854491337*^9}, {
  3.758737683160282*^9, 3.758737683477762*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"38fa66e0-66e7-492a-b4e0-40048fa82e3f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "100", ",", "200", ",", "300", ",", "400", ",", "500", ",", "600", ",", 
   "700", ",", "800", ",", "900", ",", "1000", ",", "1100", ",", "1200", ",", 
   "1300", ",", "1400", ",", "1500", ",", "1600", ",", "1700", ",", "1800", 
   ",", "1900", ",", "2000"}], "}"}]], "Output",
 CellChangeTimes->{3.7492334409628353`*^9, 3.749234407235713*^9, 
  3.756327857093831*^9, 3.756903819001604*^9, 3.757513353693927*^9, 
  3.758379683954102*^9, 3.758475451630332*^9, 3.7584815352780733`*^9, 
  3.758729043714582*^9, 3.758737642310013*^9, 3.7587376841426992`*^9, 
  3.759166035617086*^9, 3.759853848152367*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"a0b1bb2c-c3c6-4207-9773-4cebe814113c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"196", ";;", "199"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "200", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"red", " ", "light"}], ",", " ", 
    RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
    RowBox[{"bus", " ", "moving"}], ",", " ", "stop"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"296", ";;", "299"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "300", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"red", " ", "light"}], ",", " ", 
    RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
    RowBox[{"bus", " ", "stoped"}], ",", " ", "wait"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"396", ";;", "399"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "400", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "am", "]"}], "+", "1"}], ",", "0", ",", "0"}], 
    "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Red", " ", "light"}], ",", " ", 
    RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
    RowBox[{"bus", " ", "moving", " ", "fast"}], ",", " ", "move"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "500", ",", "1", ",", "2"}], "]"}], "]"}], "=", "1"}],
    ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"491", ";;", "494"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "495", "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"vmax", ",", "0", ",", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"green", " ", "light"}], ",", " ", "move"}], "*)"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"590", ";;", "593"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "594", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", ",", 
    " ", "hold"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"694", ";;", "697"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"track", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "698", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "0"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"red", " ", "light"}], ",", " ", "close", ",", " ", "slow", ",", 
    "hold"}], "*)"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7492336763374367`*^9, 3.749233853603043*^9}, {
   3.749233931397645*^9, 3.749233940445043*^9}, {3.7493183747792053`*^9, 
   3.7493184297962103`*^9}, {3.749318465279415*^9, 3.749318486894908*^9}, {
   3.749319447917459*^9, 3.7493194483139353`*^9}, {3.749320670974909*^9, 
   3.749320677415721*^9}, {3.7493207198006477`*^9, 3.7493207748645277`*^9}, {
   3.749321100272026*^9, 3.7493211252260323`*^9}, {3.749321639263977*^9, 
   3.749321675679863*^9}, 3.7493883064887857`*^9, {3.749670908930612*^9, 
   3.749670934728552*^9}, {3.749673182167342*^9, 3.749673182776807*^9}, {
   3.749674247663782*^9, 3.749674250927023*^9}, {3.749674341709115*^9, 
   3.749674344557102*^9}, {3.750943038654907*^9, 3.7509430387893887`*^9}, 
   3.7563287606725473`*^9, {3.7587380734422293`*^9, 3.7587380793269*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"048bab5f-774c-4caa-96dd-24eff9fbbb55"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.748191431513535*^9, 3.7481914360603037`*^9}},
 Background->RGBColor[
  1, 0.5, 0.5],ExpressionUUID->"9dc19ae6-ecbb-48d3-bb5c-448b820f668c"],

Cell[TextData[{
 "These decide the behavior of the accelerations, ",
 Cell[BoxData[
  FormBox[
   StyleBox["accelerate",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "71044003-9aef-423c-b394-13a692c82028"],
 " augments the speed according to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "+"], TraditionalForm]],ExpressionUUID->
  "25db3287-d077-4016-9824-8d363ce65c4f"],
 " but never above ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "max"], TraditionalForm]],ExpressionUUID->
  "a61d790f-a98b-4b4f-8300-881baf515c2a"],
 ". To diminish the speed use ",
 StyleBox["brake",
  FontWeight->"Bold"],
 ", it never diminishes the speed below 0 and it takes an optional argument \
for a negative acceleration different from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "-"], "."}], TraditionalForm]],ExpressionUUID->
  "6f01fdd9-d9c0-4617-b0a6-7631b25348ac"]
}], "Text",
 CellChangeTimes->{{3.748123632424643*^9, 3.748123805854216*^9}, {
  3.749738342757679*^9, 3.749738345643572*^9}, {3.749738600287261*^9, 
  3.749738614806486*^9}},ExpressionUUID->"cef8119a-37ae-403f-8a67-\
fd6459261552"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"accelerate", "[", "i_Integer", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"i", "+", "ap"}], ",", 
         RowBox[{
          RowBox[{"i", "+", "ap"}], "\[LessEqual]", "vmax"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"vmax", ",", 
         RowBox[{
          RowBox[{"i", "+", "ap"}], ">", "vmax"}]}], "}"}]}], "}"}], ",", 
     "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"brake", "[", 
   RowBox[{"i_Integer", ",", 
    RowBox[{"negacc_Integer:", "am"}]}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i", "+", "negacc"}], ",", 
        RowBox[{
         RowBox[{"i", "+", "negacc"}], "\[GreaterEqual]", " ", "0"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"i", "+", "negacc"}], "<", "0"}]}], "}"}]}], "}"}], ",", 
    "0"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.747589599535859*^9, 3.747589613449592*^9}, {
  3.747589689781673*^9, 3.747589782497353*^9}, {3.747593223540167*^9, 
  3.74759330210076*^9}, {3.747593354776238*^9, 3.7475934020227013`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"facaedda-76bc-402b-9b48-ae74826e3f46"],

Cell[TextData[{
 "This function creates a bus with probability ",
 Cell[BoxData[
  FormBox["\[Rho]b", TraditionalForm]],ExpressionUUID->
  "0c1d8da8-4a92-4edf-9f7d-e7fec295abfb"],
 ",  with ",
 Cell[BoxData[
  FormBox["w", TraditionalForm]],ExpressionUUID->
  "15cd1c57-90cf-498c-bdc9-57aa8ff76faf"],
 " wagons, it starts with full speed. The function receives a track, if there \
is a bus on the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"w", "+", "vmax", "-"}], "|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],ExpressionUUID->
  "1213ce71-f58f-4cd0-9d2b-5c4fe71859e6"],
 " blocks it does nothing, if not, it puts a new bus. Buses start empty."
}], "Text",
 CellChangeTimes->{{3.747239593281732*^9, 3.747239626637972*^9}, {
   3.747239656777773*^9, 3.747239685732884*^9}, {3.747239885233486*^9, 
   3.747239898811108*^9}, {3.747242372202776*^9, 3.7472423899073257`*^9}, {
   3.7472429636354*^9, 3.747243078751562*^9}, {3.747243994909453*^9, 
   3.747244001222211*^9}, {3.756058757394112*^9, 3.756058813562361*^9}, {
   3.756058884349334*^9, 3.756058893092087*^9}, 
   3.759853866112393*^9},ExpressionUUID->"e38bb641-3464-41d7-8566-\
b58e1838f651"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"newbus", "[", 
    RowBox[{"t_List", "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"w", "+", "vmax", "+", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], "]"}], "]"}], "\[Equal]", 
      "base"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomReal", "[", "]"}], "\[LessEqual]", " ", "\[Rho]b"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"t", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "i"}], "}"}], "\[Rule]", 
            RowBox[{"{", "0", "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"w", "+", "1"}]}], "}"}], "->", 
          RowBox[{"{", 
           RowBox[{"vmax", ",", "0", ",", "0"}], "}"}]}]}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newbus", "[", "t_List", "]"}], ":=", "t"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.747239589282551*^9, 3.747239589440178*^9}, {
  3.747239630542308*^9, 3.7472396367673492`*^9}, {3.7472396941415997`*^9, 
  3.747239700768009*^9}, {3.747239732489352*^9, 3.747239734272691*^9}, {
  3.747239846175805*^9, 3.7472398734154873`*^9}, {3.747239908938405*^9, 
  3.747239937514799*^9}, {3.7472418805105047`*^9, 3.747241904511771*^9}, {
  3.747242039783739*^9, 3.747242041286434*^9}, {3.74724227013041*^9, 
  3.747242294931985*^9}, {3.747242340139786*^9, 3.747242365322661*^9}, {
  3.747243086543771*^9, 3.747243099312097*^9}, {3.747244684949547*^9, 
  3.7472446985076847`*^9}, {3.7472447400825663`*^9, 3.747244756336102*^9}, {
  3.7485489541917067`*^9, 3.748548969246633*^9}, {3.7507940559546022`*^9, 
  3.750794061449357*^9}, {3.756058850145729*^9, 3.7560588506883783`*^9}, {
  3.756058992774171*^9, 3.7560590082501793`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"0186486b-a385-4862-bf74-d6471580f8ed"],

Cell["\<\
This builds the minimal neighborhood (LOS) for each bus, the logic for \
movement is build the neighborhood, then move the buses (only in the \
neighborhood), finally, update the buses positions. heads are used later\
\>", "Text",
 CellChangeTimes->{{3.748195395526585*^9, 3.748195478233656*^9}, {
  3.748195538688464*^9, 3.748195545206846*^9}, {3.749157020744774*^9, 
  3.749157022616678*^9}},ExpressionUUID->"ea6d7524-6856-450f-a7bb-\
9bb6fc170580"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"heads", "=", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"track", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.747580893901483*^9, 3.7475809105143414`*^9}, {
  3.747581004987136*^9, 3.74758100720737*^9}, {3.748549421292107*^9, 
  3.748549422218363*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"eef9f21a-f8a4-46b2-abf0-a43456a436a7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5", ",", "19", ",", "30", ",", "35", ",", "41", ",", "50", ",", "64", ",", 
   "98", ",", "104", ",", "150", ",", "200", ",", "240", ",", "287", ",", 
   "300", ",", "348", ",", "400", ",", "448", ",", "495", ",", "550", ",", 
   "594", ",", "650", ",", "698", ",", "750", ",", "850", ",", "950", ",", 
   "1050", ",", "1150", ",", "1250"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7484481470339317`*^9, 3.7485468536983356`*^9, 3.74854722059881*^9, {
   3.7485494003247023`*^9, 3.748549423134107*^9}, 3.7492340843191233`*^9, 
   3.7493892672917967`*^9, 3.74948848372478*^9, 3.749670843079938*^9, 
   3.7496738271148376`*^9, 3.749674193265051*^9, 3.750002318955509*^9, 
   3.750012734636779*^9, 3.750270390536581*^9, 3.750429524488081*^9, 
   3.750429706123736*^9, 3.7507118802497663`*^9, 3.756059256253076*^9, 
   3.756903824657819*^9, 3.757513329834244*^9, 3.757513363910578*^9, 
   3.757532442976603*^9, 3.7583796998442583`*^9, 3.7584778335829353`*^9, 
   3.758481203884131*^9, 3.758481548171183*^9, 3.758483318147333*^9, 
   3.758729052541617*^9, 3.7587383546526413`*^9, 3.7591660564137383`*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"06355f6b-1410-4f0a-b4c8-61cdc2e73701"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"neighbors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}]}], 
      "}"}], "&"}], "/@", "heads"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.747580940473942*^9, 3.7475810153366747`*^9}, {
   3.747581063537075*^9, 3.747581063684557*^9}, {3.748546828749857*^9, 
   3.748546848377801*^9}, {3.749157044138102*^9, 3.749157058584968*^9}, {
   3.7492313691848*^9, 3.749231382216443*^9}, 3.749399912371464*^9, {
   3.7507114970422297`*^9, 3.750711497901966*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"b9edf46c-6814-4145-ba3d-ac497645b49d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"neighbors", "[", 
  RowBox[{"[", "6", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.748546860163143*^9, 3.748546889440895*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"fe0e60b6-0fa0-4d03-9d9e-50ccccd554d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "13"}], "}"}], ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.748546863623502*^9, 3.7485468897755632`*^9}, 
   3.748547226267893*^9, 3.74948848859696*^9, 3.7496741958583317`*^9, 
   3.7500127366754513`*^9, 3.7504295280543537`*^9, 3.750429710722238*^9, 
   3.756904389894868*^9, 3.758477836973317*^9, 3.758481551133594*^9, 
   3.759166059939372*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"893f988c-d0ee-4802-a03e-41ebbd6f84e8"]
}, Open  ]],

Cell["\<\
Now, lets bus forward according to the following rules:
\t\[FilledSmallCircle] They must stop at red lights
\t\[FilledSmallCircle] They must stop at stations and remain stationary while \
loading or unloading passangers
\t\[FilledSmallCircle] They must brake if they may crash into the bus ahead.
\t\[FilledSmallCircle] Otherwise they accelerate to maximum speed and keep \
cruising at that speed.
The movement is simultaneous for all buses. The idea is to return the new \
position of the heads and the speed changes given the neighborhood of one bus.\
\>", "Text",
 CellChangeTimes->{{3.747511866992814*^9, 3.747511918911833*^9}, {
  3.747511954463647*^9, 3.747512086038766*^9}, {3.748195572955658*^9, 
  3.748195623951894*^9}, {3.756904692938826*^9, 
  3.756904726576531*^9}},ExpressionUUID->"fcdb0935-6db0-4968-906f-\
ed8903fa2764"],

Cell[CellGroupData[{

Cell["movebottom", "Subsection",
 CellChangeTimes->{{3.756908997148981*^9, 
  3.756909007065099*^9}},ExpressionUUID->"9f4601e7-c16a-4a11-ae70-\
d9556c56ef94"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["movebottom",
     FontWeight->"Bold"], "[", 
    StyleBox[
     RowBox[{
      RowBox[{"line_of", "_sight", "_neighborhood"}], ",", "spd"}],
     FontSlant->"Italic"], "]"}], TraditionalForm]],ExpressionUUID->
  "7fc18c16-556c-4fee-9248-fc0ec8af879f"],
 " only concerns itself with the movement with respect to other buses (it \
doesn\[CloseCurlyQuote]t care for lights or stations). It returns the new \
situation of the bus relative to the old one. The last argument is optional, \
if used it sets the speed to ",
 Cell[BoxData[
  FormBox[
   StyleBox["spd",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "e64c8158-240d-4e2a-9862-af85be08e52e"],
 ", should only be used when sure about ",
 Cell[BoxData[
  FormBox[
   StyleBox["spd",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "a6b271fa-5b60-46c4-9abc-3ae2ff316fe7"],
 "."
}], "Text",
 CellChangeTimes->{{3.7486233488289948`*^9, 3.748623522126315*^9}, {
  3.749744793337783*^9, 3.74974482066107*^9}, {3.757514592931611*^9, 
  3.757514612964838*^9}},ExpressionUUID->"857ad2ee-84cc-4eca-9153-\
fc7e0901a58d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sizepat", "=", 
  RowBox[{"ConstantArray", "[", 
   RowBox[{
    RowBox[{"{", "_", "}"}], ",", "w"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756904992342023*^9, 3.756905032778322*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"b6fe9b39-403a-48ca-a22f-369edabf4140"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "_", "}"}], ",", 
   RowBox[{"{", "_", "}"}], ",", 
   RowBox[{"{", "_", "}"}], ",", 
   RowBox[{"{", "_", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.756905075819442*^9, 3.757513638444756*^9, 
  3.7587402780645037`*^9, 3.759166064879031*^9, 3.75985388846577*^9, 
  3.761927519892097*^9, 3.762175403927288*^9, 3.7624412087477083`*^9, 
  3.7624519001615257`*^9, 3.763228222716765*^9, 3.763730932673176*^9, 
  3.763745999534617*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"d9b9e045-7699-48c0-a6a1-a5c6f2addd36"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions without messages", "Subsubsection",
 CellChangeTimes->{{3.75690896673565*^9, 
  3.7569089811333857`*^9}},ExpressionUUID->"4a4f8ff1-3e91-4026-8c5c-\
254aac57d883"],

Cell[TextData[{
 "The most specific case: Bus is stopped, there is enough room to accelerate \
forward. Only works if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["a", "+"], "\[LessEqual]"}], "|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "fdaa390e-9e5e-4144-a676-721fde675a10"],
 "."
}], "Text",
 CellChangeTimes->{{3.756914168894032*^9, 3.756914269178179*^9}, {
  3.7569168672173243`*^9, 
  3.756916884952548*^9}},ExpressionUUID->"ebb24cef-a7ba-4f7d-ba87-\
2f2568e16180"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Activate", "/@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Inactivate", "[", 
      RowBox[{
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", "sizepat"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", "i"}], "]"}]}], ",", "___"}], "}"}]}], "]"}], ":=",
        "\[IndentingNewLine]", 
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ",", "i"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "ap"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756914137900305*^9, 3.756914147475752*^9}, {
   3.756914298354786*^9, 3.756914314661626*^9}, {3.756915626400405*^9, 
   3.756915627239438*^9}, 3.75691580482024*^9, 3.756916795424233*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"9b3e417d-b36a-4d53-aa44-62cf3cc44e76"],

Cell["Case where the bus can\[CloseCurlyQuote]t move and its velocity is 0", \
"Text",
 CellChangeTimes->{{3.756915510251132*^9, 3.756915534239736*^9}, {
  3.756915717941362*^9, 
  3.756915729676852*^9}},ExpressionUUID->"d935f2f6-e259-44ff-afde-\
1805f0cf7e90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{"bottom", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sequence", "@@", "sizepat"}], ",", 
      RowBox[{"h", ":", 
       RowBox[{"{", 
        RowBox[{"0", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{"base", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"bottom", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"w", "+", "1"}], "\[Rule]", "h"}]}], "}"}], ",", "1"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756915744525333*^9, 3.756915753597331*^9}, {
  3.756915814100024*^9, 3.756915815900033*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"3de749d7-95f7-45f7-985d-6e0ad577b796"],

Cell["\<\
Restricted movement, the bus has some speed, there is a bus ahead. The key \
condition here is that if the other bus does not move, there would be no \
crash in the following iteration.\
\>", "Text",
 CellChangeTimes->{{3.7569160152340527`*^9, 3.7569161260144053`*^9}, {
  3.7569162733396397`*^9, 3.756916287483334*^9}, {3.7569170195093937`*^9, 
  3.7569170450369368`*^9}},ExpressionUUID->"2a9eb7e4-d5e3-46e8-9e5f-\
87861d5ec0e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movebottom", "[", 
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "___"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "/;", 
           RowBox[{"v", "\[GreaterEqual]", "1"}]}], ",", "_", ",", "_"}], 
         "}"}]}], ",", "___", ",", 
       RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"crash", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"bottom", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"w", "+", "2"}], ";;", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", "_", "}"}], ",", "1", ",", "1"}], "]"}], "]"}], "[", 
         
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "am", "]"}], "<", "crash"}], "&&", 
        RowBox[{"v", "\[GreaterEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Bus", " ", "ahead"}], ",", " ", "fast", ",", " ", 
         RowBox[{
         "brake", " ", "as", " ", "much", " ", "as", " ", "possible"}]}], 
        "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ",", 
         RowBox[{"brake", "[", "v", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "am", "]"}], "<", "crash"}], "&&", 
        RowBox[{"v", "<", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"far", ",", " ", 
         RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
            RowBox[{"Abs", "[", "am", "]"}]}], ",", 
           RowBox[{"Abs", "[", "am", "]"}], ",", 
           RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"crash", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
        RowBox[{"v", "\[GreaterEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"close", ",", " ", 
         RowBox[{"going", " ", "fast"}]}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ",", "crash"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"crash", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
        RowBox[{"v", "<", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"close", ",", " ", 
         RowBox[{"going", " ", "slow"}]}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"v", "+", "ap"}], ",", "ds", ",", 
            RowBox[{
             RowBox[{"v", "+", "ap"}], ">", "ds"}], ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", "ds"}], ",", 
                "ds", ",", 
                RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", "crash"}], ",", 
           "crash", ",", 
           RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "True", " ", ",", 
       RowBox[{"Print", "[", "\"\<crash will happen\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7569171179177322`*^9, 3.756917128245164*^9}, {
  3.756917330049464*^9, 3.7569173432709427`*^9}, {3.75753157833486*^9, 
  3.757531594701955*^9}, {3.757532629559155*^9, 3.757532637702544*^9}, {
  3.7624518332595367`*^9, 3.762451853026773*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"2d9432c3-9eb7-44f0-95be-305ef78469e1"],

Cell["\<\
The only remaining case, there is no bus ahead. Free movement.\
\>", "Text",
 CellChangeTimes->{{3.756917366071883*^9, 3.7569174017092123`*^9}, 
   3.7569175357063*^9},ExpressionUUID->"5599b516-7616-4046-b1b5-f31ac645588c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movebottom", "[", 
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "__"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"spd", "=", 
       RowBox[{"accelerate", "[", "v", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"base", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"spd", "+", "i"}], "\[Rule]", 
            RowBox[{
             RowBox[{"{", "wagons", "}"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"w", "+", "spd", "+", "1"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"spd", ",", 
            RowBox[{"h", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"h", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.7569175592832603`*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"ee15f134-8a5e-4328-b909-90eea1a659fe"],

Cell["The case where the speed is set, Only use if sure.", "Text",
 CellChangeTimes->{{3.75751463534298*^9, 3.757514678674118*^9}, {
  3.757514711729604*^9, 
  3.7575147124816227`*^9}},ExpressionUUID->"a6716cbf-eca8-49aa-99cb-\
70c3eb21c05e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "__"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", "rest___"}], 
      "}"}]}], ",", 
    RowBox[{"set_Integer", "/;", 
     RowBox[{"0", "\[LessEqual]", "set", "\[LessEqual]", "vmax"}]}]}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"crash", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", "rest", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", "1", ",", "1"}], "]"}], "//", 
       "Flatten"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"v", "-", "set"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"v", "-", "set"}], ">", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
       RowBox[{
       "Print", "[", "\"\<WARNING: Braking more than allowed\>\"", "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"set", "-", "v"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"set", "-", "v"}], ">", "ap"}]}], ",", 
       RowBox[{
       "Print", "[", "\"\<WARNING: Accelerating more than allowed\>\"", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"crash", "\[Equal]", 
         RowBox[{"{", "}"}]}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{"crash", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "\[GreaterEqual]", 
         "set"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"unrestricted", " ", "movement"}], ",", " ", "accelerate"}], 
        "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"base", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"set", "+", "i"}], "\[Rule]", 
              RowBox[{
               RowBox[{"{", "wagons", "}"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"w", "+", "set", "+", "1"}], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"set", ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", " ",
        ",", 
       RowBox[{"Print", "[", "\"\<Set speed is having trouble.\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7575147009616423`*^9, 3.757514979694734*^9}, {
  3.757515087356724*^9, 3.757515228179902*^9}, {3.757515277187276*^9, 
  3.757515280138817*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"2c13f073-2afa-4d73-b607-335cd3fa16d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions with messages", "Subsubsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 
  3.756909036722934*^9}},ExpressionUUID->"1b690565-d7a8-4daf-a73a-\
e64f5e361117"],

Cell[TextData[{
 "The most specific case: Bus is stopped, there is enough room to accelerate \
forward. Only works if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["a", "+"], "\[LessEqual]"}], "|", 
    SubscriptBox["a", "-"], "|"}], TraditionalForm]],ExpressionUUID->
  "aafe1ec3-fe3e-4d3d-a778-09d2d98666d2"],
 "."
}], "Text",
 CellChangeTimes->{{3.756914168894032*^9, 3.756914269178179*^9}, {
  3.7569168672173243`*^9, 
  3.756916884952548*^9}},ExpressionUUID->"650a71d8-a1d4-46d8-a336-\
8c95c3f7f5db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Activate", "/@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Inactivate", "[", 
      RowBox[{
       RowBox[{"movebottom", "[", 
        RowBox[{"bottom", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", "sizepat"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", "i"}], "]"}]}], ",", "___"}], "}"}]}], "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"i", ",", " ", "\"\< free\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", "i"}], "]"}]}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "ap"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756914137900305*^9, 3.756914147475752*^9}, {
  3.7569143238103323`*^9, 3.756914324861753*^9}},
 CellLabel->
  "In[553]:=",ExpressionUUID->"26c4a5c2-d440-417b-9b6e-c13caa272be0"],

Cell["Case where the bus can\[CloseCurlyQuote]t move and its velocity is 0", \
"Text",
 CellChangeTimes->{{3.756915510251132*^9, 3.756915534239736*^9}, {
  3.756915717941362*^9, 
  3.756915729676852*^9}},ExpressionUUID->"02bc87b7-057e-4382-90b7-\
2e1b09d3eec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{"bottom", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sequence", "@@", "sizepat"}], ",", 
      RowBox[{"h", ":", 
       RowBox[{"{", 
        RowBox[{"0", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<No move, speed was 0\>\"", "]"}], ";", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"base", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "\[Rule]", 
              RowBox[{"bottom", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"w", "+", "1"}], "\[Rule]", "h"}]}], "}"}], ",", "1"}], 
        "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.756915744525333*^9, 3.756915753597331*^9}, {
  3.7569170636050158`*^9, 3.756917064685018*^9}},
 CellLabel->
  "In[554]:=",ExpressionUUID->"df0d7e60-5734-4a19-bf5c-6e35fa3269d6"],

Cell["\<\
Restricted movement, the bus has some speed, there is a bus ahead. The key \
condition here is that if the other bus does not move, there would be no \
crash in the following iteration.\
\>", "Text",
 CellChangeTimes->{{3.7569160152340527`*^9, 3.7569161260144053`*^9}, {
  3.7569162733396397`*^9, 3.756916287483334*^9}, {3.7569170195093937`*^9, 
  3.7569170450369368`*^9}},ExpressionUUID->"f7471d36-930f-47f4-a38b-\
f2c67e930994"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movebottom", "[", 
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "___"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "/;", 
           RowBox[{"v", "\[GreaterEqual]", "1"}]}], ",", "_", ",", "_"}], 
         "}"}]}], ",", "___", ",", 
       RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"crash", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"bottom", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"w", "+", "2"}], ";;", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", "_", "}"}], ",", "1", ",", "1"}], "]"}], "]"}], "[", 
         
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Bus ahead, moving\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"h", ",", "crash"}], "}"}], "]"}], ";", "\[IndentingNewLine]",
       " ", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "am", "]"}], "<", "crash"}], "&&", 
         RowBox[{"v", "\[GreaterEqual]", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Bus", " ", "ahead"}], ",", " ", "fast", ",", " ", 
          RowBox[{
          "brake", " ", "as", " ", "much", " ", "as", " ", "possible"}]}], 
         "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Far, fast, brake max negative\>\"", "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"movebottom", "[", 
          RowBox[{"bottom", ",", 
           RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "am", "]"}], "<", "crash"}], "&&", 
         RowBox[{"v", "<", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{"far", ",", " ", 
          RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Far, slow, hold or accelerate to max negative\>\"", "]"}], ";", 
         RowBox[{"movebottom", "[", 
          RowBox[{"bottom", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
              RowBox[{"Abs", "[", "am", "]"}]}], ",", 
             RowBox[{"Abs", "[", "am", "]"}], ",", 
             RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"crash", "\[LessEqual]", 
          RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
         RowBox[{"v", "\[GreaterEqual]", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{"close", ",", " ", 
          RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Close, fast, brake to max negative or ds\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"movebottom", "[", 
          RowBox[{"bottom", ",", "crash"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"crash", "\[LessEqual]", 
          RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
         RowBox[{"v", "<", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{"close", ",", " ", 
          RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Close, slow, brake or accelerate to ds\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"v", "+", "ap"}], ",", "ds", ",", 
              RowBox[{
               RowBox[{"v", "+", "ap"}], ">", "ds"}], ",", 
              RowBox[{"movebottom", "[", 
               RowBox[{"bottom", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", "ds"}], ",", 
                  "ds", ",", 
                  RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"movebottom", "[", 
          RowBox[{"bottom", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", "crash"}], ",", 
             "crash", ",", 
             RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "True", " ", ",", 
        RowBox[{"Print", "[", "\"\<crash will happen\>\"", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.756917067328204*^9, 3.756917107870358*^9}, {
   3.756917354984603*^9, 3.756917356257004*^9}, {3.757515671399221*^9, 
   3.7575157180847273`*^9}, {3.7624516032665453`*^9, 3.7624516096411257`*^9}, 
   3.762451818769987*^9},ExpressionUUID->"d57bbcad-bdd3-4579-827a-\
e5ff72e6fe5f"],

Cell["\<\
The only remaining case, there is no bus ahead. Free movement.\
\>", "Text",
 CellChangeTimes->{{3.756917366071883*^9, 3.7569174017092123`*^9}, 
   3.7569175357063*^9},ExpressionUUID->"a5bc851e-c1bc-475f-89eb-ee224d278c9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movebottom", "[", 
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "__"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", "___"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"spd", "=", 
       RowBox[{"accelerate", "[", "v", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<No bus ahead.\>\"", "]"}], ";", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"base", ",", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"spd", "+", "i"}], "\[Rule]", 
             RowBox[{
              RowBox[{"{", "wagons", "}"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"w", "+", "spd", "+", "1"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"spd", ",", 
             RowBox[{"h", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"h", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "]"}]}]}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756917570211269*^9, 3.756917572019082*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"e786b857-499b-4342-bdcf-81639d94143b"],

Cell["The case where the speed is set, Only use if sure.", "Text",
 CellChangeTimes->{{3.75751463534298*^9, 3.757514678674118*^9}, {
  3.757514711729604*^9, 
  3.7575147124816227`*^9}},ExpressionUUID->"78b5fb41-b0ee-40e9-aafb-\
4fa4afeddaa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{
    RowBox[{"bottom", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"wagons", ":", "__"}], ",", 
       RowBox[{"h", ":", 
        RowBox[{"{", 
         RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", "rest___"}], 
      "}"}]}], ",", 
    RowBox[{"set_Integer", "/;", 
     RowBox[{"0", "\[LessEqual]", "set", "\[LessEqual]", "vmax"}]}]}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"crash", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"{", "rest", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", "1", ",", "1"}], "]"}], "//", 
       "Flatten"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"v", "-", "set"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"v", "-", "set"}], ">", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], ",", 
       RowBox[{
       "Print", "[", "\"\<WARNING: Braking more than allowed\>\"", "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"set", "-", "v"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"set", "-", "v"}], ">", "ap"}]}], ",", 
       RowBox[{
       "Print", "[", "\"\<WARNING: Accelerating more than allowed\>\"", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Changing speed from \>\"", ",", " ", "v", ",", " ", "\"\< to \>\"",
        ",", " ", "set"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"h", ",", "crash", ",", "set"}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"crash", "\[Equal]", 
         RowBox[{"{", "}"}]}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{"crash", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "\[GreaterEqual]", 
         "set"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"unrestricted", " ", "movement"}], ",", " ", "accelerate"}], 
        "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"base", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"set", "+", "i"}], "\[Rule]", 
              RowBox[{
               RowBox[{"{", "wagons", "}"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "w"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"w", "+", "set", "+", "1"}], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"set", ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", " ",
        ",", 
       RowBox[{"Print", "[", "\"\<Set speed is having trouble.\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7575147009616423`*^9, 3.757514979694734*^9}, {
  3.757515087356724*^9, 3.757515228179902*^9}, {3.75751530977876*^9, 
  3.7575153099775953`*^9}},
 CellLabel->
  "In[557]:=",ExpressionUUID->"58671395-5e14-4f70-a2ad-d87756323ad1"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["move", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 
  3.75690904578677*^9}},ExpressionUUID->"767e1ff4-6555-41a0-8123-\
a690763a0701"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["move",
     FontWeight->"Bold"], "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top",
       FontSlant->"Italic"], ",", 
      StyleBox["bottom",
       FontSlant->"Italic"]}], "}"}], "]"}], TraditionalForm]],
  ExpressionUUID->"f8c09585-136b-48bb-a1f5-ee473bbd6340"],
 " takes into account the different situations that arise from the \
interactions with the stations or lights.\nFor lights it stops the bus if the \
light is red and the bus can stop, for stations it stops the bus and \
loads/unloads passengers.\nStations and lights should be sufficiently spaced \
so that there is no chance to have two of them within the LOS of a bus."
}], "Text",
 CellChangeTimes->{{3.750274861670138*^9, 3.750274931941072*^9}, {
   3.750274984643898*^9, 3.7502750311476593`*^9}, {3.7569192993851957`*^9, 
   3.7569193235376263`*^9}, 
   3.75985395846246*^9},ExpressionUUID->"96023d43-f806-4569-b1ec-\
637f7a9d8804"],

Cell[CellGroupData[{

Cell["Functions without messages", "Subsubsection",
 CellChangeTimes->{{3.75690896673565*^9, 
  3.7569089811333857`*^9}},ExpressionUUID->"9d6afb35-47f6-47d7-aec3-\
3fc3f26a5d0a"],

Cell["\<\
Case where there is a station on the top track and there is a bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 
  3.756923320560177*^9}},ExpressionUUID->"40ec76a3-fa87-442d-9e32-\
508b804466e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"ds", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ds", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", ">", "0"}], 
        RowBox[{"(*", 
         RowBox[{"stop", ",", " ", 
          RowBox[{"go", " ", "to", " ", "unload"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"stopAndUnload", "[", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["top",
            FontSlant->"Italic"], ",", "bottom"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], 
        RowBox[{"(*", 
         RowBox[{"ready", " ", "to", " ", "move"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "True", 
        RowBox[{"(*", 
         RowBox[{"load", " ", "or", " ", "unload"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"loadAndUnload", "[", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["top",
            FontSlant->"Italic"], ",", 
           StyleBox["bottom",
            FontSlant->"Italic"]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ds", ">", "0"}], 
      RowBox[{"(*", 
       RowBox[{"Station", " ", "ahead"}], "*)"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ds", "\[GreaterEqual]", "db"}], 
        RowBox[{"(*", 
         RowBox[{"bus", " ", "2", " ", "is", " ", "closer"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Station", " ", "is", " ", "closer"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "<", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
                 RowBox[{"Abs", "[", "am", "]"}]}], ",", 
                RowBox[{"Abs", "[", "am", "]"}], ",", 
                RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ds", "\[LessEqual]", 
           RowBox[{"Abs", "[", "am", "]"}]}], 
          RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", 
             RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "True", ",", " ", 
          RowBox[{"Print", "[", "\"\<\\t\\tProblem (station)\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", "True", 
      RowBox[{"(*", 
       RowBox[{"station", " ", "behind"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756919141055341*^9, 3.75691914156811*^9}, {
   3.756919192383854*^9, 3.7569191933599787`*^9}, {3.7569192549262257`*^9, 
   3.756919255021707*^9}, {3.756919983616617*^9, 3.7569199844420557`*^9}, 
   3.756920203899517*^9, 3.756920438513762*^9, 3.756920758653461*^9, {
   3.7569221553272943`*^9, 3.756922266943678*^9}, {3.756922303092514*^9, 
   3.7569223487424927`*^9}, {3.756923157628049*^9, 3.756923159317794*^9}, {
   3.7569231975410233`*^9, 3.7569232809559402`*^9}, {3.756936380818111*^9, 
   3.756936403750822*^9}, {3.758479376513631*^9, 3.7584794501041803`*^9}, {
   3.758479484370964*^9, 3.7584795204054823`*^9}, 3.758479560158568*^9, {
   3.758479600395851*^9, 3.758479603826613*^9}, {3.7584820654345284`*^9, 
   3.7584820686677437`*^9}, {3.758729238390623*^9, 3.75872927247797*^9}, 
   3.758733449834013*^9, {3.7637458812205544`*^9, 3.76374593931892*^9}, {
   3.763746094192749*^9, 3.763746094604423*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"5707bd90-bddf-4a1d-8e3e-a50fe218a7dc"],

Cell["\<\
Case where there is a station on the top track and there is no bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.756923384383792*^9, 
  3.756923384575515*^9}},ExpressionUUID->"9bbc4881-7e9e-4ec3-acf9-\
ec0df59a2268"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "==", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"ds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ds", "<", "0"}], ",", 
      RowBox[{"(*", 
       RowBox[{"station", " ", "behind"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ds", "\[GreaterEqual]", "0"}], " ", 
      RowBox[{"(*", 
       RowBox[{"Deal", " ", "with", " ", "the", " ", "station"}], "*)"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "\[Equal]", "0"}], "&&", 
         RowBox[{"ds", "\[Equal]", "0"}]}], 
        RowBox[{"(*", 
         RowBox[{"bus", " ", "at", " ", "station"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"loadAndUnload", "[", 
           RowBox[{"{", 
            RowBox[{
             StyleBox["top",
              FontSlant->"Italic"], ",", 
             StyleBox["bottom",
              FontSlant->"Italic"]}], "}"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", ">", "0"}], "&&", 
         RowBox[{"ds", "\[Equal]", "0"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"bus", " ", "at", " ", "station"}], ",", " ", 
          RowBox[{"stop", " ", "and", " ", "go", " ", "to", " ", "unload"}]}],
          "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"stopAndUnload", "[", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["top",
            FontSlant->"Italic"], ",", 
           StyleBox["bottom",
            FontSlant->"Italic"]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
         RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
        RowBox[{"(*", 
         RowBox[{"far", ",", " ", 
          RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
         RowBox[{"v", "<", "ds"}]}], 
        RowBox[{"(*", 
         RowBox[{"far", ",", " ", 
          RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
               RowBox[{"Abs", "[", "am", "]"}]}], ",", 
              RowBox[{"Abs", "[", "am", "]"}], ",", 
              RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ds", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "True", ",", " ", 
        RowBox[{"Print", "[", "\"\<\\tProblem (station)\>\"", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", ",", 
      
      RowBox[{"Print", "[", "\"\<\\tProblem with interaction.\>\"", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.756919141055341*^9, 3.75691914156811*^9}, {
   3.756919192383854*^9, 3.7569191933599787`*^9}, {3.7569192549262257`*^9, 
   3.756919255021707*^9}, {3.756919983616617*^9, 3.7569199844420557`*^9}, 
   3.756920203899517*^9, 3.756920438513762*^9, 3.756920758653461*^9, {
   3.7569221553272943`*^9, 3.756922266943678*^9}, {3.756922303092514*^9, 
   3.7569223487424927`*^9}, {3.756923157628049*^9, 3.756923159317794*^9}, {
   3.7569231975410233`*^9, 3.7569232809559402`*^9}, {3.756923404635791*^9, 
   3.756923434185429*^9}, {3.756923472235037*^9, 3.7569235036417828`*^9}, {
   3.756936408663323*^9, 3.756936432340933*^9}, {3.757511908861381*^9, 
   3.7575119368840714`*^9}, {3.757511995203389*^9, 3.75751205758843*^9}, {
   3.7575121089345293`*^9, 3.757512119311709*^9}, 3.757512560852899*^9, {
   3.758479833201127*^9, 3.758479834107828*^9}, {3.758481961976777*^9, 
   3.758481971493462*^9}, {3.7584820741724253`*^9, 3.758482076924491*^9}, {
   3.7587291973834953`*^9, 3.758729232718058*^9}, {3.762443198703135*^9, 
   3.762443208901266*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"8d548be1-acb1-4f15-b6b9-42d9a99ff27e"],

Cell["\<\
Case where there is a light on the top track and there is a bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.7569237677400837`*^9, 
  3.756923772683919*^9}},ExpressionUUID->"fc96c2f1-fd53-4fbc-a444-\
115c8dec0d58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "1"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest___", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", "_List", ",", "1", ",", "1"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}], ",", 
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dl", "<", "0"}], "||", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ">", "0"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"light", " ", "behind"}], ",", " ", 
        RowBox[{"or", " ", "green"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dl", "\[GreaterEqual]", "db"}], 
      RowBox[{"(*", 
       RowBox[{"deal", " ", "with", " ", "the", " ", "bus"}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dl", "<", "db"}], 
      RowBox[{"(*", 
       RowBox[{"deal", " ", "with", " ", "the", " ", "light"}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dl", "\[Equal]", "0"}], "&&", 
         RowBox[{"v", ">", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
          ",", " ", 
          RowBox[{"moving", " ", "fast"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dl", "\[Equal]", "0"}], "&&", 
         RowBox[{"v", "\[LessEqual]", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
          ",", " ", "stop"}], "*)"}], ",", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"wagons", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"dl", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light"}], ",", " ", "near", ",", " ", 
          RowBox[{"advance", " ", "to", " ", "the", " ", "light"}]}], "*)"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dl", ">", 
          RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
         RowBox[{"v", ">", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", 
          ",", " ", "brake"}], "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dl", ">", 
          RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
         RowBox[{"v", "\[LessEqual]", " ", 
          RowBox[{"Abs", "[", "am", "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "slow", 
          ",", " ", "accekerate"}], "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"accelerate", "[", "v", "]"}]}], "]"}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", "True", ",", " ", 
      RowBox[{"Print", "[", "\"\<Problem (light)\>\"", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.756936438589587*^9, 3.756936467364991*^9}, {
  3.756936599840809*^9, 3.756936634863811*^9}, {3.758729155312252*^9, 
  3.758729183975337*^9}, {3.758740699254204*^9, 3.758740699628483*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"2d94b5fd-5659-4397-bc4a-9fefc344bc7c"],

Cell["\<\
Case where there is a light on the top track and there is no bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.7569237677400837`*^9, 
  3.756923782355897*^9}},ExpressionUUID->"38fd9f21-2f2f-44ca-9230-\
5ec59ea7953d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "1"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest___", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[Equal]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"top", ",", "_List", ",", "1", ",", "1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dl", "<", "0"}], "||", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ">", "0"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"light", " ", "behind"}], ",", " ", 
        RowBox[{"or", " ", "green"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Red", " ", "light"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dl", "\[Equal]", "0"}], "&&", 
       RowBox[{"v", ">", 
        RowBox[{"Abs", "[", "am", "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
        ",", " ", 
        RowBox[{"moving", " ", "fast"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dl", "\[Equal]", "0"}], "&&", 
       RowBox[{"v", "\[LessEqual]", 
        RowBox[{"Abs", "[", "am", "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
        ",", " ", "stop"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"{", 
         RowBox[{"wagons", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"h", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"h", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"dl", "\[LessEqual]", 
       RowBox[{"Abs", "[", "am", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light"}], ",", " ", "near", ",", " ", 
        RowBox[{"advance", " ", "to", " ", "the", " ", "light"}]}], "*)"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "+", "ap"}], ">", "dl"}], ",", "dl", ",", 
            RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dl", ">", 
        RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
       RowBox[{"v", ">", 
        RowBox[{"Abs", "[", "am", "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", ",",
         " ", "brake"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dl", ">", 
        RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
       RowBox[{"v", "\[LessEqual]", " ", 
        RowBox[{"Abs", "[", "am", "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "slow", ",",
         " ", "accekerate"}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"accelerate", "[", "v", "]"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "True", ",", " ", 
      RowBox[{"Print", "[", "\"\<Problem (light)\>\"", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.756936978093399*^9, 3.756937004813389*^9}, {
  3.7587410055360928`*^9, 3.758741005976446*^9}, {3.7587410478898993`*^9, 
  3.7587411230792713`*^9}, {3.7587479183347187`*^9, 3.758747918751042*^9}, {
  3.7587485279793167`*^9, 3.7587485468087*^9}, {3.758748611352149*^9, 
  3.758748611487352*^9}, {3.758748728494832*^9, 3.758748760548552*^9}, {
  3.759167156572847*^9, 3.75916715662593*^9}, {3.7591672695532417`*^9, 
  3.759167274901731*^9}, {3.759167611725483*^9, 3.759167652960013*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"3bafc472-5bf7-48bd-ad32-0ff4cc6af29c"],

Cell["The general case", "Text",
 CellChangeTimes->{{3.756937033515044*^9, 
  3.756937041992055*^9}},ExpressionUUID->"bf475897-90a2-4989-9f0c-\
3e7dbc4da0af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"move", "[", "track_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"movebottom", "[", 
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756937068503295*^9, 3.756937111262622*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"0d5beac3-50f7-4de8-8954-4e4c70b7450b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions with messages", "Subsubsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569176563043222`*^9, 
  3.7569176567446117`*^9}},ExpressionUUID->"6b1112fd-c70d-4b7c-b3c2-\
94080786cd88"],

Cell["\<\
Case where there is a station on the top track and there is a bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 
  3.756923320560177*^9}},ExpressionUUID->"0597a4b6-9903-4e49-bd63-\
5cddd837ea41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"ds", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Station and bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"db", ",", "ds"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tBus at station, unload, load or move\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"v", ">", "0"}], 
          RowBox[{"(*", 
           RowBox[{"stop", ",", " ", 
            RowBox[{"go", " ", "to", " ", "unload"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tStop, go to unload (or load).\>\"", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"stopAndUnload", "[", 
            RowBox[{"{", 
             RowBox[{
              StyleBox["top",
               FontSlant->"Italic"], ",", "bottom"}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], 
          RowBox[{"(*", 
           RowBox[{"ready", " ", "to", " ", "move"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<\\t\\tMove.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", "True", 
          RowBox[{"(*", 
           RowBox[{"load", " ", "or", " ", "unload"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<\\t\\tLoad or unload.\>\"", "]"}], ";", 
           
           RowBox[{"loadAndUnload", "[", 
            RowBox[{"{", 
             RowBox[{
              StyleBox["top",
               FontSlant->"Italic"], ",", 
              StyleBox["bottom",
               FontSlant->"Italic"]}], "}"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ds", ">", "0"}], 
       RowBox[{"(*", 
        RowBox[{"Station", " ", "ahead"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tStation ahead\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ds", "\[GreaterEqual]", "db"}], 
          RowBox[{"(*", 
           RowBox[{"bus", " ", "2", " ", "is", " ", "closer"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tBus 2 before station, interact with bus number 2\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Station", " ", "is", " ", "closer"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tStation before bus 2, interact with station\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
              RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
             RowBox[{"(*", 
              RowBox[{"far", ",", " ", 
               RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<\\t\\t\\tFar, fast, brake to max negative\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"top", ",", 
                RowBox[{"movebottom", "[", 
                 RowBox[{"bottom", ",", 
                  RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
              RowBox[{"v", "<", "ds"}]}], 
             RowBox[{"(*", 
              RowBox[{"far", ",", " ", 
               RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<\\t\\t\\tFar, slow, hold or accelerate to max \
negative\>\"", "]"}], ";", 
              RowBox[{"{", 
               RowBox[{"top", ",", 
                RowBox[{"movebottom", "[", 
                 RowBox[{"bottom", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
                    RowBox[{"Abs", "[", "am", "]"}]}], ",", 
                    RowBox[{"Abs", "[", "am", "]"}], ",", 
                    RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ds", "\[LessEqual]", 
              RowBox[{"Abs", "[", "am", "]"}]}], 
             RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<\\t\\t\\tClose, brake or accelerate to ds\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"top", ",", 
                RowBox[{"movebottom", "[", 
                 RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "True", ",", " ", 
             RowBox[{"Print", "[", "\"\<\\t\\tProblem (station)\>\"", "]"}]}],
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
        ",", "\[IndentingNewLine]", "True", 
       RowBox[{"(*", 
        RowBox[{"station", " ", "behind"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tStation behind, interact with bus ahead\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756919141055341*^9, 3.75691914156811*^9}, {
   3.756919192383854*^9, 3.7569191933599787`*^9}, {3.7569192549262257`*^9, 
   3.756919255021707*^9}, {3.756919983616617*^9, 3.7569199844420557`*^9}, 
   3.756920203899517*^9, 3.756920438513762*^9, 3.756920758653461*^9, {
   3.7569221553272943`*^9, 3.756922266943678*^9}, {3.756922303092514*^9, 
   3.7569223487424927`*^9}, {3.756923157628049*^9, 3.756923159317794*^9}, {
   3.7569231975410233`*^9, 3.7569232809559402`*^9}, {3.756936380818111*^9, 
   3.756936403750822*^9}, {3.758479376513631*^9, 3.7584794501041803`*^9}, {
   3.758479484370964*^9, 3.7584795204054823`*^9}, 3.758479560158568*^9, {
   3.758479600395851*^9, 3.758479603826613*^9}, {3.7584820654345284`*^9, 
   3.7584820686677437`*^9}, {3.763742617867609*^9, 3.763742619804126*^9}, {
   3.763742935560627*^9, 3.7637429419522667`*^9}, {3.763743042617161*^9, 
   3.7637430446896152`*^9}, {3.763743415058466*^9, 3.763743424895295*^9}, {
   3.7637437404738417`*^9, 3.763743806153653*^9}, {3.763743856633917*^9, 
   3.7637438838012114`*^9}, {3.763743930577243*^9, 3.763743997433917*^9}, {
   3.763744034791564*^9, 3.763744093125757*^9}, {3.763744172164503*^9, 
   3.7637442355777187`*^9}, 3.763744300375745*^9, {3.7637443771578627`*^9, 
   3.7637444024064207`*^9}, {3.763744508720989*^9, 3.7637445096175327`*^9}, {
   3.763744570381174*^9, 3.763744599751255*^9}, {3.7637446346471148`*^9, 
   3.763744774609602*^9}, 3.76374487235828*^9, {3.763744902568907*^9, 
   3.7637449990571632`*^9}, {3.763745033692873*^9, 3.7637450408161287`*^9}, {
   3.763745114287814*^9, 3.763745338080414*^9}, 3.763745421947445*^9, {
   3.763745481126849*^9, 3.763745511689632*^9}, {3.763745609520986*^9, 
   3.763745646481373*^9}, {3.763745693488312*^9, 3.763745741907752*^9}, {
   3.763745834532194*^9, 
   3.763745835242353*^9}},ExpressionUUID->"69253122-35ca-4058-9099-\
46da0bcd3052"],

Cell["\<\
Case where there is a station on the top track and there is no bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.756923384383792*^9, 
  3.756923384575515*^9}},ExpressionUUID->"72455a84-5ab5-4b98-b5e0-\
6b0ae55a534f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "==", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"ds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Station, no bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "ds", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "<", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"station", " ", "behind"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tStation behind\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ds", "\[GreaterEqual]", "0"}], " ", 
       RowBox[{"(*", 
        RowBox[{"Deal", " ", "with", " ", "the", " ", "station"}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tInteract with station\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "\[Equal]", "0"}], "&&", 
           RowBox[{"ds", "\[Equal]", "0"}]}], 
          RowBox[{"(*", 
           RowBox[{"bus", " ", "at", " ", "station"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tBus at station, load, unload or move\>\"",
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<\\t\\t\\tmove.\>\"", "]"}], ";", 
              RowBox[{"{", 
               RowBox[{"top", ",", 
                RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<\\t\\t\\tload or unload.\>\"", "]"}],
               ";", 
              RowBox[{"loadAndUnload", "[", 
               RowBox[{"{", 
                RowBox[{
                 StyleBox["top",
                  FontSlant->"Italic"], ",", 
                 StyleBox["bottom",
                  FontSlant->"Italic"]}], "}"}], "]"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", ">", "0"}], "&&", 
           RowBox[{"ds", "\[Equal]", "0"}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"bus", " ", "at", " ", "station"}], ",", " ", 
            RowBox[{
            "stop", " ", "and", " ", "go", " ", "to", " ", "unload"}]}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tBus at station, stop and go to unload\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"stopAndUnload", "[", 
            RowBox[{"{", 
             RowBox[{
              StyleBox["top",
               FontSlant->"Italic"], ",", 
              StyleBox["bottom",
               FontSlant->"Italic"]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tFar, fast, brake to max negative\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "<", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tFar, slow, hold or accelerate to max negative\>\"", 
            "]"}], ";", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
                  RowBox[{"Abs", "[", "am", "]"}]}], ",", 
                 RowBox[{"Abs", "[", "am", "]"}], ",", 
                 RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ds", "\[LessEqual]", 
           RowBox[{"Abs", "[", "am", "]"}]}], 
          RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tClose, brake or accelerate to ds\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", "True", ",", " ", 
          RowBox[{"Print", "[", "\"\<\\tProblem (station)\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", "True", 
       ",", 
       RowBox[{"Print", "[", "\"\<\\tProblem with interaction.\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756919141055341*^9, 3.75691914156811*^9}, {
   3.756919192383854*^9, 3.7569191933599787`*^9}, {3.7569192549262257`*^9, 
   3.756919255021707*^9}, {3.756919983616617*^9, 3.7569199844420557`*^9}, 
   3.756920203899517*^9, 3.756920438513762*^9, 3.756920758653461*^9, {
   3.7569221553272943`*^9, 3.756922266943678*^9}, {3.756922303092514*^9, 
   3.7569223487424927`*^9}, {3.756923157628049*^9, 3.756923159317794*^9}, {
   3.7569231975410233`*^9, 3.7569232809559402`*^9}, {3.756923404635791*^9, 
   3.756923434185429*^9}, {3.756923472235037*^9, 3.7569235036417828`*^9}, {
   3.756936408663323*^9, 3.756936432340933*^9}, {3.757511908861381*^9, 
   3.7575119368840714`*^9}, {3.757511995203389*^9, 3.75751205758843*^9}, {
   3.7575121089345293`*^9, 3.757512119311709*^9}, 3.757512560852899*^9, {
   3.758479833201127*^9, 3.758479834107828*^9}, {3.758481961976777*^9, 
   3.758481971493462*^9}, {3.7584820741724253`*^9, 3.758482076924491*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"41c188e8-4cd5-4695-927b-22e5c1445064"],

Cell["\<\
Case where there is a light on the top track and there is a bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.7569237677400837`*^9, 
  3.756923772683919*^9}},ExpressionUUID->"798ba209-42b3-46b4-9073-\
9098b61a53b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "1"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest___", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", "_List", ",", "1", ",", "1"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}], ",", 
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Light, bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"db", ",", "dl"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dl", "<", "0"}], "||", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ">", "0"}]}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"light", " ", "behind"}], ",", " ", 
         RowBox[{"or", " ", "green"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tLight behind or green\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dl", "\[GreaterEqual]", "db"}], 
       RowBox[{"(*", 
        RowBox[{"deal", " ", "with", " ", "the", " ", "bus"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tBus before light, interact with bus\>\"", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dl", "<", "db"}], 
       RowBox[{"(*", 
        RowBox[{"deal", " ", "with", " ", "the", " ", "light"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tLight before bus, interact with light\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dl", "\[Equal]", "0"}], "&&", 
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}],
             ",", " ", 
            RowBox[{"moving", " ", "fast"}]}], "*)"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tRed light at the head, moving fast\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dl", "\[Equal]", "0"}], "&&", 
           RowBox[{"v", "\[LessEqual]", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}],
             ",", " ", "stop"}], "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tRed light at the head, stop\>\"", "]"}], 
           ";", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"{", 
              RowBox[{"wagons", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"h", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"h", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"dl", "\[LessEqual]", 
           RowBox[{"Abs", "[", "am", "]"}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light"}], ",", " ", "near", ",", " ", 
            RowBox[{"advance", " ", "to", " ", "the", " ", "light"}]}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tNear, advance to the light\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dl", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", 
            ",", " ", "brake"}], "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tFar, fast, brake, advance to the light\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dl", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
           RowBox[{"v", "\[LessEqual]", " ", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "slow", 
            ",", " ", "accekerate"}], "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tFar, slow, accelerate, advance to the light\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"accelerate", "[", "v", "]"}]}], "]"}]}], "}"}]}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", "True", ",", " ", 
       RowBox[{"Print", "[", "\"\<Problem (light)\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756936438589587*^9, 3.756936467364991*^9}, {
  3.756936599840809*^9, 3.756936634863811*^9}, {3.758740353947177*^9, 
  3.7587403568585367`*^9}, {3.758740464066324*^9, 3.758740477362607*^9}, {
  3.75874059007401*^9, 3.758740599743247*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"6a76a04e-b9f7-41e0-9b36-6f66f27f36d3"],

Cell["\<\
Case where there is a light on the top track and there is no bus ahead.\
\>", "Text",
 CellChangeTimes->{{3.756919224054487*^9, 3.75691929435415*^9}, {
  3.756921508921224*^9, 3.7569215528969183`*^9}, {3.756922581870471*^9, 
  3.7569225838464003`*^9}, {3.756923312143839*^9, 3.756923320560177*^9}, {
  3.7569237677400837`*^9, 
  3.756923782355897*^9}},ExpressionUUID->"31761617-6c00-4a73-8c27-\
00b2ddbf2c32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "1"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest___", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[Equal]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"top", ",", "_List", ",", "1", ",", "1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"w", "+", "1"}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Light, no bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "dl", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dl", "<", "0"}], "||", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ">", "0"}]}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"light", " ", "behind"}], ",", " ", 
         RowBox[{"or", " ", "green"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tLight behind or green\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Red", " ", "light"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dl", "\[Equal]", "0"}], "&&", 
        RowBox[{"v", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
         ",", " ", 
         RowBox[{"moving", " ", "fast"}]}], "*)"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tRed light at the head, moving fast\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dl", "\[Equal]", "0"}], "&&", 
        RowBox[{"v", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light", " ", "at", " ", "the", " ", "head"}], 
         ",", " ", "stop"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tRed light at the head, stop\>\"", "]"}],
         ";", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"wagons", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"h", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"dl", "\[LessEqual]", 
        RowBox[{"Abs", "[", "am", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light"}], ",", " ", "near", ",", " ", 
         RowBox[{"advance", " ", "to", " ", "the", " ", "light"}]}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tNear, advance to the light\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "+", "ap"}], ">", "dl"}], ",", "dl", ",", 
              RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dl", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
        RowBox[{"v", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", 
         ",", " ", "brake"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tFar, fast, brake, advance to the light\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dl", ">", 
         RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
        RowBox[{"v", "\[LessEqual]", " ", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "slow", 
         ",", " ", "accekerate"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<\\tFar, slow, accelerate, advance to the light\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", 
           RowBox[{"bottom", ",", 
            RowBox[{"accelerate", "[", "v", "]"}]}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", " ", 
       RowBox[{"Print", "[", "\"\<Problem (light)\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756936978093399*^9, 3.756937004813389*^9}, {
  3.7587410055360928`*^9, 3.758741005976446*^9}, {3.7587410478898993`*^9, 
  3.7587411230792713`*^9}, {3.7587479183347187`*^9, 3.758747918751042*^9}, {
  3.7587485279793167`*^9, 3.7587485468087*^9}, {3.758748611352149*^9, 
  3.758748611487352*^9}, {3.758748728494832*^9, 3.758748760548552*^9}, {
  3.759167156572847*^9, 3.75916715662593*^9}, {3.7591672695532417`*^9, 
  3.759167274901731*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"46147936-aab2-4e80-9abd-a7f408e63568"],

Cell["The general case", "Text",
 CellChangeTimes->{{3.756937033515044*^9, 
  3.756937041992055*^9}},ExpressionUUID->"0c65a689-f771-4657-a434-\
386005c0e307"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"move", "[", "track_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"movebottom", "[", 
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.756937068503295*^9, 3.756937111262622*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"6b1af498-60c4-41ff-b067-9c3f75c61a26"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["load/unload functions", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 3.75690904578677*^9}, {3.757533242646553*^9, 
  3.7575332510226316`*^9}},ExpressionUUID->"66c92979-ccc4-4f83-a469-\
90ab64ff3586"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["stopAndUnload",
     FontWeight->"Bold"], "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top",
       FontSlant->"Italic"], ",", 
      StyleBox["bottom",
       FontSlant->"Italic"]}], "}"}], "]"}], TraditionalForm]],
  ExpressionUUID->"3a1544af-a6ce-4c56-b74b-65e8d3f86306"],
 " performs the initial unloading operations, it stops the bus, changes the \
load status to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"1", ",", "r"}], "}"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0d4fa9c9-2581-4238-9dff-198ea1c5aead"],
 ", with ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5de2cd4a-ab65-49b7-a590-f77a06cd523d"],
 " the number of ticks needed to unload ",
 Cell[BoxData[
  FormBox[
   StyleBox["pu",
    FontSlant->"Italic"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "24517b4a-99ac-409a-91e5-371c667be3ba"],
 " of the passengers."
}], "Text",
 CellChangeTimes->{{3.750275037726499*^9, 3.750275146969336*^9}, {
  3.757512530666684*^9, 3.757512531330861*^9}, {3.757512574160037*^9, 
  3.757512673164488*^9}},ExpressionUUID->"ee7c4320-0366-4261-b339-\
c429b298de90"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["loadAndUnload",
     FontWeight->"Bold"], "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top",
       FontSlant->"Italic"], ",", 
      StyleBox["bottom",
       FontSlant->"Italic"]}], "}"}], "]"}], TraditionalForm]],
  ExpressionUUID->"feac3521-a8b1-4671-9b7a-c057f2a9676d"],
 " performs the loading or unloading operations, loading takes place if the \
status of the bus is 2, unloading if it is 1, if the state is 0 the bus tries \
to move forward.\nBoth operations happen with a ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "6ae5f60f-5c28-465b-ae34-9bfff3507bf9"],
 " rate (passengers per tick).\nLoading happens while there are passengers at \
the station or there is no more room in the bus.\nThe bus fills back to front \
and empties front to back (irrelevant, just a programming convinience).\nThis \
only works if stations are size 1."
}], "Text",
 CellChangeTimes->{{3.750275037726499*^9, 3.750275146969336*^9}, {
  3.757533406435816*^9, 3.75753347949089*^9}, {3.757533526146117*^9, 
  3.7575335586094933`*^9}, {3.7575342831970263`*^9, 
  3.757534329643838*^9}},ExpressionUUID->"3d54aadb-d1c2-4dd7-a8fa-\
13109a4788d2"],

Cell[CellGroupData[{

Cell["Functions without messages", "Subsubsection",
 CellChangeTimes->{{3.75690896673565*^9, 
  3.7569089811333857`*^9}},ExpressionUUID->"4871f7f6-7b10-4097-9568-\
3ce7900f97a5"],

Cell["stopAndunload", "Text",
 CellChangeTimes->{{3.757533308336239*^9, 
  3.757533313790022*^9}},ExpressionUUID->"f97db9a5-e004-47c1-91c8-\
0af1b762e757"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stopAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top_",
       FontSlant->"Italic"], ",", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "/;", 
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "0", ",", "_"}], "}"}], 
        ",", "___"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{
   "Print", "[", "\"\<At station, moving too fast, problem\>\"", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7575125363215714`*^9, 3.757512536786708*^9}, {
  3.757512689148435*^9, 3.757512839328857*^9}, {3.757533050406497*^9, 
  3.757533050970915*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"ef31de4e-6700-4eb9-afd1-1d11db1c2419"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stopAndUnload", "[", 
   RowBox[{"{", 
    RowBox[{
     StyleBox["top_",
      FontSlant->"Italic"], ",", 
     RowBox[{"{", 
      RowBox[{"wagons___", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v_", "/;", 
          RowBox[{"v", "<=", 
           RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "0", ",", "p_"}], "}"}], 
       ",", "rest___"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"time", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"pu", 
        FractionBox[
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
          "p"}], "\[Lambda]\[Upsilon]"]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"time", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"{", 
         RowBox[{"wagons", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}]}], 
             "}"}], ",", "p"}], "}"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"{", 
         RowBox[{"wagons", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "time"}], "}"}], ",", "p"}], "}"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
       "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.757512846463655*^9, 3.757512964428207*^9}, {
   3.757512997865345*^9, 3.7575130112573757`*^9}, {3.7575131524227257`*^9, 
   3.757513217509941*^9}, 3.757513256787787*^9, {3.757533057237611*^9, 
   3.757533078107123*^9}, {3.7584800653496733`*^9, 3.758480067751424*^9}, {
   3.758480219690282*^9, 3.758480368583946*^9}, {3.758485824812153*^9, 
   3.758485841866559*^9}, {3.7587332105885143`*^9, 3.758733215602498*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"291c116d-c3fe-48f3-aa6b-048793a66d2b"],

Cell["loadAndUnload", "Text",
 CellChangeTimes->{{3.757533322014868*^9, 
  3.7575333280150757`*^9}},ExpressionUUID->"70385013-3fb9-4587-b232-\
a85f419aca10"],

Cell[TextData[{
 "Unload case, substract ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "18a4229a-5948-4208-a5ca-8d52f84c644a"],
 " passengers from the total (front to back), diminish the unloading time by \
one (if it is 1, unload and change to loading state)."
}], "Text",
 CellChangeTimes->{{3.7575339547965183`*^9, 3.757533991056507*^9}, {
  3.7575342730283327`*^9, 3.7575342738358517`*^9}, {3.757534420409361*^9, 
  3.7575344728803177`*^9}, {3.7584801529855967`*^9, 3.7584801530493813`*^9}, {
  3.7584801894888277`*^9, 
  3.758480196640493*^9}},ExpressionUUID->"d42d4228-5715-4710-934f-\
bfc65a14dcf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadAndUnload", "[", 
   RowBox[{"{", 
    RowBox[{"top_List", ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "___"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", "ph_"}], "}"}], ",", "__"}], 
       "}"}]}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pass", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
        "ph"}]}], ",", "new", ",", "wntf", ",", "newn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newn", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}], "<", "0"}], ",", "0", 
        ",", 
        RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "p", "}"}], ",", 
           RowBox[{"Floor", "[", 
            RowBox[{"newn", "/", "p"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Mod", "[", 
          RowBox[{"newn", ",", "p"}], "]"}], "}"}], ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"w", "-", 
            RowBox[{"Floor", "[", 
             RowBox[{"newn", "/", "p"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wntf", "=", 
      RowBox[{"Count", "[", 
       RowBox[{"new", ",", 
        RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"wntf", "\[GreaterEqual]", "1"}], 
       RowBox[{"(*", 
        RowBox[{"passengers", " ", "in", " ", "some", " ", "wagons"}], "*)"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"top", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"Most", "[", "new", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "newn"}], "}"}], ",", "0"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"wntf", "\[Equal]", "0"}], 
       RowBox[{"(*", 
        RowBox[{"passengers", " ", "in", " ", "all", " ", "wagons"}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"top", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"Most", "[", "new", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "newn"}], "}"}], ",", 
             RowBox[{"new", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\\tProblem unloading\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.757541287829062*^9, 3.75754132055529*^9}, {
  3.757541370458226*^9, 3.757541382121005*^9}, {3.757541412657538*^9, 
  3.757541426014131*^9}, {3.7575414588648167`*^9, 3.757541468261582*^9}, {
  3.757541515886451*^9, 3.757541583750464*^9}, {3.758480127764936*^9, 
  3.75848012830846*^9}, {3.7584821049633217`*^9, 3.758482105097*^9}, {
  3.7584821506101427`*^9, 3.7584821529972563`*^9}, {3.758482462997675*^9, 
  3.758482473114874*^9}, {3.75873322821481*^9, 3.7587332391706877`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"535cf175-5ad7-4f43-a2ff-08d82520a41b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{"top_List", ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"tl_", "/;", 
              RowBox[{"tl", ">", "1"}]}]}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pass", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
         "ph"}]}], ",", "new", ",", "wntf"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pass", "\[LessEqual]", "\[Lambda]\[Upsilon]"}], 
       RowBox[{"(*", 
        RowBox[{
        "only", " ", "a", " ", "small", " ", "percentage", " ", "of", " ", 
         "passengers", " ", "to", " ", "exit"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"top", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", "w"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", "0"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"new", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}], "<", "0"}], ",", 
           "0", ",", 
           RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"new", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", 
              RowBox[{"Floor", "[", 
               RowBox[{"new", "/", "p"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"Mod", "[", 
             RowBox[{"new", ",", "p"}], "]"}], "}"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"w", "-", 
               RowBox[{"Floor", "[", 
                RowBox[{"new", "/", "p"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"wntf", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"new", ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"wntf", "\[GreaterEqual]", "1"}], 
          RowBox[{"(*", 
           RowBox[{"passengers", " ", "in", " ", "some", " ", "wagons"}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{"Most", "[", "new", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"tl", "-", "1"}]}], "}"}], ",", "0"}], "}"}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"wntf", "\[Equal]", "0"}], 
          RowBox[{"(*", 
           RowBox[{"passengers", " ", "in", " ", "all", " ", "wagons"}], 
           "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"top", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{"Most", "[", "new", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"tl", "-", "1"}]}], "}"}], ",", 
                RowBox[{"new", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
           "}"}], ",", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<\\tProblem unloading\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.757534502089514*^9, 3.7575345974077187`*^9}, {
   3.7575347521014633`*^9, 3.757534841108519*^9}, {3.757534879028319*^9, 
   3.757534925115703*^9}, {3.757534966403092*^9, 3.757534977090084*^9}, {
   3.7575350308988733`*^9, 3.757535075625945*^9}, {3.75753752464648*^9, 
   3.757537554421344*^9}, {3.757537681314261*^9, 3.757537787368505*^9}, {
   3.7575384214035997`*^9, 3.7575384913625927`*^9}, {3.7575385664964037`*^9, 
   3.757538576191337*^9}, {3.757539350187571*^9, 3.757539366516136*^9}, {
   3.757539414144938*^9, 3.757539553406385*^9}, {3.757539616181175*^9, 
   3.757539856232952*^9}, {3.7575400263023367`*^9, 3.757540125089189*^9}, {
   3.757540222461514*^9, 3.757540301544537*^9}, {3.757540334511167*^9, 
   3.7575403374233103`*^9}, {3.757541240900365*^9, 3.757541247508295*^9}, 
   3.757541621091655*^9, {3.7584821618748713`*^9, 3.758482164148896*^9}, {
   3.758733257685616*^9, 3.758733274258732*^9}, {3.762444247464937*^9, 
   3.762444249703003*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"9fbde3dc-3491-408d-b0c2-46127c7c7dd6"],

Cell[TextData[{
 "Load case, add ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "7df77c19-0529-4bac-a7b0-75b5929885c8"],
 " passengers from the total (back to front), check if bus is full or number \
of passengers remains the same to change status to 0."
}], "Text",
 CellChangeTimes->{{3.7575339547965183`*^9, 3.757533991056507*^9}, {
   3.7575342730283327`*^9, 3.7575342738358517`*^9}, {3.757534420409361*^9, 
   3.7575344728803177`*^9}, {3.757542062227556*^9, 3.757542113274468*^9}, 
   3.758379643828998*^9},ExpressionUUID->"0ef7b520-0c9e-45bd-ac02-\
04861c0c44a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"top", ":", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "_"}], "}"}], ",", "__"}], "}"}]}], ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "prev_"}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"top", ",", 
       RowBox[{"{", 
        RowBox[{"wagons", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "ph"}], "}"}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"nothing", " ", "to", " ", "load"}], "*)"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.758482973744182*^9, 3.7584831229263897`*^9}, {
  3.758733283601969*^9, 3.758733284240638*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"e58bc5d5-2d94-4b2b-84e3-decea4fe8cc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"topprev___", ",", 
        RowBox[{"{", 
         RowBox[{"atstat_", ",", "\[Alpha]_"}], "}"}], ",", "aft__"}], "}"}], 
      ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "prev_"}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"newpass", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
         "ph"}]}], ",", "load", ",", "newwagons", ",", "newload", ",", 
       "newph"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"load", "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"atstat", "\[GreaterEqual]", "\[Lambda]\[Upsilon]"}], "&&", 
          
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"enough", " ", "passengers"}], ",", " ", 
           RowBox[{"enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", "\[Lambda]\[Upsilon]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "\[GreaterEqual]", "\[Lambda]\[Upsilon]"}], "&&", 
          
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], ">", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"enough", " ", "passengers"}], ",", " ", 
           RowBox[{"not", " ", "much", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"w", "+", "1"}], ")"}], "p"}], "-", "newpass"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "<", "\[Lambda]\[Upsilon]"}], "&&", 
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"not", " ", "enough", " ", "passengers"}], ",", " ", 
           RowBox[{"enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", "atstat", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "<", "\[Lambda]\[Upsilon]"}], "&&", 
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], ">", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"not", " ", "enough", " ", "passengers"}], ",", " ", 
           RowBox[{"not", " ", "enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Min", "[", 
          RowBox[{"atstat", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"w", "+", "1"}], ")"}], "p"}], "-", "newpass"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tProblem calculating how many to load.\>\"", 
           "]"}], ";", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newpass", "=", 
       RowBox[{"newpass", "+", "load"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newwagons", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"newpass", "/", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newwagons", ",", "newph"}], "}"}], "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newwagons", "\[Equal]", 
          RowBox[{"w", "+", "1"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"all", " ", "wagons", " ", "full"}], ",", " ", 
           RowBox[{"passengers", " ", "to", " ", "head"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
           RowBox[{"ph", "+", "load"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"newwagons", "\[Equal]", "w"}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fill", " ", "all", " ", "wagons"}], ",", " ", 
           RowBox[{"excess", " ", "passengers", " ", "to", " ", "head"}]}], 
          "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
           RowBox[{"Mod", "[", 
            RowBox[{"newpass", ",", "p"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"newwagons", "\[Equal]", 
          RowBox[{"w", "-", "1"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fill", " ", "most", " ", "wagons"}], ",", " ", 
           RowBox[{
           "excess", " ", "passengers", " ", "to", " ", "first", " ", 
            "wagon"}]}], "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "p", "}"}], ",", 
               RowBox[{"w", "-", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Mod", "[", 
               RowBox[{"newpass", ",", "p"}], "]"}], "}"}]}], "]"}], ",", 
           "0"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"newwagons", "<", 
          RowBox[{"w", "-", "1"}]}], 
         RowBox[{"(*", 
          RowBox[{"fill", " ", "some", " ", "wagons"}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "p", "}"}], ",", "newwagons"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"Mod", "[", 
                RowBox[{"newpass", ",", "p"}], "]"}], "}"}], "}"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"w", "-", "newwagons", "-", "1"}]}], "]"}]}], "]"}], 
           ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Print", "[", "\"\<\\tProblem filling wagons.\>\"", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newload", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"newwagons", ",", "newph"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"newph", "\[Equal]", "p"}], "||", 
         RowBox[{"newload", "\[Equal]", "prev"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"topprev", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"atstat", "-", "load"}], ",", "\[Alpha]"}], "}"}], ",", 
            "aft"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", "newwagons"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "newph"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"topprev", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"atstat", "-", "load"}], ",", "\[Alpha]"}], "}"}], ",", 
            "aft"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", "newwagons"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "newload"}], "}"}], ",", "newph"}], "}"}], 
            ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750429589666932*^9, 3.750429594424943*^9}, {
   3.750429681248145*^9, 3.750429684552951*^9}, 3.757534488973434*^9, 
   3.758379839417145*^9, 3.7583861933498898`*^9, {3.758479177873212*^9, 
   3.758479211216147*^9}, {3.758482173526119*^9, 3.758482183410152*^9}, {
   3.7584837354864473`*^9, 3.7584837594366093`*^9}, {3.7584838647151318`*^9, 
   3.758483929031191*^9}, {3.758484057767179*^9, 3.758484069717186*^9}, {
   3.758733289407731*^9, 3.758733355283474*^9}, {3.762442693310566*^9, 
   3.762442694713149*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"8530aa09-bb3f-4d90-8784-834ef589db6c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions with messages", "Subsubsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.757533282870018*^9, 
  3.7575332833258257`*^9}},ExpressionUUID->"ab79bdd5-2ee2-4c4d-9a6b-\
806bf0fd543e"],

Cell["stopAndunload", "Text",
 CellChangeTimes->{{3.757533308336239*^9, 
  3.757533313790022*^9}},ExpressionUUID->"10db8785-cf4b-4829-b9ea-\
833cda7d4da0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stopAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["top_",
       FontSlant->"Italic"], ",", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "/;", 
           RowBox[{"v", ">", 
            RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "0", ",", "_"}], "}"}], 
        ",", "___"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{
   "Print", "[", "\"\<At station, moving too fast, problem\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7575125363215714`*^9, 3.757512536786708*^9}, {
  3.757512689148435*^9, 3.757512839328857*^9}, {3.757533050406497*^9, 
  3.757533050970915*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"30394347-e4af-44ee-b562-11fe393b68b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stopAndUnload", "[", 
   RowBox[{"{", 
    RowBox[{
     StyleBox["top_",
      FontSlant->"Italic"], ",", 
     RowBox[{"{", 
      RowBox[{"wagons___", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v_", "/;", 
          RowBox[{"v", "<=", 
           RowBox[{"Abs", "[", "am", "]"}]}]}], ",", "0", ",", "p_"}], "}"}], 
       ",", "rest___"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"time", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"pu", 
        FractionBox[
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
          "p"}], "\[Lambda]\[Upsilon]"]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Stop, change status to unload, calculate how much time to unload\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\\tTime to unload: \>\"", ",", "time"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"time", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\t\\tGo to load.\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"wagons", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}]}], 
               "}"}], ",", "p"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\t\\tGo to unload.\>\"", "]"}], ";", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{"wagons", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "time"}], "}"}], ",", "p"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"{", "rest", "}"}], "]"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.757512846463655*^9, 3.757512964428207*^9}, {
   3.757512997865345*^9, 3.7575130112573757`*^9}, {3.7575131524227257`*^9, 
   3.757513217509941*^9}, 3.757513256787787*^9, {3.757533057237611*^9, 
   3.757533078107123*^9}, {3.7584800653496733`*^9, 3.758480067751424*^9}, {
   3.758480219690282*^9, 3.758480368583946*^9}, {3.758485824812153*^9, 
   3.758485841866559*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"2a98bf30-439f-4bb6-83d7-f651bce3af95"],

Cell["loadAndUnload", "Text",
 CellChangeTimes->{{3.757533322014868*^9, 
  3.7575333280150757`*^9}},ExpressionUUID->"ced5b0b9-f04b-4f44-9dab-\
73ddf2ec8200"],

Cell[TextData[{
 "Unload case, substract ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "c62ecc0d-a629-4fb7-a654-31d2dc34831f"],
 " passengers from the total (front to back), diminish the unloading time by \
one (if it is 1, unload and change to loading state)."
}], "Text",
 CellChangeTimes->{{3.7575339547965183`*^9, 3.757533991056507*^9}, {
  3.7575342730283327`*^9, 3.7575342738358517`*^9}, {3.757534420409361*^9, 
  3.7575344728803177`*^9}, {3.7584801529855967`*^9, 3.7584801530493813`*^9}, {
  3.7584801894888277`*^9, 
  3.758480196640493*^9}},ExpressionUUID->"1b783c1b-9450-4aeb-935f-\
58331aa510e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadAndUnload", "[", 
   RowBox[{"{", 
    RowBox[{"top_List", ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "___"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", "ph_"}], "}"}], ",", "__"}], 
       "}"}]}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pass", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
        "ph"}]}], ",", "new", ",", "wntf", ",", "newn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Unloading, last tick, go to loading\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newn", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}], "<", "0"}], ",", "0", 
        ",", 
        RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "p", "}"}], ",", 
           RowBox[{"Floor", "[", 
            RowBox[{"newn", "/", "p"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Mod", "[", 
          RowBox[{"newn", ",", "p"}], "]"}], "}"}], ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"w", "-", 
            RowBox[{"Floor", "[", 
             RowBox[{"newn", "/", "p"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wntf", "=", 
      RowBox[{"Count", "[", 
       RowBox[{"new", ",", 
        RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\\t\>\"", ",", "new"}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\\tNumber of new empty wagons: \>\"", ",", "wntf"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"wntf", "\[GreaterEqual]", "1"}], 
       RowBox[{"(*", 
        RowBox[{"passengers", " ", "in", " ", "some", " ", "wagons"}], "*)"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\t\\tSome wagons, not head\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", 
             RowBox[{"Most", "[", "new", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "newn"}], "}"}], ",", "0"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"wntf", "\[Equal]", "0"}], 
       RowBox[{"(*", 
        RowBox[{"passengers", " ", "in", " ", "all", " ", "wagons"}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\t\\tAll wagons and head\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", 
             RowBox[{"Most", "[", "new", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "newn"}], "}"}], ",", 
              RowBox[{"new", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<\\tProblem unloading\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.757541287829062*^9, 3.75754132055529*^9}, {
  3.757541370458226*^9, 3.757541382121005*^9}, {3.757541412657538*^9, 
  3.757541426014131*^9}, {3.7575414588648167`*^9, 3.757541468261582*^9}, {
  3.757541515886451*^9, 3.757541583750464*^9}, {3.758480127764936*^9, 
  3.75848012830846*^9}, {3.7584821049633217`*^9, 3.758482105097*^9}, {
  3.7584821506101427`*^9, 3.7584821529972563`*^9}, {3.758482462997675*^9, 
  3.758482473114874*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"dbefce7e-2a04-4a10-82c2-ab5ce2809688"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{"top_List", ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"tl_", "/;", 
              RowBox[{"tl", ">", "1"}]}]}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pass", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
         "ph"}]}], ",", "new", ",", "wntf"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Unloading, \>\"", ",", "tl", ",", "\"\< ticks to go.\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pass", "\[LessEqual]", "\[Lambda]\[Upsilon]"}], 
        RowBox[{"(*", 
         RowBox[{
         "only", " ", "a", " ", "small", " ", "percentage", " ", "of", " ", 
          "passengers", " ", "to", " ", "exit"}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<\\tEmpty the bus, go to loading\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"top", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", "0", "}"}], ",", "w"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", "0"}], "}"}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<\\tNeed to unload\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"new", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}], "<", "0"}], ",", 
            "0", ",", 
            RowBox[{"pass", "-", "\[Lambda]\[Upsilon]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"new", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "p", "}"}], ",", 
               RowBox[{"Floor", "[", 
                RowBox[{"new", "/", "p"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Mod", "[", 
              RowBox[{"new", ",", "p"}], "]"}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"w", "-", 
                RowBox[{"Floor", "[", 
                 RowBox[{"new", "/", "p"}], "]"}]}]}], "]"}]}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"wntf", "=", 
          RowBox[{"Count", "[", 
           RowBox[{"new", ",", 
            RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\\t\>\"", ",", "new"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\\tNumber of new empty wagons: \>\"", ",", "wntf"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"wntf", "\[GreaterEqual]", "1"}], 
           RowBox[{"(*", 
            RowBox[{"passengers", " ", "in", " ", "some", " ", "wagons"}], 
            "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<\\t\\tSome wagons, not head\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Most", "[", "new", "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"tl", "-", "1"}]}], "}"}], ",", "0"}], "}"}], ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], 
               "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"wntf", "\[Equal]", "0"}], 
           RowBox[{"(*", 
            RowBox[{"passengers", " ", "in", " ", "all", " ", "wagons"}], 
            "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\\t\\tAll wagons and head\>\"", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"top", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Most", "[", "new", "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"tl", "-", "1"}]}], "}"}], ",", 
                  RowBox[{"new", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], 
               "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<\\tProblem unloading\>\"", "]"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.757534502089514*^9, 3.7575345974077187`*^9}, {
   3.7575347521014633`*^9, 3.757534841108519*^9}, {3.757534879028319*^9, 
   3.757534925115703*^9}, {3.757534966403092*^9, 3.757534977090084*^9}, {
   3.7575350308988733`*^9, 3.757535075625945*^9}, {3.75753752464648*^9, 
   3.757537554421344*^9}, {3.757537681314261*^9, 3.757537787368505*^9}, {
   3.7575384214035997`*^9, 3.7575384913625927`*^9}, {3.7575385664964037`*^9, 
   3.757538576191337*^9}, {3.757539350187571*^9, 3.757539366516136*^9}, {
   3.757539414144938*^9, 3.757539553406385*^9}, {3.757539616181175*^9, 
   3.757539856232952*^9}, {3.7575400263023367`*^9, 3.757540125089189*^9}, {
   3.757540222461514*^9, 3.757540301544537*^9}, {3.757540334511167*^9, 
   3.7575403374233103`*^9}, {3.757541240900365*^9, 3.757541247508295*^9}, 
   3.757541621091655*^9, {3.7584821618748713`*^9, 3.758482164148896*^9}, 
   3.762443758914979*^9, {3.762443919647064*^9, 3.762443926169159*^9}, {
   3.762444057651415*^9, 3.762444069354136*^9}, {3.7624441107075377`*^9, 
   3.76244417336891*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"6cdcbdbc-6c35-4e3c-a6f7-1e31b3c9ab00"],

Cell[TextData[{
 "Load case, add ",
 Cell[BoxData[
  FormBox["\[Lambda]\[Upsilon]", TraditionalForm]],ExpressionUUID->
  "033fbbcc-a86e-4c3e-b700-d7122aa8f8f8"],
 " passengers from the total (back to front), check if bus is full or number \
of passengers remains the same to change status to 0."
}], "Text",
 CellChangeTimes->{{3.7575339547965183`*^9, 3.757533991056507*^9}, {
   3.7575342730283327`*^9, 3.7575342738358517`*^9}, {3.757534420409361*^9, 
   3.7575344728803177`*^9}, {3.757542062227556*^9, 3.757542113274468*^9}, 
   3.758379643828998*^9},ExpressionUUID->"e6c2ba97-8d0b-4008-b39a-\
ed940e98875d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"top", ":", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "_"}], "}"}], ",", "__"}], "}"}]}], ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "prev_"}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<No one to load, go to move\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"top", ",", 
        RowBox[{"{", 
         RowBox[{"wagons", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "ph"}], "}"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"nothing", " ", "to", " ", "load"}], "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.758482973744182*^9, 3.7584831229263897`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"b5df34bc-575c-4d2f-af32-5d82a7f86095"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadAndUnload", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"topprev___", ",", 
        RowBox[{"{", 
         RowBox[{"atstat_", ",", "\[Alpha]_"}], "}"}], ",", "aft__"}], "}"}], 
      ",", 
      RowBox[{"bottom", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wagons", ":", "___"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "prev_"}], "}"}], ",", "ph_"}], "}"}], ",", 
         "__"}], "}"}]}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"newpass", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"{", "wagons", "}"}], "//", "Flatten"}], "]"}], "+", 
         "ph"}]}], ",", "load", ",", "newwagons", ",", "newload", ",", 
       "newph"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Loading people.\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"load", "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"atstat", "\[GreaterEqual]", "\[Lambda]\[Upsilon]"}], "&&", 
          
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"enough", " ", "passengers"}], ",", " ", 
           RowBox[{"enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<\\tLoad all possible.\>\"", "]"}], ";", 
          "\[Lambda]\[Upsilon]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "\[GreaterEqual]", "\[Lambda]\[Upsilon]"}], "&&", 
          
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], ">", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"enough", " ", "passengers"}], ",", " ", 
           RowBox[{"not", " ", "much", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tLoad few, bus almost full.\>\"", "]"}], ";", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], "p"}], "-", "newpass"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "<", "\[Lambda]\[Upsilon]"}], "&&", 
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"not", " ", "enough", " ", "passengers"}], ",", " ", 
           RowBox[{"enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tLoad few, station almost empty.\>\"", "]"}], 
          ";", "atstat"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atstat", "<", "\[Lambda]\[Upsilon]"}], "&&", 
          RowBox[{
           RowBox[{"newpass", "+", "\[Lambda]\[Upsilon]"}], ">", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"w", "+", "1"}], ")"}], " ", "p"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"not", " ", "enough", " ", "passengers"}], ",", " ", 
           RowBox[{"not", " ", "enough", " ", "space"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<\\tLoad few, station almost empty and bus almost full.\>\"", 
           "]"}], ";", 
          RowBox[{"Min", "[", 
           RowBox[{"atstat", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"w", "+", "1"}], ")"}], "p"}], "-", "newpass"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tProblem calculating how many to load.\>\"", 
           "]"}], ";", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Will load \>\"", ",", "load"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newpass", "=", 
       RowBox[{"newpass", "+", "load"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<New passangers = \>\"", ",", "newpass"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newwagons", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"newpass", "/", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Fill \>\"", ",", "newwagons", ",", "\"\< wagons\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newwagons", ",", "newph"}], "}"}], "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newwagons", "\[Equal]", 
          RowBox[{"w", "+", "1"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"all", " ", "wagons", " ", "full"}], ",", " ", 
           RowBox[{"passengers", " ", "to", " ", "head"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<\\tall wagons full, all passengers to head.\>\"",
            "]"}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
            RowBox[{"ph", "+", "load"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"newwagons", "\[Equal]", "w"}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fill", " ", "all", " ", "wagons"}], ",", " ", 
           RowBox[{"excess", " ", "passengers", " ", "to", " ", "head"}]}], 
          "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<\\tfill all wagons, excess passengers to head.\>\"", "]"}], 
          ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "p", "}"}], ",", "w"}], "]"}], ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"newpass", ",", "p"}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"newwagons", "\[Equal]", 
          RowBox[{"w", "-", "1"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fill", " ", "most", " ", "wagons"}], ",", " ", 
           RowBox[{
           "excess", " ", "passengers", " ", "to", " ", "first", " ", 
            "wagon"}]}], "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<\\tfill most wagons, excess passengers to first.\>\"", "]"}], 
          ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", "p", "}"}], ",", 
                RowBox[{"w", "-", "1"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Mod", "[", 
                RowBox[{"newpass", ",", "p"}], "]"}], "}"}]}], "]"}], ",", 
            "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"newwagons", "<", 
          RowBox[{"w", "-", "1"}]}], 
         RowBox[{"(*", 
          RowBox[{"fill", " ", "some", " ", "wagons"}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<\\tfill some wagons.\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", "p", "}"}], ",", "newwagons"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"Mod", "[", 
                 RowBox[{"newpass", ",", "p"}], "]"}], "}"}], "}"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"w", "-", "newwagons", "-", "1"}]}], "]"}]}], "]"}], 
            ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Print", "[", "\"\<\\tProblem filling wagons.\>\"", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{newwagons,newph} is \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"newwagons", ",", "newph"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newload", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"newwagons", ",", "newph"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"newph", "\[Equal]", "p"}], "||", 
         RowBox[{"newload", "\[Equal]", "prev"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<\\tBus full, or no one to load.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"topprev", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"atstat", "-", "load"}], ",", "\[Alpha]"}], "}"}], ",",
              "aft"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sequence", "@@", "newwagons"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "newph"}], "}"}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<\\tBus filling.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"topprev", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"atstat", "-", "load"}], ",", "\[Alpha]"}], "}"}], ",",
              "aft"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sequence", "@@", "newwagons"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "newload"}], "}"}], ",", "newph"}], "}"}], 
             ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"vmax", "-", "am", "-", "1"}]}], "]"}]}]}], "}"}]}], 
          "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.750429589666932*^9, 3.750429594424943*^9}, {
   3.750429681248145*^9, 3.750429684552951*^9}, 3.757534488973434*^9, 
   3.758379839417145*^9, 3.7583861933498898`*^9, {3.758479177873212*^9, 
   3.758479211216147*^9}, {3.758482173526119*^9, 3.758482183410152*^9}, {
   3.7584837354864473`*^9, 3.7584837594366093`*^9}, {3.7584838647151318`*^9, 
   3.758483929031191*^9}, {3.758484057767179*^9, 3.758484069717186*^9}, {
   3.762442506346547*^9, 3.762442535597066*^9}, 3.76244264944569*^9},
 CellLabel->
  "In[146]:=",ExpressionUUID->"ce593845-1231-4d43-8e38-24da98c326d6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["other functions", "Subsection",
 CellChangeTimes->{{3.75690896673565*^9, 3.7569089811333857`*^9}, {
  3.7569090362429943`*^9, 3.75690904578677*^9}, {3.757533242646553*^9, 
  3.7575332510226316`*^9}, {3.758478677682332*^9, 
  3.758478678138625*^9}},ExpressionUUID->"28662e67-ae17-4ce0-88c0-\
7bfb4aede95c"],

Cell[TextData[{
 "This takes the position of the heads and the output from ",
 Cell[BoxData[
  FormBox[
   StyleBox["move",
    FontWeight->"Bold"], TraditionalForm]],ExpressionUUID->
  "a0215bd5-c6c2-4fa8-b881-114f0f667396"],
 " and returns ",
 Cell[BoxData[
  FormBox[
   StyleBox["track",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "f3688344-6216-4d49-a62e-258a62431e55"],
 " to match"
}], "Text",
 CellChangeTimes->{{3.748019053120804*^9, 3.748019103412537*^9}, {
  3.748025710124076*^9, 
  3.748025711238422*^9}},ExpressionUUID->"6c904cce-eb26-43c4-91fc-\
56c81df5531d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"update", "[", 
    RowBox[{"h_List", ",", 
     RowBox[{"{", 
      RowBox[{"toptrack_", ",", "moved_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tr", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", "size"}], "]"}]}], ",", "ahead", ",", "rlsup", 
        ",", "rlsdown", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"rlsup", "=", 
           RowBox[{"rlsdown", "=", 
            RowBox[{"{", "}"}]}]}]}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "h", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ahead", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"moved", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "_List", ",", "1",
               ",", "1"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rlsdown", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "ahead", "-", "j"}], 
               "\[Rule]", 
               RowBox[{
                RowBox[{"moved", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"ahead", "+", "1", "+", "w", "-", "j"}], "]"}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"w", "+", "1"}]}], "}"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"moved", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"w", "+", "1"}], "]"}], "]"}], "!=", 
             RowBox[{"toptrack", "[", 
              RowBox[{"[", 
               RowBox[{"h", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"rlsup", ",", 
              RowBox[{
               RowBox[{"h", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"moved", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"w", "+", "1"}], "]"}], "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"toptrack", ",", "rlsup"}], "]"}], ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tr", ",", 
           RowBox[{"rlsdown", "//", "Flatten"}]}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{
     RowBox[{"Length", "[", "h", "]"}], "\[Equal]", 
     RowBox[{"Length", "[", "moved", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"update", "[", "___", "]"}], ":=", 
   RowBox[{"Print", "[", "\"\<Update problem\>\"", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750713124601812*^9, 3.750713196626897*^9}, {
   3.761935709187643*^9, 3.761935714919177*^9}, {3.76218717056458*^9, 
   3.762187188927704*^9}, {3.762189294778338*^9, 3.762189332001729*^9}, 
   3.762441723931707*^9, {3.762445985470942*^9, 3.762446030580633*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"e588da51-99d7-430a-8264-2b9b91085515"],

Cell[BoxData[
 RowBox[{
  RowBox[{"update", "[", 
   RowBox[{"heads", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"move", "/@", "neighbors"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.747669641846209*^9, 3.747669644260633*^9}, {
   3.748024077553132*^9, 3.748024124635054*^9}, {3.748025465584773*^9, 
   3.7480255000676403`*^9}, {3.748025880261367*^9, 3.748025887581739*^9}, 
   3.748195688417997*^9, 3.748448720197466*^9, {3.750713586092608*^9, 
   3.750713596138451*^9}, 3.750772098813278*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"374dd65b-1fe2-469f-9630-ea16b96fb6f4"],

Cell[TextData[{
 "This takes the track and cleans the last ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "max"], TraditionalForm]],ExpressionUUID->
  "26da4fee-55e8-4217-bf96-11f956a9a40f"],
 " spaces."
}], "Text",
 CellChangeTimes->{{3.7481063654737453`*^9, 3.748106379688794*^9}, {
  3.7481064366359997`*^9, 3.748106438145303*^9}, {3.7481064779143248`*^9, 
  3.748106488288312*^9}, {3.748106629179949*^9, 3.7481066344510612`*^9}, {
  3.748545809815675*^9, 
  3.748545822751485*^9}},ExpressionUUID->"de8a89b0-9fbf-4465-8316-\
cc8ef2c770e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"clean", "[", 
    RowBox[{"all", ":", 
     RowBox[{"{", 
      RowBox[{"_List", ",", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "vmax"}], "]"}]}]}], "}"}]}], "}"}]}], "]"}], ":=",
    "all"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clean", "[", 
   RowBox[{"{", 
    RowBox[{"t1_List", ",", "t2_List"}], "}"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", "t2", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", "1", ",", "1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"t1", ",", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"t2", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "-", "i"}], "\[Rule]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "w"}], "}"}]}], "]"}]}], "]"}]}], 
     "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7481066660100803`*^9, 3.748106685247014*^9}, {
   3.748106743132887*^9, 3.748106761068407*^9}, {3.748107027024304*^9, 
   3.7481071442706327`*^9}, {3.748107180389435*^9, 3.7481072174488573`*^9}, {
   3.748107248958696*^9, 3.748107288491646*^9}, {3.748107342364038*^9, 
   3.74810734250038*^9}, {3.7481964835278273`*^9, 3.7481964836049347`*^9}, 
   3.7485491187972517`*^9, 3.759169047796501*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"2990deab-e4cb-4f86-8c84-ed040d38d255"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["fillstations",
     FontWeight->"Bold"], "[", 
    StyleBox["station",
     FontSlant->"Italic"], "]"}], TraditionalForm]],ExpressionUUID->
  "fdce66b4-7efb-494b-972d-aa1c25cfa021"],
 " takes a ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["station",
      FontSlant->"Italic"], "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["p", "i"], ",", "\[Alpha]"}], "}"}]}], ","}], 
   TraditionalForm]],ExpressionUUID->"89f66209-f0a3-4c48-9bbe-d27fb0e66b18"],
 " and fills it adding ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "0c9ad181-72c9-46b3-82db-f9053a0ae093"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "i"], TraditionalForm]],ExpressionUUID->
  "85d0a01a-e539-4882-aa9d-8f4b05057b43"],
 " (no limit). It also advances time."
}], "Text",
 CellChangeTimes->{{3.750451760153961*^9, 3.750451801496479*^9}, {
  3.750451863165938*^9, 3.750451953050598*^9}, {3.759170251443931*^9, 
  3.759170260019424*^9}, {3.7591703516335707`*^9, 
  3.7591703528964453`*^9}},ExpressionUUID->"2ea49c77-28c1-4db0-937b-\
a1b173a5cb9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fillstations", "[", 
    RowBox[{"{", 
     RowBox[{"p_", ",", "\[Alpha]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "+", "\[Alpha]"}], ",", "\[Alpha]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fillstations", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\[Omega]_", ",", "\[Phi]_", ",", "t_"}], "}"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\[Omega]", ",", "\[Phi]", ",", 
      RowBox[{"t", "+", "1"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fillstations", "[", 
    RowBox[{"s", ":", "___"}], "]"}], ":=", "s"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750452030147706*^9, 3.750452215151544*^9}, {
  3.750712458308178*^9, 3.750712458763319*^9}, {3.750712572336907*^9, 
  3.750712591551587*^9}, {3.75088318501324*^9, 3.75088321785758*^9}, {
  3.759170359193892*^9, 3.7591704191315928`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"2f324dec-e31c-4c2c-a892-c518afac5b28"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["advanceOne",
     FontWeight->"Bold"], "[", 
    StyleBox["track",
     FontSlant->"Italic"], "]"}], TraditionalForm]],ExpressionUUID->
  "0a996ae8-21b8-4cef-9560-5c648b06e374"],
 " takes a ",
 Cell[BoxData[
  FormBox[
   StyleBox["track",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "4bd3792c-6645-49e5-bb48-120a10061dce"],
 ", advances the buses, loads and unloads passengers, loads stations, \
advances time and tries to place a new bus at the start."
}], "Text",
 CellChangeTimes->{{3.7507034546438026`*^9, 3.750703471506812*^9}, {
  3.750703503691321*^9, 3.750703598192567*^9}, {3.750879305360405*^9, 
  3.7508793280955353`*^9}},ExpressionUUID->"f66e121d-c02b-43bf-bcc3-\
a0343fe9c62c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"advanceOne", "[", 
    RowBox[{"all", ":", 
     RowBox[{"{", 
      RowBox[{"ut_List", ",", "lt_List"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"heads", ",", "neighbors", ",", "moved"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"find", " ", "the", " ", "buses"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"heads", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"lt", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<heads ok\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "build", " ", "the", " ", "neighborhoods", " ", "of", " ", "the", " ", 
        "buses"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"neighbors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ut", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"#", "-", "w"}], ";;", 
              RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}],
            ",", 
           RowBox[{"lt", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"#", "-", "w"}], ";;", 
              RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], 
            "]"}]}], "}"}], "&"}], "/@", "heads"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<neighbors ok\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "find", " ", "new", " ", "positions", " ", "of", " ", "the", " ", 
        "buses"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "update", " ", "bus", " ", "positions", " ", "and", " ", "passenger", 
        " ", "loads"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"update", "[", 
        RowBox[{"heads", ",", 
         RowBox[{"{", 
          RowBox[{"ut", ",", 
           RowBox[{"move", "/@", "neighbors"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<moved ok\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Load", " ", "stations"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"update", " ", "time"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"moved", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"fillstations", "/@", 
        RowBox[{"moved", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<stations ok\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Clean", " ", "the", " ", "end", " ", "of", " ", "the", " ", "track"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"clean", "[", "moved", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<clean ok\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Place", " ", "a", " ", "new", " ", "bus"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"moved", "=", 
       RowBox[{"newbus", "[", "moved", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<new ok\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "done", "*)"}], "\[IndentingNewLine]", "moved"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"advanceOne", "[", "___", "]"}], ":=", 
  RowBox[{"Print", "[", "\"\<Not a valid track\>\"", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.750703374508174*^9, 3.750703412379362*^9}, {
   3.7507113229467278`*^9, 3.750711331036972*^9}, {3.750711369088517*^9, 
   3.750711383352607*^9}, {3.750711463423234*^9, 3.7507115905496073`*^9}, {
   3.750711656093367*^9, 3.75071170273173*^9}, {3.750712413281527*^9, 
   3.750712429202321*^9}, {3.750712614848542*^9, 3.750712706667368*^9}, {
   3.7507127837172813`*^9, 3.750712865447394*^9}, {3.750713609060687*^9, 
   3.750713752794245*^9}, {3.750714162888832*^9, 3.7507142303763647`*^9}, {
   3.750714398970551*^9, 3.7507144028406553`*^9}, {3.750714441229477*^9, 
   3.750714442444865*^9}, {3.750794461899194*^9, 3.750794480977352*^9}, {
   3.750794545981142*^9, 3.750794559962837*^9}, {3.7507956449906178`*^9, 
   3.750795693881771*^9}, {3.750797980814268*^9, 3.750798000355988*^9}, {
   3.750798041051797*^9, 3.750798045767384*^9}, 3.7508797088417053`*^9, {
   3.750881503081153*^9, 3.750881504817297*^9}, {3.750883574151743*^9, 
   3.7508835880154963`*^9}, {3.762183584158002*^9, 3.762183608990088*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"c70c1c1d-fd90-4bff-9903-3bcc91cc911b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"updated", "=", 
   RowBox[{"advanceOne", "[", "track", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.750714049050847*^9, 3.750714100949107*^9}},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[472]:=",ExpressionUUID->"65a3c1cb-41b3-450f-a822-a563d3b031ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"heads", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], "//", "Flatten"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}]}], 
      "}"}], "&"}], "/@", "heads"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.750715057023924*^9, 3.750715084512083*^9}, {
  3.750800095971601*^9, 3.7508001051120358`*^9}, {3.7508005748154287`*^9, 
  3.750800596309864*^9}, {3.750864445564837*^9, 3.750864447003429*^9}, {
  3.750867756449089*^9, 3.750867764153426*^9}},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[156]:=",ExpressionUUID->"3a8ae963-9502-4e63-b13b-2754476e9134"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bn", "=", "23"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbors", "[", 
   RowBox[{"[", "bn", "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"neighbors", "[", 
    RowBox[{"[", "bn", "]"}], "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"updated", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "-", "w"}], ";;", 
         RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"updated", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "-", "w"}], ";;", 
         RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}]}], 
     "}"}], "&"}], "[", 
   RowBox[{"heads", "[", 
    RowBox[{"[", "bn", "]"}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7494000203244467`*^9, 3.749400037952795*^9}, {
   3.749400086792404*^9, 3.749400087390299*^9}, 3.749400138094263*^9, {
   3.7494003634904957`*^9, 3.749400386274212*^9}, 3.749401630316216*^9, {
   3.749401690130478*^9, 3.749401713649968*^9}, {3.749405344759461*^9, 
   3.749405371132978*^9}, {3.749405416175166*^9, 3.749405416812467*^9}, {
   3.749405748920727*^9, 3.749405749471046*^9}, {3.749417598560644*^9, 
   3.749417600806484*^9}, {3.749417759094583*^9, 3.749417759676939*^9}, {
   3.7494177963104877`*^9, 3.7494177968685827`*^9}, {3.749417846045868*^9, 
   3.7494178463959103`*^9}, {3.749417956988673*^9, 3.749417957530727*^9}, {
   3.74941823807331*^9, 3.749418239727748*^9}, {3.749420069476613*^9, 
   3.749420070786767*^9}, {3.7494888004461203`*^9, 3.74948880161374*^9}, {
   3.7494938706074667`*^9, 3.7494938708210773`*^9}, {3.749493934877412*^9, 
   3.749494004393999*^9}, {3.749494037555311*^9, 3.7494940379646597`*^9}, {
   3.749494108313768*^9, 3.749494109193965*^9}, {3.74949417569703*^9, 
   3.7494942216745243`*^9}, {3.749494339657102*^9, 3.749494340096352*^9}, {
   3.749494391392153*^9, 3.749494393155191*^9}, {3.749494432865863*^9, 
   3.749494433369787*^9}, {3.7494945019606647`*^9, 3.749494569633884*^9}, {
   3.749494638216907*^9, 3.7494947100185013`*^9}, {3.749572413300078*^9, 
   3.749572413450897*^9}, 3.749573022762445*^9, {3.749573141167927*^9, 
   3.749573154767581*^9}, {3.749573257075927*^9, 3.749573384783545*^9}, {
   3.749573415818602*^9, 3.749573416276177*^9}, {3.7495734480314617`*^9, 
   3.7495734725565977`*^9}, {3.7495735184939127`*^9, 
   3.7495735442141314`*^9}, {3.749573589102113*^9, 3.749573620112438*^9}, {
   3.74957384124609*^9, 3.74957389094453*^9}, 3.7495765879289083`*^9, {
   3.7495773070778933`*^9, 3.7495773742400293`*^9}, {3.749577429657544*^9, 
   3.749577430004243*^9}, {3.749577460403027*^9, 3.74957758105193*^9}, {
   3.749577632856908*^9, 3.749577633067342*^9}, {3.749577693952396*^9, 
   3.74957769435466*^9}, {3.7495777496499043`*^9, 3.749577749898827*^9}, {
   3.74957779607285*^9, 3.749577796516079*^9}, {3.7495778319697857`*^9, 
   3.749577832360043*^9}, {3.749577924437262*^9, 3.749577952745022*^9}, {
   3.7495780061029453`*^9, 3.749578043529615*^9}, {3.749670831476131*^9, 
   3.749670831633275*^9}, 3.749672414521947*^9, {3.749672461405981*^9, 
   3.74967246205142*^9}, {3.7496727089867496`*^9, 3.749672709552058*^9}, {
   3.749672747665228*^9, 3.749672748231268*^9}, {3.749672788711891*^9, 
   3.7496727892226973`*^9}, {3.7496728336787567`*^9, 3.749672859965767*^9}, {
   3.749672899031726*^9, 3.7496728995490313`*^9}, {3.749673105059978*^9, 
   3.749673157200403*^9}, {3.749673371943891*^9, 3.749673381205041*^9}, {
   3.749673430230537*^9, 3.7496734307958183`*^9}, {3.7496735468056297`*^9, 
   3.749673548121986*^9}, {3.749673734648572*^9, 3.7496737351538486`*^9}, {
   3.749673864736498*^9, 3.749673865388482*^9}, {3.749673914265233*^9, 
   3.74967391483591*^9}, {3.749674047172421*^9, 3.749674047801766*^9}, {
   3.749674200647688*^9, 3.749674201189829*^9}, {3.749674262937063*^9, 
   3.749674263774036*^9}, {3.74967430477571*^9, 3.74967430537355*^9}, 
   3.749739627318062*^9, {3.749741183336965*^9, 3.749741382058854*^9}, {
   3.7497414168136168`*^9, 3.749741456497116*^9}, {3.7497423799937687`*^9, 
   3.7497423808465643`*^9}, {3.7497425406395884`*^9, 3.749742541187769*^9}, {
   3.749742634949421*^9, 3.749742635514091*^9}, {3.749742925974814*^9, 
   3.749742926515792*^9}, {3.7497431095302*^9, 3.749743110511426*^9}, {
   3.74974335594906*^9, 3.749743356409546*^9}, {3.7497520615370483`*^9, 
   3.7497520621659813`*^9}, {3.749752569954561*^9, 3.749752586844965*^9}, {
   3.749755183522184*^9, 3.749755184079652*^9}, {3.749755302299901*^9, 
   3.749755302912423*^9}, {3.7497553345321712`*^9, 3.749755335096471*^9}, {
   3.749762937776482*^9, 3.749762938244673*^9}, {3.74976503890536*^9, 
   3.7497650915972567`*^9}, {3.7497651320706577`*^9, 3.749765132604145*^9}, {
   3.7497652250200367`*^9, 3.749765225977262*^9}, {3.7497655900504513`*^9, 
   3.7497655954794397`*^9}, {3.749765626978033*^9, 3.7497656370629*^9}, {
   3.7497656762087107`*^9, 3.749765684021102*^9}, {3.749765741902421*^9, 
   3.7497658774327393`*^9}, 3.750002336719111*^9, {3.750002587039894*^9, 
   3.750002604510179*^9}, {3.75000298435542*^9, 3.750002996028563*^9}, {
   3.7500033131145687`*^9, 3.750003328105208*^9}, {3.750003367221648*^9, 
   3.7500034035634327`*^9}, {3.7500034428195057`*^9, 3.75000360718146*^9}, {
   3.750013514988936*^9, 3.750013515379595*^9}, {3.750270493089716*^9, 
   3.750270493655095*^9}, {3.750270549768897*^9, 3.7502705687104807`*^9}, {
   3.750270877915908*^9, 3.750270892464917*^9}, {3.750271014844001*^9, 
   3.7502710271509027`*^9}, {3.750271197911825*^9, 3.7502712059252872`*^9}, {
   3.750271241678815*^9, 3.750271242939868*^9}, {3.750271288973154*^9, 
   3.750271289469791*^9}, {3.750271343452558*^9, 3.7502713554500437`*^9}, {
   3.750271387557681*^9, 3.7502714306100492`*^9}, {3.750271705992536*^9, 
   3.750271706485898*^9}, {3.750271751864448*^9, 3.7502718037542686`*^9}, {
   3.750272197565227*^9, 3.750272198106786*^9}, {3.750711974687261*^9, 
   3.7507120067820044`*^9}, {3.750712048675012*^9, 3.750712170274908*^9}, {
   3.750712238217813*^9, 3.7507123883359737`*^9}, {3.750713256796566*^9, 
   3.7507132621458073`*^9}, {3.75071354906896*^9, 3.750713556764896*^9}, 
   3.75071406976302*^9, {3.750714570432954*^9, 3.75071468515414*^9}, {
   3.750714825132164*^9, 3.750714862152462*^9}, {3.750714915687784*^9, 
   3.7507149646277847`*^9}, {3.7507782522538567`*^9, 3.750778272501336*^9}, {
   3.750864472814693*^9, 3.750864509394156*^9}, {3.750867768102695*^9, 
   3.75086777645525*^9}, {3.750868113861351*^9, 3.750868114360241*^9}, {
   3.750868266006638*^9, 3.750868307384313*^9}, {3.7508685980457478`*^9, 
   3.7508685986798363`*^9}, {3.75086862937217*^9, 3.750868705783327*^9}, {
   3.7508688837781982`*^9, 3.750868950189762*^9}, {3.750869454285871*^9, 
   3.750869456647456*^9}, {3.750869666342781*^9, 3.750869688625084*^9}, {
   3.750869721179652*^9, 3.750869742238021*^9}},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[263]:=",ExpressionUUID->"22e98dc3-104b-4351-bf15-4df14113a0b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"updated2", "=", 
   RowBox[{"advanceOne", "[", "updated", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.750714049050847*^9, 3.750714100949107*^9}, {
   3.7507150961027412`*^9, 3.750715098031534*^9}, 3.750796618740033*^9},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[471]:=",ExpressionUUID->"1d092e32-fcdb-4ad0-996a-6a0ac81ac79a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"heads", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"updated", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], "//", "Flatten"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"updated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"updated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}]}], 
      "}"}], "&"}], "/@", "heads"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.750715057023924*^9, 3.750715084512083*^9}, {
  3.750800095971601*^9, 3.7508001051120358`*^9}, {3.7508005748154287`*^9, 
  3.750800596309864*^9}},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[368]:=",ExpressionUUID->"af5583f3-dc15-4fd7-993a-fbd276c22b80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bn", "=", "23"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbors", "[", 
   RowBox[{"[", "bn", "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"neighbors", "[", 
    RowBox[{"[", "bn", "]"}], "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"updated2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "-", "w"}], ";;", 
         RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"updated2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "-", "w"}], ";;", 
         RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}]}], 
     "}"}], "&"}], "[", 
   RowBox[{"heads", "[", 
    RowBox[{"[", "bn", "]"}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7494000203244467`*^9, 3.749400037952795*^9}, {
   3.749400086792404*^9, 3.749400087390299*^9}, 3.749400138094263*^9, {
   3.7494003634904957`*^9, 3.749400386274212*^9}, 3.749401630316216*^9, {
   3.749401690130478*^9, 3.749401713649968*^9}, {3.749405344759461*^9, 
   3.749405371132978*^9}, {3.749405416175166*^9, 3.749405416812467*^9}, {
   3.749405748920727*^9, 3.749405749471046*^9}, {3.749417598560644*^9, 
   3.749417600806484*^9}, {3.749417759094583*^9, 3.749417759676939*^9}, {
   3.7494177963104877`*^9, 3.7494177968685827`*^9}, {3.749417846045868*^9, 
   3.7494178463959103`*^9}, {3.749417956988673*^9, 3.749417957530727*^9}, {
   3.74941823807331*^9, 3.749418239727748*^9}, {3.749420069476613*^9, 
   3.749420070786767*^9}, {3.7494888004461203`*^9, 3.74948880161374*^9}, {
   3.7494938706074667`*^9, 3.7494938708210773`*^9}, {3.749493934877412*^9, 
   3.749494004393999*^9}, {3.749494037555311*^9, 3.7494940379646597`*^9}, {
   3.749494108313768*^9, 3.749494109193965*^9}, {3.74949417569703*^9, 
   3.7494942216745243`*^9}, {3.749494339657102*^9, 3.749494340096352*^9}, {
   3.749494391392153*^9, 3.749494393155191*^9}, {3.749494432865863*^9, 
   3.749494433369787*^9}, {3.7494945019606647`*^9, 3.749494569633884*^9}, {
   3.749494638216907*^9, 3.7494947100185013`*^9}, {3.749572413300078*^9, 
   3.749572413450897*^9}, 3.749573022762445*^9, {3.749573141167927*^9, 
   3.749573154767581*^9}, {3.749573257075927*^9, 3.749573384783545*^9}, {
   3.749573415818602*^9, 3.749573416276177*^9}, {3.7495734480314617`*^9, 
   3.7495734725565977`*^9}, {3.7495735184939127`*^9, 
   3.7495735442141314`*^9}, {3.749573589102113*^9, 3.749573620112438*^9}, {
   3.74957384124609*^9, 3.74957389094453*^9}, 3.7495765879289083`*^9, {
   3.7495773070778933`*^9, 3.7495773742400293`*^9}, {3.749577429657544*^9, 
   3.749577430004243*^9}, {3.749577460403027*^9, 3.74957758105193*^9}, {
   3.749577632856908*^9, 3.749577633067342*^9}, {3.749577693952396*^9, 
   3.74957769435466*^9}, {3.7495777496499043`*^9, 3.749577749898827*^9}, {
   3.74957779607285*^9, 3.749577796516079*^9}, {3.7495778319697857`*^9, 
   3.749577832360043*^9}, {3.749577924437262*^9, 3.749577952745022*^9}, {
   3.7495780061029453`*^9, 3.749578043529615*^9}, {3.749670831476131*^9, 
   3.749670831633275*^9}, 3.749672414521947*^9, {3.749672461405981*^9, 
   3.74967246205142*^9}, {3.7496727089867496`*^9, 3.749672709552058*^9}, {
   3.749672747665228*^9, 3.749672748231268*^9}, {3.749672788711891*^9, 
   3.7496727892226973`*^9}, {3.7496728336787567`*^9, 3.749672859965767*^9}, {
   3.749672899031726*^9, 3.7496728995490313`*^9}, {3.749673105059978*^9, 
   3.749673157200403*^9}, {3.749673371943891*^9, 3.749673381205041*^9}, {
   3.749673430230537*^9, 3.7496734307958183`*^9}, {3.7496735468056297`*^9, 
   3.749673548121986*^9}, {3.749673734648572*^9, 3.7496737351538486`*^9}, {
   3.749673864736498*^9, 3.749673865388482*^9}, {3.749673914265233*^9, 
   3.74967391483591*^9}, {3.749674047172421*^9, 3.749674047801766*^9}, {
   3.749674200647688*^9, 3.749674201189829*^9}, {3.749674262937063*^9, 
   3.749674263774036*^9}, {3.74967430477571*^9, 3.74967430537355*^9}, 
   3.749739627318062*^9, {3.749741183336965*^9, 3.749741382058854*^9}, {
   3.7497414168136168`*^9, 3.749741456497116*^9}, {3.7497423799937687`*^9, 
   3.7497423808465643`*^9}, {3.7497425406395884`*^9, 3.749742541187769*^9}, {
   3.749742634949421*^9, 3.749742635514091*^9}, {3.749742925974814*^9, 
   3.749742926515792*^9}, {3.7497431095302*^9, 3.749743110511426*^9}, {
   3.74974335594906*^9, 3.749743356409546*^9}, {3.7497520615370483`*^9, 
   3.7497520621659813`*^9}, {3.749752569954561*^9, 3.749752586844965*^9}, {
   3.749755183522184*^9, 3.749755184079652*^9}, {3.749755302299901*^9, 
   3.749755302912423*^9}, {3.7497553345321712`*^9, 3.749755335096471*^9}, {
   3.749762937776482*^9, 3.749762938244673*^9}, {3.74976503890536*^9, 
   3.7497650915972567`*^9}, {3.7497651320706577`*^9, 3.749765132604145*^9}, {
   3.7497652250200367`*^9, 3.749765225977262*^9}, {3.7497655900504513`*^9, 
   3.7497655954794397`*^9}, {3.749765626978033*^9, 3.7497656370629*^9}, {
   3.7497656762087107`*^9, 3.749765684021102*^9}, {3.749765741902421*^9, 
   3.7497658774327393`*^9}, 3.750002336719111*^9, {3.750002587039894*^9, 
   3.750002604510179*^9}, {3.75000298435542*^9, 3.750002996028563*^9}, {
   3.7500033131145687`*^9, 3.750003328105208*^9}, {3.750003367221648*^9, 
   3.7500034035634327`*^9}, {3.7500034428195057`*^9, 3.75000360718146*^9}, {
   3.750013514988936*^9, 3.750013515379595*^9}, {3.750270493089716*^9, 
   3.750270493655095*^9}, {3.750270549768897*^9, 3.7502705687104807`*^9}, {
   3.750270877915908*^9, 3.750270892464917*^9}, {3.750271014844001*^9, 
   3.7502710271509027`*^9}, {3.750271197911825*^9, 3.7502712059252872`*^9}, {
   3.750271241678815*^9, 3.750271242939868*^9}, {3.750271288973154*^9, 
   3.750271289469791*^9}, {3.750271343452558*^9, 3.7502713554500437`*^9}, {
   3.750271387557681*^9, 3.7502714306100492`*^9}, {3.750271705992536*^9, 
   3.750271706485898*^9}, {3.750271751864448*^9, 3.7502718037542686`*^9}, {
   3.750272197565227*^9, 3.750272198106786*^9}, {3.750711974687261*^9, 
   3.7507120067820044`*^9}, {3.750712048675012*^9, 3.750712170274908*^9}, {
   3.750712238217813*^9, 3.7507123883359737`*^9}, {3.750713256796566*^9, 
   3.7507132621458073`*^9}, {3.75071354906896*^9, 3.750713556764896*^9}, 
   3.75071406976302*^9, {3.750714570432954*^9, 3.75071468515414*^9}, {
   3.750714825132164*^9, 3.750714862152462*^9}, {3.750714915687784*^9, 
   3.7507149646277847`*^9}, {3.7507782522538567`*^9, 3.750778272501336*^9}, {
   3.750864472814693*^9, 3.750864509394156*^9}, {3.750867768102695*^9, 
   3.75086777645525*^9}, {3.750868113861351*^9, 3.750868114360241*^9}, {
   3.750868266006638*^9, 3.750868307384313*^9}, {3.7508685980457478`*^9, 
   3.7508685986798363`*^9}, {3.75086862937217*^9, 3.750868705783327*^9}, {
   3.7508688837781982`*^9, 3.750868950189762*^9}, {3.750869454285871*^9, 
   3.750869456647456*^9}, {3.750869666342781*^9, 3.750869688625084*^9}, {
   3.750869721179652*^9, 3.750869742238021*^9}, {3.7508700357142763`*^9, 
   3.7508700443285303`*^9}, {3.7508703295184717`*^9, 
   3.7508704306197557`*^9}, {3.750870661440935*^9, 3.7508708180972137`*^9}, {
   3.75087106838505*^9, 3.750871213896699*^9}, {3.7508786316560373`*^9, 
   3.750878712848921*^9}},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[459]:=",ExpressionUUID->"d4b0eba8-0668-42f3-85f9-0e979eb3a609"],

Cell[BoxData[
 RowBox[{
  RowBox[{"updated", "=", "updated2"}], ";"}]], "Input",
 CellChangeTimes->{{3.7507966857290077`*^9, 3.750796691800549*^9}, {
  3.7507967509112463`*^9, 3.750796752307266*^9}, {3.750802929225175*^9, 
  3.750802938581171*^9}},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[463]:=",ExpressionUUID->"38a8d8aa-eeb1-4207-8b74-75795e8defc1"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["busSimulation",
     FontWeight->"Bold"], "[", 
    RowBox[{
     StyleBox["size",
      FontSlant->"Italic"], ",", " ", 
     StyleBox["time",
      FontSlant->"Italic"]}], "]"}], TraditionalForm]],ExpressionUUID->
  "f8647d32-e58b-4828-9927-4a4904bb42ee"],
 " returns a simulation of ",
 Cell[BoxData[
  FormBox[
   StyleBox["times",
    FontSlant->"Italic"], TraditionalForm]],ExpressionUUID->
  "d01cec52-007b-4df9-b764-95965230381e"],
 " steps and size ",
 Cell[BoxData[
  FormBox[
   RowBox[{"5", 
    RowBox[{"w", "\[Cross]", 
     StyleBox["size",
      FontSlant->"Italic"], 
     StyleBox[" ",
      FontSlant->"Italic"]}]}], TraditionalForm]],ExpressionUUID->
  "d4737d0c-5895-4e29-b7a5-6e0eefa0e2d2"],
 "."
}], "Text",
 CellChangeTimes->{{3.7507034546438026`*^9, 3.750703471506812*^9}, {
  3.750703503691321*^9, 3.750703598192567*^9}, {3.75087964707157*^9, 
  3.7508796934709167`*^9}, {3.750879856803959*^9, 3.750879883689027*^9}, {
  3.750880252854711*^9, 3.750880287725559*^9}},
 Background->RGBColor[
  1, 0.5, 0.5],ExpressionUUID->"06fa6ddb-b5bd-406f-a7ce-85e5e674227b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"busSimulation", "[", 
   RowBox[{"size_", ",", "time_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"track", ",", 
      RowBox[{"t", "=", "0"}], ",", "base"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"track", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "2", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"size", " ", "5", "  ", "w"}], "+", "vmax", "-", "am"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"base", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"w", "+", "vmax", "-", "am"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"put", " ", "statios"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"stations", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"put", " ", "lights"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"lights", "[", 
       RowBox[{"1", "/", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"fill", " ", "with", " ", "test", " ", "stuff"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "ahead"}], ",", " ", 
       RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"10", ";;", "14"}], "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "ahead"}], ",", " ", 
       RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"20", ";;", "23"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "24", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "ahead"}], ",", " ", "stoped", ",", " ", "wait"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"25", ";;", "28"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "29", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"7", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "ahead"}], ",", " ", 
       RowBox[{"going", " ", "fast"}], ",", " ", "brake"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"95", ";;", "98"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "99", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
      "light", " ", "ahead", " ", "with", " ", "bus", " ", "before", " ", 
       "light"}], "*)"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"37", ";;", "40"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "41", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "station", " ", "ahead", " ", "with", " ", "bus", " ", "before", " ", 
        "station"}], ",", " ", "hold"}], "*)"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"60", ";;", "63"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "64", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{"accelerate", ",", " ", 
       RowBox[{"nothing", " ", "nearby"}]}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"100", ";;", "103"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "104", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{"light", " ", "behind"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"50", ";;", "53"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "54", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", 
       RowBox[{"all", " ", "wagons", " ", "are", " ", "idle"}], ",", " ", 
       "move"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"150", ";;", "153"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "154", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station"}], ",", " ", 
       "brake", ",", " ", 
       RowBox[{"change", " ", "status"}]}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"247", ";;", "250"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "251", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"station", " ", "ahead"}], ",", " ", "fast", ",", " ", 
       "brake"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"344", ";;", "347"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "348", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"station", " ", "ahead"}], ",", " ", "brake"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"450", ";;", "453"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "454", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"station", " ", "ahead"}], ",", " ", 
       RowBox[{"fast", " ", "brake"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"548", ";;", "551"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "552", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"station", " ", "ahead"}], ",", " ", "close", ",", " ", "slow",
        ",", " ", "accelerate"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"648", ";;", "651"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "652", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"station", " ", "ahead"}], ",", " ", "close", ",", " ", "fast",
        ",", " ", "brake"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"750", ";;", "753"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d_", ",", "0"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"d", ",", 
          RowBox[{"p", "/", "2"}]}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "754", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", 
        RowBox[{"p", "/", "2"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "unloading"}],
        ",", " ", 
       RowBox[{
       "unload", " ", "and", " ", "change", " ", "status", " ", "to", " ", 
        "load"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "850", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "100", ",", "62"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "851", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"10", ",", "100", ",", "46"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "852", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"50", ",", "100", ",", "74"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "853", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"70", ",", "100", ",", "84"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "854", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"100", ",", "100", ",", "62"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"850", ";;", "853"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"track", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d_", ",", "0"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"d", ",", 
          RowBox[{"p", "/", "2"}]}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "854", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bus", " ", "at", " ", "a", " ", "station", " ", "loading"}], 
       ",", " ", 
       RowBox[{
       "load", " ", "and", " ", "change", " ", "status", " ", "to", " ", 
        "idle"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"196", ";;", "199"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "200", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"red", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "moving"}], ",", " ", "stop"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"296", ";;", "299"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "300", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"red", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "stoped"}], ",", " ", "wait"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "400", ",", "2"}], "]"}], "]"}], "=", "0"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"396", ";;", "399"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "400", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"5", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Red", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "head", " ", "at", " ", "light"}], ",", " ", 
       RowBox[{"bus", " ", "moving", " ", "fast"}], ",", " ", "move"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"track", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "500", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
      "1"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"491", ";;", "494"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "495", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"green", " ", "light"}], ",", " ", "move"}], "*)"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"590", ";;", "593"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "594", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"red", " ", "light"}], ",", " ", "far", ",", " ", "fast", ",", 
       " ", "hold"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"694", ";;", "697"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"track", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "698", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0", ",", "0"}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"red", " ", "light"}], ",", " ", "close", ",", " ", "slow", 
       ",", "hold"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"run", " ", "the", " ", "sim"}], "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"NestList", "[", 
      RowBox[{"advanceOne", ",", "track", ",", "time"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.750879886678226*^9, 3.750879931146599*^9}, {
   3.750880194227602*^9, 3.7508802466453133`*^9}, {3.750880292820417*^9, 
   3.75088034522744*^9}, {3.7508805441847343`*^9, 3.750880632335047*^9}, {
   3.750881292069434*^9, 3.750881293882012*^9}, {3.750881443022756*^9, 
   3.7508815275254593`*^9}, {3.750942369152068*^9, 3.7509423786740627`*^9}, 
   3.7509430739033623`*^9, {3.7509559081852617`*^9, 3.750955917080933*^9}, {
   3.750958990547008*^9, 3.750958991167016*^9}, 3.7510497546901283`*^9},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[289]:=",ExpressionUUID->"869c89c0-536c-4de5-a8ff-970b9706bed8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"busSimulation", "[", 
    RowBox[{"100", ",", "100"}], "]"}]}], ";"}]], "Input",
 Background->RGBColor[
  1, 0.5, 0.5],ExpressionUUID->"390bde7c-55fb-41dc-8119-4724cc27307b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "68"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heads", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], "//", "Flatten"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"#", "-", "w"}], ";;", 
          RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}]}], 
      "}"}], "&"}], "/@", "heads"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.750715057023924*^9, 3.750715084512083*^9}, {
   3.750800095971601*^9, 3.7508001051120358`*^9}, {3.7508005748154287`*^9, 
   3.750800596309864*^9}, {3.750959670846251*^9, 3.75095973610791*^9}, {
   3.750959789006754*^9, 3.750959829410996*^9}, {3.750963560210535*^9, 
   3.7509635608987827`*^9}, {3.750963863866506*^9, 3.750963864492153*^9}, {
   3.75096426849535*^9, 3.750964269124724*^9}, {3.750966206789462*^9, 
   3.750966207330852*^9}, {3.7509663586667957`*^9, 3.750966359200547*^9}, {
   3.75097532045157*^9, 3.750975321057513*^9}, {3.7509755183280697`*^9, 
   3.75097551899753*^9}, {3.751042794197238*^9, 3.751042794459981*^9}, 
   3.751047051695168*^9, {3.751047272931038*^9, 3.751047273521187*^9}, 
   3.751049308233054*^9, {3.751050103914401*^9, 3.751050104720333*^9}, {
   3.751050147449354*^9, 3.7510501477741737`*^9}},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[209]:=",ExpressionUUID->"309f9cb3-3353-4b8c-8c98-b5af5109ada5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bn", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbors", "[", 
   RowBox[{"[", "bn", "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"neighbors", "[", 
    RowBox[{"[", "bn", "]"}], "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "-", "w"}], ";;", 
         RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "-", "w"}], ";;", 
         RowBox[{"#", "+", "vmax", "-", "am", "-", "1"}]}], "]"}], "]"}]}], 
     "}"}], "&"}], "[", 
   RowBox[{"heads", "[", 
    RowBox[{"[", "bn", "]"}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7494000203244467`*^9, 3.749400037952795*^9}, {
   3.749400086792404*^9, 3.749400087390299*^9}, 3.749400138094263*^9, {
   3.7494003634904957`*^9, 3.749400386274212*^9}, 3.749401630316216*^9, {
   3.749401690130478*^9, 3.749401713649968*^9}, {3.749405344759461*^9, 
   3.749405371132978*^9}, {3.749405416175166*^9, 3.749405416812467*^9}, {
   3.749405748920727*^9, 3.749405749471046*^9}, {3.749417598560644*^9, 
   3.749417600806484*^9}, {3.749417759094583*^9, 3.749417759676939*^9}, {
   3.7494177963104877`*^9, 3.7494177968685827`*^9}, {3.749417846045868*^9, 
   3.7494178463959103`*^9}, {3.749417956988673*^9, 3.749417957530727*^9}, {
   3.74941823807331*^9, 3.749418239727748*^9}, {3.749420069476613*^9, 
   3.749420070786767*^9}, {3.7494888004461203`*^9, 3.74948880161374*^9}, {
   3.7494938706074667`*^9, 3.7494938708210773`*^9}, {3.749493934877412*^9, 
   3.749494004393999*^9}, {3.749494037555311*^9, 3.7494940379646597`*^9}, {
   3.749494108313768*^9, 3.749494109193965*^9}, {3.74949417569703*^9, 
   3.7494942216745243`*^9}, {3.749494339657102*^9, 3.749494340096352*^9}, {
   3.749494391392153*^9, 3.749494393155191*^9}, {3.749494432865863*^9, 
   3.749494433369787*^9}, {3.7494945019606647`*^9, 3.749494569633884*^9}, {
   3.749494638216907*^9, 3.7494947100185013`*^9}, {3.749572413300078*^9, 
   3.749572413450897*^9}, 3.749573022762445*^9, {3.749573141167927*^9, 
   3.749573154767581*^9}, {3.749573257075927*^9, 3.749573384783545*^9}, {
   3.749573415818602*^9, 3.749573416276177*^9}, {3.7495734480314617`*^9, 
   3.7495734725565977`*^9}, {3.7495735184939127`*^9, 
   3.7495735442141314`*^9}, {3.749573589102113*^9, 3.749573620112438*^9}, {
   3.74957384124609*^9, 3.74957389094453*^9}, 3.7495765879289083`*^9, {
   3.7495773070778933`*^9, 3.7495773742400293`*^9}, {3.749577429657544*^9, 
   3.749577430004243*^9}, {3.749577460403027*^9, 3.74957758105193*^9}, {
   3.749577632856908*^9, 3.749577633067342*^9}, {3.749577693952396*^9, 
   3.74957769435466*^9}, {3.7495777496499043`*^9, 3.749577749898827*^9}, {
   3.74957779607285*^9, 3.749577796516079*^9}, {3.7495778319697857`*^9, 
   3.749577832360043*^9}, {3.749577924437262*^9, 3.749577952745022*^9}, {
   3.7495780061029453`*^9, 3.749578043529615*^9}, {3.749670831476131*^9, 
   3.749670831633275*^9}, 3.749672414521947*^9, {3.749672461405981*^9, 
   3.74967246205142*^9}, {3.7496727089867496`*^9, 3.749672709552058*^9}, {
   3.749672747665228*^9, 3.749672748231268*^9}, {3.749672788711891*^9, 
   3.7496727892226973`*^9}, {3.7496728336787567`*^9, 3.749672859965767*^9}, {
   3.749672899031726*^9, 3.7496728995490313`*^9}, {3.749673105059978*^9, 
   3.749673157200403*^9}, {3.749673371943891*^9, 3.749673381205041*^9}, {
   3.749673430230537*^9, 3.7496734307958183`*^9}, {3.7496735468056297`*^9, 
   3.749673548121986*^9}, {3.749673734648572*^9, 3.7496737351538486`*^9}, {
   3.749673864736498*^9, 3.749673865388482*^9}, {3.749673914265233*^9, 
   3.74967391483591*^9}, {3.749674047172421*^9, 3.749674047801766*^9}, {
   3.749674200647688*^9, 3.749674201189829*^9}, {3.749674262937063*^9, 
   3.749674263774036*^9}, {3.74967430477571*^9, 3.74967430537355*^9}, 
   3.749739627318062*^9, {3.749741183336965*^9, 3.749741382058854*^9}, {
   3.7497414168136168`*^9, 3.749741456497116*^9}, {3.7497423799937687`*^9, 
   3.7497423808465643`*^9}, {3.7497425406395884`*^9, 3.749742541187769*^9}, {
   3.749742634949421*^9, 3.749742635514091*^9}, {3.749742925974814*^9, 
   3.749742926515792*^9}, {3.7497431095302*^9, 3.749743110511426*^9}, {
   3.74974335594906*^9, 3.749743356409546*^9}, {3.7497520615370483`*^9, 
   3.7497520621659813`*^9}, {3.749752569954561*^9, 3.749752586844965*^9}, {
   3.749755183522184*^9, 3.749755184079652*^9}, {3.749755302299901*^9, 
   3.749755302912423*^9}, {3.7497553345321712`*^9, 3.749755335096471*^9}, {
   3.749762937776482*^9, 3.749762938244673*^9}, {3.74976503890536*^9, 
   3.7497650915972567`*^9}, {3.7497651320706577`*^9, 3.749765132604145*^9}, {
   3.7497652250200367`*^9, 3.749765225977262*^9}, {3.7497655900504513`*^9, 
   3.7497655954794397`*^9}, {3.749765626978033*^9, 3.7497656370629*^9}, {
   3.7497656762087107`*^9, 3.749765684021102*^9}, {3.749765741902421*^9, 
   3.7497658774327393`*^9}, 3.750002336719111*^9, {3.750002587039894*^9, 
   3.750002604510179*^9}, {3.75000298435542*^9, 3.750002996028563*^9}, {
   3.7500033131145687`*^9, 3.750003328105208*^9}, {3.750003367221648*^9, 
   3.7500034035634327`*^9}, {3.7500034428195057`*^9, 3.75000360718146*^9}, {
   3.750013514988936*^9, 3.750013515379595*^9}, {3.750270493089716*^9, 
   3.750270493655095*^9}, {3.750270549768897*^9, 3.7502705687104807`*^9}, {
   3.750270877915908*^9, 3.750270892464917*^9}, {3.750271014844001*^9, 
   3.7502710271509027`*^9}, {3.750271197911825*^9, 3.7502712059252872`*^9}, {
   3.750271241678815*^9, 3.750271242939868*^9}, {3.750271288973154*^9, 
   3.750271289469791*^9}, {3.750271343452558*^9, 3.7502713554500437`*^9}, {
   3.750271387557681*^9, 3.7502714306100492`*^9}, {3.750271705992536*^9, 
   3.750271706485898*^9}, {3.750271751864448*^9, 3.7502718037542686`*^9}, {
   3.750272197565227*^9, 3.750272198106786*^9}, {3.750711974687261*^9, 
   3.7507120067820044`*^9}, {3.750712048675012*^9, 3.750712170274908*^9}, {
   3.750712238217813*^9, 3.7507123883359737`*^9}, {3.750713256796566*^9, 
   3.7507132621458073`*^9}, {3.75071354906896*^9, 3.750713556764896*^9}, 
   3.75071406976302*^9, {3.750714570432954*^9, 3.75071468515414*^9}, {
   3.750714825132164*^9, 3.750714862152462*^9}, {3.750714915687784*^9, 
   3.7507149646277847`*^9}, {3.7507782522538567`*^9, 3.750778272501336*^9}, {
   3.750864472814693*^9, 3.750864509394156*^9}, {3.750867768102695*^9, 
   3.75086777645525*^9}, {3.750868113861351*^9, 3.750868114360241*^9}, {
   3.750868266006638*^9, 3.750868307384313*^9}, {3.7508685980457478`*^9, 
   3.7508685986798363`*^9}, {3.75086862937217*^9, 3.750868705783327*^9}, {
   3.7508688837781982`*^9, 3.750868950189762*^9}, {3.750869454285871*^9, 
   3.750869456647456*^9}, {3.750869666342781*^9, 3.750869688625084*^9}, {
   3.750869721179652*^9, 3.750869742238021*^9}, {3.7508700357142763`*^9, 
   3.7508700443285303`*^9}, {3.7508703295184717`*^9, 
   3.7508704306197557`*^9}, {3.750870661440935*^9, 3.7508708180972137`*^9}, {
   3.75087106838505*^9, 3.750871213896699*^9}, {3.7508786316560373`*^9, 
   3.750878712848921*^9}, {3.750943233122315*^9, 3.750943233849534*^9}, {
   3.750943811241147*^9, 3.750943986883243*^9}, {3.750944300856536*^9, 
   3.750944467810815*^9}, {3.75094467924249*^9, 3.750944691991269*^9}, {
   3.750944975310389*^9, 3.75094497806715*^9}, {3.750945193684024*^9, 
   3.750945208665331*^9}, {3.750959754886819*^9, 3.7509597969632673`*^9}, {
   3.750963565588133*^9, 3.750963761477161*^9}, {3.750963866998804*^9, 
   3.750963877323408*^9}, 3.75096427587934*^9, {3.750964407957642*^9, 
   3.750964457765896*^9}, {3.750964754385438*^9, 3.750964754887226*^9}, {
   3.750965499672757*^9, 3.7509656081561317`*^9}, {3.750966042577304*^9, 
   3.750966168019105*^9}, {3.7509662094545307`*^9, 3.7509663173048153`*^9}, {
   3.750966364131896*^9, 3.750966364920051*^9}, {3.750966476585679*^9, 
   3.7509664984539557`*^9}, {3.7509753349861383`*^9, 3.750975386128284*^9}, {
   3.750975433218445*^9, 3.7509755222295523`*^9}, {3.750975579296872*^9, 
   3.750975599323985*^9}, {3.751042796518291*^9, 3.751042843634667*^9}, 
   3.751047055543726*^9, {3.7510470859774303`*^9, 3.751047340395458*^9}, {
   3.7510474408092747`*^9, 3.751047441166676*^9}, {3.751049312044448*^9, 
   3.751049346698018*^9}, {3.751050108469263*^9, 3.751050165276924*^9}, {
   3.7510502684656982`*^9, 3.751050297422868*^9}, {3.751052174228422*^9, 
   3.751052175778426*^9}},
 Background->RGBColor[
  1, 0.5, 0.5],ExpressionUUID->"0876f054-88d6-4376-a48e-3fbca9dd518e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorRulesUp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[Rule]", "White"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pi_", ",", "pt_", ",", "_"}], "}"}], "\[RuleDelayed]", 
      RowBox[{"Opacity", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"pi", "+", "1"}], 
         RowBox[{"pt", "+", "1"}]], ",", "Purple"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]_", ",", "\[Phi]_"}], "}"}], ",", "t_"}], "}"}], 
      "\[RuleDelayed]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Green", ",", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}], ">", 
            "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}], 
            "\[LessEqual]", " ", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Black", ",", "True"}], "}"}]}], "}"}], "]"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.750957353615466*^9, 3.750957382987009*^9}, {
   3.7509574245019817`*^9, 3.7509574638451853`*^9}, {3.750957513102743*^9, 
   3.750957515364036*^9}, 3.750958130452462*^9, 3.750958183242405*^9, 
   3.75105209176762*^9},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[314]:=",ExpressionUUID->"4b2150d6-b459-4533-a394-8b2a7a9ef4b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorRulesDown", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[Rule]", 
      RowBox[{"GrayLevel", "[", ".8", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], "->", "Blue"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}], "->", "Blue"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.75095826705075*^9, 3.75095839339187*^9}, {
   3.750958429094742*^9, 3.7509584850718412`*^9}, {3.7509585520499477`*^9, 
   3.750958560895981*^9}, {3.751049942274742*^9, 3.751049955834237*^9}, {
   3.7510500018962803`*^9, 3.751050015564953*^9}, {3.7510500708045197`*^9, 
   3.7510500716330214`*^9}, {3.751050859183445*^9, 3.7510508723251*^9}, {
   3.751051090579206*^9, 3.7510511218157167`*^9}, 3.751052099734272*^9},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[315]:=",ExpressionUUID->"5bb59abc-f8ba-4a77-869e-91442da3477d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ArrayPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"280", ";;", "610"}], "]"}], "]"}], "/.", "colorRulesUp"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"280", ";;", "610"}], "]"}], "]"}], "/.", 
         "colorRulesDown"}]}], "}"}], ",", 
      RowBox[{"AspectRatio", "->", 
       RowBox[{"1", "/", "4"}]}]}], "]"}], "&"}], "/@", "data"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.750958844342145*^9, 3.750958857206452*^9}, {
   3.750959091158309*^9, 3.750959095848509*^9}, {3.7509594601460457`*^9, 
   3.750959464471355*^9}, 3.751049843862733*^9, {3.751050952986011*^9, 
   3.751051051574519*^9}, {3.751052128927947*^9, 3.751052133611301*^9}},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "In[316]:=",ExpressionUUID->"79b1ac0a-bda1-4998-8541-ca3f8c336a4e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i25$$ = 45, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {
    "\"min\"" :> {$CellContext`i25$$ = 1}, 
     "\"max\"" :> {$CellContext`i25$$ = 101}}, Typeset`bookmarkMode$$ = 
    "Menu", Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`i25$$], 1, ""}, 1, 101, 1}}, Typeset`size$$ = 
    Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i25$132784$$ = 0}, 
    PaneBox[
     PanelBox[
      DynamicWrapperBox[GridBox[{
         {
          ItemBox[
           ItemBox[
            TagBox[
             StyleBox[GridBox[{
                {"\<\"\"\>", 
                 AnimatorBox[Dynamic[$CellContext`i25$$], {1, 101, 1},
                  AnimationRate->Automatic,
                  AnimationRunTime->0.,
                  AnimationRunning->False,
                  AnimationTimeIndex->2.193110942840576,
                  
                  AppearanceElements->{
                   "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons",
                     "DirectionButton"},
                  AutoAction->False,
                  DisplayAllSteps->True]}
               },
               AutoDelete->False,
               
               GridBoxAlignment->{
                "Columns" -> {Right, {Left}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "ListAnimateLabel",
              StripOnInput->False],
             {"ControlArea", Top}],
            Alignment->{Automatic, Inherited},
            StripOnInput->False],
           Background->None,
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            StyleBox[
             PaneBox[
              TagBox[
               PaneSelectorBox[{1->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z0OgkAURtHnz0ZciZ2NnUsgoXYTbkJ3ZkdrR2liIxppcLQzM+D5EnOC
tyEUkFlV+129iIh599vOIpadp+Njl/XQeK59+1+fVo/k2mJ67uej67o+1R7J
ef/ruq7rv+2RnO+Pruu6XnaP5Hy/dF3XIznvR13Xdf2/eyTn+6jruu79qY+5
k+U4XO77IUmWbfOyX7O+nav6ujkU0nM/H5Lkd4fLfT8kybLNfb5w/iDJcdrv
0zVJkilzny+cP0hy3A6X+37G7x1D1GB/
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 2->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2b9LAmEYwPEnCwIJWlqiKZzaJGiJQFoayqWmoCUEcQzainBqCFxcGqo/
IIKWCARxDqIlkKKIwLNAuH6ISxBN6dEt3fMsQdydfB+QL68fQXiH9z1xMrex
kh8UkUT3tTQgMtTt4UFv3MzvijedwPt4f7mo04mMh70/OI7j+P+4qMP9g+M4
jsfbRR3uNxzH8bi7qMP5juM4HncXdTjfcRzH8XBd1OF+wnEc5/yN9v71u1Ma
fv2x1pRSSqlW56f+OJlkdnZmdPPO9LdCab850TS9frJVrhVbpu8+fpxfXDmm
e99+XYnI/lBKKdXrj7WmlFJKtQaf/6fS7s3c5bvpD7n858LYvelrpyONvcSz
6UfD1ddC6db03q+b5fV6RPaHUkqpXn+sNaWUUqo1+PxfrhUrq+Nt07e9D1RN
Xzxuzbe/XNPPpndSyeyL6SnvD5iniOwPpZRSvf5Ya/rXfgNTg1co
                  "], {{
                  0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 3->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt169KBFEYh+HPPyBYLGJWjEaxWLZZNOkdLCxGwewdeAWuTbwJmyCCzSiY
FkFELAsWo7vigOg5yowue5DnB8vD2ZcpE2aYpfbedmcqIiYHv82JiOmB3aPh
Hlufjbf1v/yv6x97JNcvpo/7/ui6ruuj6ZGc94+u67quj7JHct6/uq7//x7J
ef7puq7rZfdIzvtL13W99B7JeX7ruq7r3/dIzvvjrzo5fqvlziRJpuy9W63X
Ojk/3XlefMj2n67/bT+eOXvaPbws5P6QJNNWy51JkkxZ//tg/+Z6YeWi+ffJ
6sHy7Nb6fbYP69rcXSH3hySZtlruTJJkyvrfD7ftzsvG/FXj6+t1kmSZVsud
2dRXKZQ7qg==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 4->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2S1LQ1EAx+HjFCxGiwiC0eYHEGwWkybBIoMhWCxms7As+PIVxCgIYraJ
ojAsTrQMERaNzuEt2zlhA71Hff4wHu5+rJxw74XNVrdXa6MhhErnszwSwljH
o8PPtRZ7Dd21+77X9Zx6iK6dTS/7fHRd1/9qD9G5/+u6ruu67v1C13X3h9zO
T9d1Xde/o4foPJ91Xf/9PUTn/qbruq7/7x6i++nnI1mmxVLXJEnGbH5ZrFl6
P9jZmnk5vc7kfEiScYulrkmSjNn//j8337pbuHpL9odq7X1pspHs6ycTj3uV
52Q/Hj9/3azfJ3t9/2l6ZeM2k/MhScYtlromSTLm4P9PXOyerU1d3gz9+8E6
STJPi6WuOawfaCtOXA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 5->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt169Lg0EcwOHzR7LYBKNYBIs4VixiVZPJLJgFo4j/gbA6/wHzykCMRoNF
sA5B5TWMN5vcO7zi7oJj8L7C84XxcPvsLQfvuFs7OTs6XQghzI8+B3MhLI68
6VZT7P42jKec+F7X9dn1kJyyMb3u/dF1Xff/qeu6ruu6PpsekuP8pOvev/r3
R9d1Xdd15wdd173/uq7rut7kTtZvnNyaJMmUgx/jDGrvj+X1xlbx3JD9IUmm
jZNbkySZ8u/3g/OXp5XNh4+pn29dri8d7rxle1Xby68N2R+SZNo4uTVJkikn
z/+d+6v+8eow2y/GP7jL9v3b973hV5Htve3qAvKZ7e4fJPkfjJNbc1q/AStV
g94=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 6->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt169Kg1EYwOHjn2Sx2ATBi7BYhkUQTV7CYAgWQSwWQbBZLIJ6A2KxCBaz
IBbBIohhAxkooiuC0Tn8ynYOuqF8JzwvjIezH2Pwso2z6eracm0khDDcfiwO
hTDa9ujwa54q3YbOtHqe13Vd/20P0Wll08vej67rfl90Xdd1Xdf1v+khOu6H
up7D5/+nXvZ+dF3XdV13P+nuZe9H132/dF3XdT2vTpZvMakzSZIx698WU6+M
Lc3OjK/fJfvLyu5+Y7KR7Lcnm3sXW81k33l4P7u8rid7591vzjPZD0kybjGp
M0mSMXvv///dDzZWpx5P35J9e+G4Off6nMl+SJJxi0mdSZKM2f//h/tq7WN+
4mrg1/fXSZJ5WkzqzEH9BCnRhvU=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 7->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFKA0EUgOGnETyDnTlJDmCnjbUglt7AC3iCaCeeQRBEbDxAbpBOxCbg
BYyaaXSGsFnijOR7ED4mP9s8dmF3eHJ+eDqIiO3572ArYmfu1fhzXkc/ja+Z
/fpf13Vd/+6RnVkzvfZ+dL3lvuz5qd1r70fXdV3XdV1vq0d2vL/qm9H73p/r
7rX3o+u6rut6ez2y4/1F34ze9/5cd6+9H13Xdf1/drK+aUpnkiRzThemmY5u
nm6P3vdfin3Z9X379e7929nlcyP7IUnmTVM6kySZ8++/L7p1kmSbpimdSZLM
2f374OHi7njvcbLy9d06SbJN05TOXNUPmyh30g==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 8->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt171twkAYgOEPQpWGDZAyBE2aDAAVI0SiSRMpyjCEIVglJS1FGjpGgCCu
Sc4FP9ad8PNJ1qPzKxc+2ZL99Po+mz9ERP9wTHoRg4PLr9/Zvvw1jrP7d17X
dV3vRo/s7KrppfdH171fuq7ruq7run6bHtnxfax3o1/7fLbdS++Pruu6ruv1
9ciO7xf9Pvq1z1/bvfT+6Lqud7WT5U3TtCZJMufmZJpN8b74fBv9rL4r2R+S
ZN40TWuSJHPW9/9xm/siSbZrmqY1SZI5z/8/eJw+j4cf64uvP6+TJOs0TdOa
l7oHDQFylA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 9->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zuKwlAUgOHjawGWljZi6Q5cgJ3dtIK1K3EBzmLcgK2tYGuXJfhgbqM3
gjqSoN+B8HHzk8KLCUl/tpjOWxHRPB2TRkT75O/qPIfxtXGZ4ua8ruu6rn9C
j+wUtelV74+uu390Xdd1Xdf1b+mRHe+3uu7+0nVd13X9G3tkx/uL/hn91f/f
u3vV+6Prun7/+UlWaZqyNUmSOfd/ptlX3jfFcjg6bGuyPyTJvGnK1iRJ5qzf
98f//C6S5HtNU7YmSTLn498HP711tzPYPX39Y50kWU/TlK35rEd3X3Mo
                  
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 10->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zGKAjEYgNGs60H0JGKrnXgCwU6w9CzuBfZMdrONYCOCnSCoYKpN2HVQ
EuT9MDzCxxQTCGT6s+Vk/hlC6Fyf8UcI3ZCbwyD6tb7N7pe6ruu6rtfbQ3IO
1fTS+6Przo+u67qu67r+3x6S436o63r58/9XL70/uq7ruq67X+i68+P86Po7
dLK8cXJrkiRTNnfjNMX76Hs73J82lewPSTJtnNyaJMmU9f1/POe7SJKvNU5u
TZJkysf/D6bH3uq8+Gn9/mOdJFmncXJrtvUCISBodQ==
                  "], {{0, 0}, {
                  331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 11->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFOAkEUgOEnUnoJTkJHY0drbEioOQ+cgYN4BSsobOwoTWxE4zTwNmSJ
m5nI9xLyZfhDsZPMLjtZrObL+4gYHT+PdxHjo5v197xPT42fOZx937dHOodm
+tDXr+u6ruu32CMdz39db6FfOh+1e+390XVd13VdP+2Rjv9Puq7//x7puP/p
uq7r+pA90vH81XW9/vm/1Gvvj64Pf/7ImpbpWpMkmbn/tcy+en95nj5tH3aN
7A9JMrdM15okycz23j/+5rpIksNapmtNkmRm//eDz9fF8mP2dvXv+3WSZJuW
6VrzWr8A50wzTw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 12->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z1qAlEYhtEviZVNtqC4BhsbF5BUuoOAtevRUrIQlyI2kk7IBvxJpoi5
g8wQvZdwXpDD+CDogI7Tf5tPZk8R8Xh8vDxEdI4uF6d9jC+N8/a/ntd/9khu
X0zPfX50Xdd1/RY9knP91XU9//f/Ws99fnRd13Vd9/9C13Vd/+qRnN93Xdd1
PW+P5FyfdF3//z2S8/unl9HJ/FarOyZJMuXm22qb7H3QfR0Nn7eFnB+SZNpq
dcckSaYs7/7jbz4XSfI+Xi73+yFJlm3z+4PV+n362du1fn2zTpIs02p1x2zr
ATHTMWg=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 13->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFLQmEUh/GTBUEELS3RJE1tEbREEC4N5WJT4BKGNLZHNAcuLYHaB2hp
aQnEL+AsCdGSmgS3SByjqat0F+85DkG8r/b8QR6uPwd5h3s1mTvZz0+LSCJ8
7U2JzIQtl/oLtocrg/Vi7+P/y0Vdzxt3fT44juO4Gxd1PJ9wHJ98F3Xc/3Ac
x3H8L13U8fzFcRzH/XZRx/MLx3Hcdxd13L9xHMfH3UUd9/dxcUrdN5p1TSml
lGpt/jRa07kf5T93FosdT86HUkqp3mjWNaWUUqo1/vt/dS142Kp9mP6U6/9B
eDQ9ezv/fJF4Mf16tvJ+XGiYXrhqLWcO656cD6WU0tEdnuvvQyml1O/Gf/9f
Vs/vD5a6pp8OPlAxfffmNdX9Cky/Wz9bmUu/mR7i5sZC25PzoZRSqjeadU1/
228JBUqr
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 14->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt171Kw2AYhuHXn8nFRZwVR0dxcenmopOeQaGz4OyJ6CgeiODi1lFwKoIU
t4KLo62Ypb4REpF8LdcD5SK9CYQMCdntX5wN1iJidfo7WYlYn3pzPdtbb974
2uTH/7q+TD3STYrpXd8fXdf1Unuk8/zWdV1f9B7pPN91Xdf1xe6RzvtN13Vd
1//SI533q67reqTzfNR1Xdf/t0e65Xn/kN1bre6YJMnM0bfVRp332/u78/ed
cSH3hySZW63umCTJzObfB5dPw+39h3Hr8w+u9jZOj15r+6webr4Ucn9Ikr87
v66vhyRZts2/H577g4/jrcfW5zfrJMkyrVZ3zLZ+AhSxOJ0=
                  "], {{0, 
                  0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 15->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFLAnEYx/HHanJpliDoRbS4HI2hU5NzIIGLEC0tQtDm0iKob0BaWoJb
jDYXF9HFpeGEOChCXdq9xFv0+QcKcs/B9wfy4fwiJzfc6dl19ap8KCIH0auQ
ETmKbLf+9uWtK8vNN96n0+np6aJubqYnfX3odHp6u6jj/kan0+l0213U8fyi
0+l0+n67qOP5Q6fT6XS65S7qeH7T6XT7XdRx/6LT6XR6ujti8sZzHSMiImoG
K+MFXraYPz++HTv7z029MTmZOPvo+f6pWwud/fHj97XXD5x9efaBb+T6ICKi
bjzXMSIioubm7/999+Zd5fTzZebsD5ed8GL6beT6ICLi/64v6e+DiIi23f7/
w1vNL+Xehzt/fruOiIg2jec6xl1dAEBzhyo=
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 16->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFqwmAcxuF/a6HQpVewh+ji4gHaqb1BQRyFXqMnULfiJdy6eIaubiJd
hF6gUcySfqFEwXzS5wV5iD8CIUNC7l5GT4NORFwWv4eLiKvCyXi7db9q7Lb5
9b+u63ouPZLbZNPbvj+6rnt+6Lqu6/opeyTn/arruq4f1yM57xdd13VdP+ce
yXm/67refo/kPJ90Xdf/eyfbt1zdMUmSKZd7yy377x+z5+/uqrb/df6xfXo9
/xq+LTK5PyTJtOXqjkmSTHn674tmnSSZt9W1fT0kybxt/n1w89i7v339PPj8
Zp0kmafl6o55qD/83nX/
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 17->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17FJQ1EUx+Fj1AFSphFsXMMB7OxshTRpbBxGHcIRXMEJhBQ2dhnBJCTN
zUWNSs558P0hfJAfgZsHeY+c395dT48jYrR8XR1FnCx9elzt47I11lvsvK/r
uq4fpkd3izI9+/ro+pD7d7+v7J59fXRd13W9Yo/uPL91Xdf1v/XozvNF13Vd
14fcozvPd13X83t05/6k67r+s/snWcF22echSdZ2vnG7eXp/uJ+dvT+/Frk+
JMmvbZd9HpJkbev9//if70WSPIztss9Dkqzt/v8PbiYv49OLt19/fr9Okqxt
u+zzDN9Pe9RywA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 18->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFKA1EUhtEbdSGxs3QHLsBOXIFgJ1i6ChdgtmTrAmKZbiC1YBK0eT4i
MYP3DpwfwoF8BF4GMkPO7x5v7k8j4mTzup5FnG1cvGy3umqN3YYf7+u6ruv6
GD26G8r07Ouj65X7b7+f7J59fXRd13V9ij2683zXdV3Xj+vRneeLruu6rk+5
R3ee77qu5/fozv1J1/Wx7i9kBdtln4ckWdvll99bpvfX4fnicvVW5PqQJPfb
Lvs8JMna1vv/Mc73Ikn+j+2yz0OSrO3h/w9u1/Onj4f3P3/+sE6SrG277PNM
30/xGHUH
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 19->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z1qAlEUhuGTn424kmCTIumyBMHa9cQNuCY7ixBIEyyDaaJimuslYhI8
Z+D5QB7wRbgOjIOjyexpehMR19vX41XE7db5825vd62x3/rofV3XdV3XT/fo
bl2mZ18fXa/cT90/2T37+ui6ruv6EHt05/mu67qu/61Hd54vuq7ruj7kHt15
vuu6nt+jO79Pun65+4+sYLvs85Aka7s6+L1Ven9YvI7fN8si14ck+bPtss9D
kqxtvf8f//O9SJKXsV32eUiStT3//8HncjL9uH/59efP6yTJ2rbLPs/w/QKF
snYY
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 20->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFOAlEUhtGrULoIWQkLoJPS0JBQux4ojSWLsHQX0hk6EjYAJE4zPDSg
8i54/oSc4gvJY5JhMr3x08OkExG328/gJqIbh7bqN86muy331HVd13X9//Yo
bpWm174+up65f3f/1O61r4+u67quX2KP4jzfdV3X9Z/1KM7zRdd1Xdf/skdx
nr+6rl9/j+L8/+k5OpnH9mqfhySZ28WnzRbV+9uo/zi/e09yfUiSX9te7fOQ
JHOb7/3jd34XSfI8tlf7PCTJ3B7/fvD8+jJc33+c/P3jOkkyt+3VPs/luwFX
F2cd
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 21->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFqAkEUgOGXaGWTM0jOkCZNSGtSeQQhdc6TXCDXEouAjVhbRYM24yCs
xMxz+R7IB/4szE4xuzuevU/fBhFxu/293EQMt35+7Gb5VBq/sz76v2uP6qzT
9Evfv67ruq7r3i+y7Z+u97lHdZwPuq7run7NParj+a7rut73HtVx/uu6ruv9
7lEdzz9d13Xnb+7963sn81hO6/WQJHM733uYefN+P3p9fLhbJNkfkuRpy2m9
HpJkbvN9f/zNfZEk/8dyWq+HJJnb7t8Hk6/v59Vmefb13TpJMrfltF7P9fsD
BLkx/g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 22->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFqQkEUhtGb6BKygXSW7iCdjV2WYLB2JfaadbkACxshhelSxgQtHAdB
iZmrnB/kgB/C+Ir3eM+jyeu4ExGP28/wIaK79X3+s/VLafxuc/S9ftijuk2a
3vr66Lqu6/o1elTn+avr+v33qM79T9d1Xdev2aM6z19d1/XsPapz/9Z1Xddz
96jO80vXdT17j+rcv++lk3ks1/o8JMncLnfut2ze38Zfg6fZKsn1IUmetlzr
85Akc5vv/eNv/hdJ8n8s1/o8JMncnv9+8Dnt9deLj4t/f14nSea2XOvz3L7f
LiYzUQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 23->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1y9LQ2EYxuHHP8litil+A8FiEauatJgFs13Ez2DVKILZIojFjzIMygxj
YDN5HFrO3rMkvs/GdcO4YL+Fszecs60dnx6cLETEfPPam4tYbLy++l5/u22M
Nhx7X8/Vo7hhml77fHRd1/XZ7FGc55+u67r7b+7z03Vd16ezR3Gef7qu69l7
FOf+reu6rufuUZznl67revYexbl/z0on89he7eshSea29+PvetX7zfPt4cfq
W5LzIUlOtr3a10OSzG2+/x9/871Ikv9je7WvhySZ2/Hf/5dPFw9HK4POfjb6
wGNn37173Rl89jv7/cb5+tL+e2dv4tbm8kuS8yFJTra92tcz/X4BFgM9Ow==

                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 24->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt178LAWEcx/GvH5PFYjP5IyyW2yxM/gQlo7JZTDaLxcB/YFYWs5JFWZQM
d4tShluU0Y9YnntOsTxfen9Kr/JOnm64o1Bv1RopEUneXpWESPrmeHTf0TOV
x8LI+/T/6mJdqKa7vj50Op1O19nFOp5fdDqdrr2Lddy/6XQ6na67i3U8v+h0
Ol17F+u4f9PpdDr9v7tYx/OPTqfTuf/qvn7aO6Iezbk+DyIi6tZ/+prvZaql
Yra9je2nZn8Y5IPYvpl0BvPuIbb39ufpYuXH9se3r2dKrg8iIr7XnOvzICKi
bqO//3V1RETUrTnX50FERN1+/v9gV29cyrnl15//rCMiom7NuT7P73sFG9w/
Cg==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 25->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2TFLgkEYwPFHE1wcXcRFRzc/gODW0mQugUsI4ug3aA6cHapNGpuDIMQl
aE0MokXFQSQCwcVRS13OO0Ul7unl/4D84P3zwnHDnWK6XDuvnIhIePE5C4lE
Ft7e/Mw4byq/M9l4Tg9WF+tM1HTf+0On0+n0YHaxDvcfnU6nc/7q3j86nU6n
++liHe4vOp1O197FOpzfdDqdTqf/ZRfrcP/S6fTgd7EO519QOqIezfG9HkRE
1G1/5Xr6+Wb7vjhNjZx91/vH9rvo01e1/qJkfxARcbvm+F4PIiLqdvP7fyY7
7uZev539s1yZncY/nL30EOtdh4fOvvx98e7s9cYgWbjsKNkfRETcrjm+14OI
iLrd//+J56vHi0Tr7eD39+uIiKhbc3yv5/87B8BgRLk=
                  "], {{0, 0}, {
                  331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 26->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z9KA0EUwOHnn8rGzlIQS0uxsckBtPIIgo2NECw9iHoIL+EBUqYNoohd
jmAStBnHwAZknpvvQfhgfywMU8xmDi5vLq62ImJz9jvbiNie+fgwn49BaSxm
+uO53q8e1Zmm6a33R9d1Xdf/okd1fH91Xe9/j+o4/3Rd1/V+96iO75+u67rz
N/f+6bqu6/o69qiO/w+6rjs/1r2TeSyn9XpIkrmdfPk9k+b9/vZ6//VplGR/
SJLLLaf1ekiSue1+PxiOR3tHz+8rv398d7hzfvr2a5/Xk92XJPtDklxuOa3X
Q5LMbff7w+J6MByv/H63TpLMbTmt1/P//QTfqjah
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 27->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFOAkEUgOGnwgEsbUxsiCU3IJaGzs7WxMbGxgtwAHrgAnYewQvY2pJQ
GBMsdI8gGm2GlQAFM+D3EvIl+4dkMhuG3ZOr24vrg4jYn326exGNmaPh10w7
qfE91dx1fbd61E5VTM+9P7qu67que37Qdd35oeu6ruvb3KN2/P/qur77PWrH
+afruq7r+v/tUTuej3Td70tf7v6SJZhO7vWQJMt28uPvTLL3p6p/2p4+F7I/
JMnFppN7PSTJst38+8Xg7ub45eHjz947v389e38rZH9IkotNJ/d6SJJlu/r7
w+XR42GzNV77+6t1kmTZppN7PdvvJ7+QOIc=
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 28->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFqAkEUgOGXmIMkJxFb7SQnCNgJlp5FL+CZ0mkj2ATBLiCo4Bauq6LR
zKjfA/mQH2GcXWX246vX7tQi4nX9ar1EvMWhmdcLh4PNzPbUH6Ofuv6pe+r9
0XVd13X9+XpUjvORrvt96bqu67qeokflOD/ouu7/Q9d1Xdd1Xd/tUTnOf/r/
9L/eH7fuqffn3juZj+VJvR6SZN6OtxYzTt6bo2nj5/c7k/0hSR63PKnXQ5LM
2/yeP67zvUiSt7WYQ+9Jkqzy/OeDz8V7f9mdXPz58zpJMm/Lk3o99+8KJ14n
Lw==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 29->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFOAlEQgOFRKb2EJ6GzsaM1NiTUnkfP4EG8gpUUNnaUJjaikWZ9ullw
mUG/ScgX+EPydgLJ7tn8erY4iYjj9eviKGKy9vbmfZ6nXeNjVl8+H9qjOasy
fezrr96z99/Xs/ej67qu67r+13o0x/2fvp++6+9j7J69H13XdV3X/1+P5rg/
0vUKve//kd2z96Pruq7ruq7vt0dz3J9W6dn77+vZ+zn0TtaxO9nnIUnWdvnp
Zpbp/f5qenl3+lhkPyTJn+1O9nlIkrWt9/zxO9dFkhzXzXz3niTJlsOfD14f
5ouX86etvz+skyRr253s8xy+b5sa8fo=
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 30->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1ztqAlEUgOGTR2WTLSS4hjQ2LiCpzA4E66xHS8lCshRJE9IJ2YAPtBlv
FIPhnhu+A/Ix/gh3DggzD+PX0eQmIq7Xn6eriNu1s+lmvoZdYzvLg+9b61Gc
ZZpuP8d77f3ouq7ruq7rbfUojufbLL32/k/12vvRdV3XdV3/bz2K4/lP1/1/
dF3XdV3X9dZ6FMfzaZb7P9Vr76f1TuaxO7XPQ5LM7WLnfhbVe7/3PHi8+0iy
H5LkcbtT+zwkydzme/+4zH2RJP/W/fx0TZJkyfPfD+bvby/f95+//v15nSSZ
2+7UPk/7rgAOAvAT
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 31->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFOAkEUgOGHcgQv4EkMjYV0HkFC7XWEC3gtCkJCQyiNFWCkWQdxCGbe
Jt9LyJflD8nsLMXs/cvr8/Q2Im72n/EgYrh3PjvM+qFrfM32x/d6XY/ibPU/
9tbPT9d1Xdd1XddrehTH+TrL/Z/rrfdH13Vd13Vd71eP4jjf6nqG//+53np/
dF3XdV3X9boexclzvszeWz+/vncyj91pvR6SZG4X3x5n0bxPph+Pd2/LJPtD
kvzd7rReD0kyt/neP65zXyTJ//U4p65JkixZ/37w9L4abT7XF/++rpMkc9ud
1uvpvzsUl/Jm
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 32->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt189NAkEUwOHnn0L0xtEOKIAbdkDi2UooAI+GQizCAvZmSDhgaMDFsJd1
VNZg5m3yvWTzhf2FZNjhMHu7eJw/XEXEZXvNLiKuW59Wh9lM+8bn7L7c14f1
KM5OP7HX3j9d13Vd13VdH1OP4uQ532fvtfdP13Vd13Vd1zP1KI7zu65n+P//
1ms/H13XdV3X9XP3KE6e81f2Xnv/xt7JPPan9npIkrltjnbTVO/PL+v7/c1b
kudDkvzZ/tReD0kyt/neP87zu0iS/2s3330mSbLk8PeD9+XkbvO6/fP3h3WS
ZG77U3s94/cDkjHyuQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 33->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt18FpAkEUgOGnsQtBSCUpwJNWIAEvueRiMSYdeEkxVrBILp60hJiQuegs
ZGXDjPI9WD7Gnz0sgzDz+Pw6Xz5ExPD0TAcRo5Pvb9+zfzo3fuZ48bverUd2
jvofe+n903Vd13Vd1/Vb6pGdes73tffS+6fruq7ruq7ruvtTX9+n6/4fuq7r
uq7fU4/s1HM+qb2X3r9b72R507StSZLM2fyapined+PZYrtxziLJuk3TtiZJ
Mmd9949+vosk+b+maVuTJJmz+/1gvXqZfH4crn6/WydJ1mmatjWv9QuCtPIO

                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 34->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt18sJwkAUQNHnpxFbsAELcGcJgjvBpbVoF3bkVnBhA4IfnI1OEMUwYzgP
5DC5m0wIxBnNV7PFICL619+0FzG8ut3c5jB5Nu5zermuf9YjO6dquv3puq7r
uq7rend6ZKc7/89L33/b+9N1Xdd1Xdd1Xf9Vj+w4P+l6De//u176+ei6rut6
jT2y053vd+n7b3t//97J8qZpWpMkmXP/MM2+eB+tz8vd+FjJ8yFJ5k3TtCZJ
Mmd954/f7Isk2a5pmtYkSeYsfb5w/iDJ/zRN05rfegE21+6n
                  "], {{0, 
                  0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 35->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17uJQkEUgOHjoxErsQAzKxDB2Hi7MN3twBrswgpMTcQSfLCT6Fwvijoj
fgfkY/yje7igM5jOx7NeRHSPn1Enon/07/c02+GlcZ791ff6e3tkZ19Nt5/b
vfR+dF3XdV3Xdf2eHtnx/7qW52/rpfej67qu67qu67r+rh7ZcT/T9Rre/7Ze
ej+6ruv6d/bIjt/HWp6/rdexH7KkaZrOJEnm3PybZlO8T9bLn8VqV8l+SJJ5
0zSdSZLMWd/94znPRZJ8rWmaziRJ5ix9v3D/IMnPNE3TmY96AANj72Q=
                  
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 36->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt180JAjEQgNHxpxErsQBvliB4th6tbq/etgRXMRdNWBAxCb6B5ZH9bsOC
ZnM47Y+riFhOz24RsZ68nO9z3b4ajxnf3uv/1SM7YzO99n7sV9d1Xdd1Xdf9
P+6l197fXK+9H13XdV3XdV3X9VZ6ZMf9Tddb+P7neu396Lqu6232yI7fr2/1
3+yPrGma0pkkyZzD0zRDY50k2aZpSmeSJHPWvl+4f5Bkn6YpnUmSzFn7fuH+
QZJ9mqZ05qfeADLqBfI=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 37->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt180JAjEQgNHxpxErsQBvliB4th6tzqu3LcFVzEUTEJc1CbyB5ZH9bsOC
ZnM47Y+riFiOz24RsR69nB9z274bzxk+3uv6P3tkZ2im195P633u/U/ttfej
67qu67qut9UjO/6/9tLn3v/UXns/uq7ruq7ruq7rrfTIjvub3kef+n3N3Wvv
R9d1XW+zR3b8fn3byfqmKZ1Jksx5fZnm2lgnSbZpmtKZJMmcte8X7h8k2adp
SmeSJHPWvl+4f5Bkn6YpnfmrdyPcLRw=
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 38->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NwjAQgNHjZxEmYQA6RkCiZh6YLi1dRiAg3IAtAVFworyT0JP5OruA
2xxO++MqIpbdZ7eIWHdezve5bl+Nx7Rv3+v6nHpkpx1Nr30/c+9Dv2/fXvt+
dF3XdV3X9e96ZMf/S/0/79u3174fXdd1Xdd1Xdf1sfTIjv1N/6wP/f59e+37
0XVd16fZIzvT+X0j65umdCZJMmfzNE0zsk6SHKdpSmeSJHPW3i/sHyQ5TdOU
ziRJ5qy9X9g/SHKapimd+as38ActHA==
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 39->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17sJAkEQgOHx0YiVWICZJQjG1qPVmZpdCZ7iJrqL4IPZg2/g+Nj7sz0D
Z7U7bPeLiJiPz2YWsRw9HW9zWT8b9xle3uu6Pp0e1Rm66dn3o/v96Lqu67qu
6/4/6n30f3//b3v2/ei6ruu6ruu6rvfSozr2t1/17Pt717PvR9d1XdczOplv
mdaZJMma54dlzp11kmSflmmdSZKsmb1f2D9IcpqWaZ1JkqyZvV/YP0hympZp
nfmpV4uJbmI=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 40->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NwjAQgNHjZxEmYQA6RkCiZh6YLi1dRiAg3IAtIVBkG72T0JP5miRQ
5DaH0/64iojl9NktItaTl/N9rttX4zHj2/e6ruut9MjO2Eyv/Xx0/x9d13Vd
13Xd+6PeRp/79/+1134+uq7ruq7ruq7rn/bIzv/sV7Wvf+7703Vd1/UeO1nf
NKUzSZI5h6dphsY6SbJN05TOJEnmrL1f2D9Isk/TlM4kSeasvV/YP0iyT9OU
zvzWG7LUbmI=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 41->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z1OAkEYgOHxp7KxpiTewMTGxtgCFZW1CTW9MZ6BFi9gbWNiuAyxMIGC
UFOxEKaRmUYDMybPl2zezD5bzW6x034c9gdnIYTT5uqehHDe9HW8mdndz4bt
LPfuc845P46H5Cyr8dL7w30/nHPOOefc/yOvww/9/v/qpfeHc84555xzXo+H
5NRzfqndS78/zjnnvISrlm+c3FpVVTXV6a5xppW5qqrW2Ti5taqqaqqlzxfO
H6qq/7NxcmtVVdVU9///R5OXj4fWIutP2wc+s955+75frGZZf79+vrrozbPe
4O3N5Vcl+6OqqunGya31t10D0v57Hg==
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 42->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z0SwUAYgOH1cwQXcBKdRucImVE7DydyBpVWp1QKYxt2i4jY4PlmMs9s
3skMmyY7rdbL1SiEMKyvxSCEce12c53j7NFwm9PTfV3XdV1/Rw/JOfWml96f
b+9dv5+2vfT+6Lqu67qu65/tITm+T3+ld/1+2vbS+6Pruq7ruq7r+v+cH0r/
/q7/n67ruq6X6GR54+TWJEmmPNyNc+hZJ0n20zi5NUmSKUufL5w/SPI7jZNb
kySZsvn5YF+tzvPJ7uXnm3WSZD+Nk1vzVS8RPnEt
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 43->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17sNwjAUQFHzWYKSSRiAjooaiZoN2AMGoULswAZp6TICAeEGHEVJY0ec
J0VH5ipFXoWXu8NmPwshTJtnPQlh3ng+veax+ja8p/75Xdd1Xdf17h6SUxfT
c+/HfnVd13Vd13Xd/+Ox9Nz76+q596Pruq7ruq7r/9RDctwPSvn+rp57P7qu
6/o4O5nfOG1nkiRTVh/jVIV1kmSZxmk7kySZMvf9wv2DJMdpnLYzSZIp+98P
rsfLdnG7D36/XydJlmmctjOH+gTID3Fi
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 44->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z0OAVEYhtHPT6WxBovQaCyAyhIkaondsDGtVjdLMMQ03ImQcC/Om8jJ
eCKZmcodLdeLVS8iuvVn1ono1+625x2nt8Zl1d33uq7ruq6X3yO5qpju+XRd
13Vd13X9d3ok9zv/z3Pf/7ufT9d1Xdd1Xdf1cnok5/zxqZ77/T7qud+Pruv6
v3Yyv83arkmSTHm42uxQWCdJlmmztmuSJFPmPl84f5Dkd3u73PdDkizb588H
g/lkPNzsX/79c50kWabN2q75qicOBG+P
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 45->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170JwkAYgOHzbwBLSxvXcAA7O1vB2nl0GDcR0tplBKN4jV7ApLmLPh+E
h8uLEJIQvOX+uD1MQgjj5tiMQpg2nk+Pua3fDc+pP87ruq7ruv77PSSn1r/s
uZ+fruu6ruu6rg+ph+SU8/++9J77+em6ruu6ruu6/j/7o9z3R/d+6bqu5/t+
kjmN07YmSTJl9TJOVVgnSZZpnLY1SZIpc+8v7D9Icti+T+7rIUmWbff9wW5x
mc9W196/79ZJkmUap23Nvt4BGpBvuw==
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 46->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2bFLAlEcwPFfFgQRtLS11NjW0hKBW0stRZtLHIhLILRES1ND4NLSUP0F
QVsQRHMQLcKhFBF4RxAcFQgRtASpdIv3fiVe8l72/YF8eX7A03cidzjlFVfy
gyKSaTwWB0SGGj08aE6Uba+0pp54HsdxHMfx/ncxTh3v0G2fPxzHcRzHcRz/
Sy7Gcef63nW3ff5wHMdxHMdxHHfHxTjcv+D/w9N+P3vttvcHx/G0vy+U2mw8
2ppSSik1NfhqPEF2ZGludmzjRvXnQmk/nAhV94+39i62H1XfuX87vbwOVG8d
vXzmyP5QSik1Nx5tTSmllJqavP6fnokq81cvqt95+feF8VvVcyejtd3Mg+pH
w+dPhVJV9ebdzfKa78j+UEop/b7tY/v9UEopdbvJ6/+ffPV1cvNjXf//I+3r
/+7no5RS2pvGo61pt/0E96GO6g==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 47->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z1KxEAYgOHxBwQbO2vF0lJsbLaz0UpvsLBYCtbewBPoduIl7ASxthS7
RRQRmwUbwcZdcZp1RklEMobng/AweQkkgUBmubu/05sJIUyPjq2pEGZHnhyP
56kzafiY4Zfzuq7ruq63v4fkDIvpnk/XdV3XdV3X29NDctrzf970/f/18+m6
ruu6ruu6rscekmP/o+u+L13/351s3ji5NUmSKQefxhl0Ti/Odl+WHrP9p+t/
2/tz5897R1eFvB+SZNo4uTVJkimr7w8Obq4XVy/r70/WDlfmtzcesn1c1xfu
Cnk/JMnvnZym74ckWbbV9w9vt93e6+Z97eurdZJkmcbJrVnXd0pGffI=
                  
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 48->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt10FKQlEUgOGjuQ7RlUTDaJY7EJw4adIG2kU1jKBZa3AHbsGBKDVQoQ1k
0Z3Yfcpzcu/gOyAf1x/heUDwDsd3t5OLiOjuXzediN7e56ef+bg8NH5n9+99
Xdd1Xdf1Uz2ys6um28/xXno/uq7ruq7rut6mR3b8v67l+5/qpfej67qu67qu
67qeemTH/UnX/f7K70cv28nypmk6kySZc/FnmkXx/ng/7S/f55XshySZN03T
mSTJnKXuF9vG/nD9trrafFayH5LkcQ+n9POQJOu2/f3hZfY6+hqsz/58u06S
rNM0TWee6zfrHXtv
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 49->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFqAlEQgOGJ5iLpLL2BpI1djhBInZPkAMkFPIytB7AStglbp4qRpHku
MYo4I3wD8oE/wnNgYd/d08vj8zgiRtvP/Cbiduv72/d0s9bYTb/3va7ruq7r
enaPwenL9Oz92H/t/em6ruu6ruvX1WNwvP9eqmfv91DP3o+u67qu67qu6/p/
ewyO+5Wue/7y91O9k3VsJ/s8JMnarn/8nXV6X/avk2m3KrIfkuTftpN9HpJk
bevdP87zv0iSl7Gd7POQJGt7/P3gYbG5//jsTv79cZ0kWdt2ss9z/X4BZcV1
yA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 50->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17kJAkEYgNHxaMTM0A7EVDNLEIytxAK0ARsyMdtIEEQ0NfJAk1HE9ZoR
3g/yYD8WZocVdhqDUX9YCyFUj79eJYT60enkNKt2bDjP9ua6ruu6rut66h7u
zjabnnp/dO+Xruu6ruu67vtQ/4/+7ffj3Z56f3Rd13Vd13Vd15/t4e44X+m6
/9+nno/MwXhSr4ckmbfFxesUyXt3tuxs9otM9ock+dh4Uq+HJJm3+Z0/PvNc
JMnfGE/q9ZAk87b8+WA3brZW8/XL95frJMm8jSf1ev7fA1oeddo=
                  "], {{
                  0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 51->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z2KwkAYgOFP19IzCJ7EA2xnu9gs2NjYeJh1zyCew1ushY2VHkEF08Qo
/s+4Ph+Ep3gJTIYEMu3vYbf/ERH17fVZi2jEsVl3Cn/Hu1keqOu6ruu6/qo9
KmedTU+9P/r/7re+n4/uqfdH13Vd13X93j0qx/+X/h791vfz0T31/ui6ruu6
ruu6rp/bo3Kcr3T9ed8fmYPlSb0ekmTezvcWM0/eZ73O16T5l8n+kCRPW57U
6yFJ5m1+54/7PBdJ8jmWJ/V6SJJ5e/n54Gc0aC2mq6vvv6yTJPO2PKnX8/pu
AF59qCU=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 52->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt100KQVEYx+HXx8jEGmQNJiYWwMgSlLH1sDqZmVmCS0yOm1I4763nX3rK
b3KoW/dMNrv1dhAR/eaz7EUMGw/7286L0rjv8vL9pz1ad0nTf/37dV3XdV3X
yx6t836k654vXdd1Xdf17/donfcjXfd86bqu67qu67qu5+nROvcrPUcn81iu
9nlIkrk9PnzuWL1PR6v5bHxK8v+QJN9brvZ5SJK5zXf/+M7vIkn+x3K1z0OS
zG3t+4X7B0l223K1z9N9r/Isb0s=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 53->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zsKwkAUQNHnZwluwJXY2di5BMXa7airs7Cxs7T0gxaOg5X4xnAehAO5
zWRCIDNerOerQUT0r9esFzG8utve5jgpjfuc3u7rrz2qc2qmZ++Pruu6ruvd
61Ed/z+67vvL3x9d13Vd17vXozr+f3Td95e/P7qu67qu67qud6dHdZx/9Np7
IjMtJ3s9JMm23T98zj69L1fn6WhzaGR/SJKfLSd7PSTJtm3v/PGd5yJJ/sZy
stdDkmzb7POF8wdJ/rflZK/n/70AlMJxCA==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 54->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z2KAkEQgNHy5yB6Eg9gpjdYMPY8aygexKOYiZngBdRlTdpBERarXF7B
8GC+pKfpYHr8tZwtBhHRvzzTXsTw4ur7OodJa/zM8e69XqtH5xzL9Oz90XVd
13Vdf7VH5/i/0vUK5/9Zz94fXdd1Xdf1V3t0jv8rXa9w/p/17P3RdV3XdV3X
db1Oj85xf/kvnaxjO9nrIUnWdvfrbXbpfb3dzE+jfZH9IUk+tp3s9ZAka1vv
/vE330WSfI/tZK+HJFnb7PuF+wdJfrbtZK/n8z0DvV5xxQ==
                  "], {{0, 
                  0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 55->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NgkAYgOHzZwsrJ3EAK53AmFg7j27gOk5A7OwcQU2kQYwmCN9Bni8h
b/E0x0FxN9/u17tJSmn8eJajlKbp09wWZY+H51zfyofh375/tEfvD+ecc875
0DzVjvMf78ab/h9te/T+cM4555wPzVPtOP/xbrzp/9G2R+8P55xzzjnn3P2D
/+aq+bQ60etRVdW8W7xaThHul9lqcz45Z6mq9qPViV6Pqqrm3fzuH/95L1VV
7abViV6Pqqrm3ej7hfuHqmq/W53o9fS/d9SjZHY=
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 56->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt189pAlEQwOGJ2ogt2IAFeLOEQG5CjqlFu7Ajr4IHGwj4B3N5WVwDxpmF
b2D5wX6Xt3PaN33/XH6MI2J0fhZvEZNzN+vL7Odt4zrHX+//6tE5xzL+399f
3bP33+fZ++Gcc84558Py6Bz/t1U8e/99nr0fzjnnnHM+LI/O8X9bxbP33+fZ
++Gcc84555y7f/DHXLVO28k+j6qq1u7u1p/Zpfv063u1nR2K7EdVVe+3nezz
qKpq7da7fzznu1RV9TVtJ/s8qqpau9n3C/cPVdVht53s8wy/J6uBL/w=
                  
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 57->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17uJQlEQgOHx0chWYgFmViCCsfF2sal2YA12YQWmJmIJustucrz4gMWZ
C9+AfOCfnDPRPR+L1Ww5iojh9TcdRIyvbtbfc5y0xs+cb/7vW4/OOZfp9nO/
Z+9H13Vd13Vd11/p0Tm+r6vc/1HP3o+u67qu67quv9Kjc3xfV7n/o569H13X
dV3XdV3XvT/05zpZx3ayz0OSrO3h1785pPf5fvv5tTsV2Q9J8r7tZJ+HJFnb
eu+P/7kXSfI9tpN9HpJkbbPfF94fJNlv28k+T/+9AD+AMLk=
                  "], {{0, 
                  0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 58->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NwkAMgFHzswiTMAAdIyBRMw9MlzZdRiAgaI4UUNknnqXok/KaU66J
d6fL8byJiPX8HFYR27m362PGfdt4zvTxnv/msTgT/9Kz749zzjnnnPOePBan
zv99dc++P84555xzznvyWJw6//fVPfv+OOecc8455/+zH2V/n95dtU7byT6P
qqrW7vDqe4ZirqqqtdtO9nlUVbV2s/cL+4eqat9tJ/s8qqpau9n7hf1DVbXv
tpN9nv57B3P0LRw=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 59->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NwkAMgFHzswiTMAAdIyBRMw9Ml5aOEQCJNOECdPaJZyl6ir7mlGvi
zeG0P64iYvl4douIdczNbTt6OT/n+qb+W//2ffXPPfv+dF3XdV3Xdb2nHs2p
839fvWffn67ruq7ruq731KM5df7vq/fs+9N1Xdd1Xdd1/X/2o+zv03sn6zid
7POQJGs7vBxnKNZJkrWdTvZ5SJK1zd4v7B8k2afjzL2TJNkye7+wf5Bk304n
+zz9ewdsxSAO
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 60->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z0OgkAQgNHx5yKexAPYeQQTa8+jp6O18wiikWZdEy3IDvgmIS/wNUto
mM3htD+uImLZX7tFxLr3cn7MdVsaz7m9Pf+1R3Vuafq/v3/2Pvb30XVd13Vd
1/U59ahOnv/77L3199N1Xdd1Xdf1KfWoznz+71uff+z303Vd13Vd13XdfqR/
18k8ltP6PCTJ3HYvh+mSdZJkbstpfR6SZG5b7xf2D5KcpsN8uidJsmbr/cL+
QZLTtpzW55m+d5aA68c=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 61->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17sNwjAUhtHLYxEmYQA6RkCiZh6YLi1dRiAg0hgjSl+H80voCL4mAYp4
d7ocz5uIWE+vwypiO3m7Pnffl8Zr48fn2XpUN+oL6a3/X7qu67qu67reU4/q
8jzfZ++tfz9d13Vd13Vd/6ce1TkfZLn/X73196Pruq7ruq7rmXpU5/l9KZ3M
Y7nW10OSzO3wdt6QrJMkc1uu9fWQJHPb+nzh/EGSfTrv23uSJGu2Pl84f5Bk
35ZrfT39+wAJluvH
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 62->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NwjAQgNHjZxEmYQA6RkCiZh6YLi1dRiAg0hgjGqSzo3cSeoKvMUmK
3O50OZ43EbGePodVxHbydn3OfV8arxk/fm+tR3VGfSE9+/nSdV3XdV3X9Z56
VKed9/vWe/b903Vd13Vd13Xd/vSv/5fds6/fr559fXRd13Vd1/Vl9aiO99+l
dLIdy8k+D0mybYe38wyNdZJk25aTfR6SZNtm7xf2D5Ls03m+fSdJsmb2fmH/
IMm+LSf7PP37AKXV68c=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 63->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170JwlAUhuHjzyJO4gB2jiBYO49Ol9bOEVQwTUywEDnnmucDeZC3uUSL
3M3htD+uImL5+OwWEeuY2m3bezk/d32zSv90fr3tnv3/0nVd13Vd1/WWeoyu
zvt99Z79++m6ruu6ruu6Pp8eo3M/aqX/+vl/27Ofj67ruq7r+tx6jM774b90
so7DZZ+HJFnb7mW/rlgnSdZ2uOzzkCRrm32/cP8gyTbtN/WdJMkxs+8X7h8k
2bbDZZ+nfe9tpN65
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 64->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zsKwkAQgOHxcRFP4gHsPIJg7Xn0dGntPIIKbqHuIvjIJPINhI/lb0K2
ySw2u/V2FhHTy7OaRMyjNaflvXn9sL/O8cmhvJ/+2/7q/nVd13Vd13Vdtx99
q2ffn67ruq7ruq7rel89qmM/0/u530979vfRdV3XdV1/7FEd/0//0sl8y7TO
JEnW7G6W6QbWSZLDtEzrTJJkzez9wv5BkuO0TOtMkmTN7P3C/kGS47RM68x3
PQNyVqqB
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 65->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zsKwkAUQNHnZyOuxAXYuQTB2vXo6tLaZQlGyTRhgsEQxgnngRyG25hP
kXe43M7XXURsu99pE7HvfNzf8zwOjc+0vcNp9ZX0b8+/9vdj7vXpuq7ruq7r
ek09srOe7/PS/3/p69N1Xdd1Xdd1Xden9ciO/VCf1pd+/nN76fuj67qu67rv
k2EvfX9Kd7K8acbOJEnmbHrTNH/WSZL/aZqxM0mSOUvvF/YPkqzTNGNnkiRz
lt4v7B8kWadpxs781Req46qB
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 66->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z0OgkAQgNHx5yKexAPYeQQTa8+jp7O14wiiYRuyGwhoFpI3CXnZfBVD
wx4ut/N1FxHb9jltIvatj/tnXse+8Z2msz+NPrIP7Xft+5/7fvaj67qu67qu
68vpkR3/10t5/6Feez+6ruu6ruu6ruv6b3pkx/1TH9f//f3n9tr70XVd13Xd
/8O0/ZA1TVM6kySZ89mZ5rmwTpJcpmlKZ5Ikc9a+X7h/kOQ6TVM6kySZs/b9
wv2DJNdpmtKZU30Df76qgQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 67->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z0OgkAQgNHx5yKexAPYeQQTa8+jp6O14wiiYRuyBKPoQniTkJfN1+hY
yO5Ol+N5ExHr5jmsIraNt+tz7vuu8Zq6tTv1ZPrQ51/697OfaffS+xvqpfej
67qu67quL6tHdrwfj9VL72+ol96Pruu6ruu6ruu6/p8e2XE/1d/rv/79v+2l
96Pruq7rS+yRnbH//8mSpuk7kySZs2pNU02skySnaZq+M0mSOUvfL9w/SHKe
puk7kySZs/T9wv2DJOdpmr4zP/UBFx/EnQ==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 68->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt180JAjEQgNHxpxErsQBvliB4th6tbq/eLEEFczJBMazJLm9AHuGDhZ29
mM3htD+uImL5+O0WEesozW2bvJyfc33z2/7p+a177fvZj/203E/vfez91/bW
+9F1Xdd1Xdf76pEd/1+n0sfef21vvR9d13Vd13Vd13X9Pz2y4346lz7296nt
rfej67qu63PsZHvTlM4kSeYcXqYZOuskyT5NUzqTJJmz9f3C/YMkp2ma0pkk
yZyt7xfuHyQ5TdOUzvzVO1zK3rk=
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 69->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NwjAQgFHzswiTMAAdIyBRMw9MR0vHCICEC4QdREJyiXgnRU/WV+XS
xKvdYbtfpJTm92czS2mZanNdv9q+n46Pubw5VO/7/bp2+2nu9tPco/fz773v
79u1R+9H13Vd13Vd/66n4vi/1If5vl179H50Xdd1Xdd1Xdf1YXoqjvvpr3r0
/j716P3ouq7rekQn481TO5MkWfL8NM95ZJ0kOU7z1M4kSZaMvl+4f5DkNM1T
O5MkWTL6fuH+QZLTNE/tzLbeALgBxJ0=
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 70->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17sNwjAUQNHHZxEmYQA6RkCiZh6YLi1dRiB8XBBsCRFFTtB5EjoytyEP
Crw5nPbHVUQsu9duEbHuvJzvc932jce0H+/3e2SnnUwf+nz2Yz8192O/ut9P
udfej67ruq7ruv7eIzv+P+rf9bG//6G99n50Xdd1Xdd1Xdf1Z4/s/M/9sfbn
H/v5dF3XdX2OnaxvmtKZJMmczcs0zcQ6SXKapimdSZLMWft+4f5BkvM0TelM
kmTO2vcL9w+SnKdpSmf+6g2aoaqB
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 71->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NwjAQgFHzswiTMAAdIyBRMw9Ml5YuIxAQbsBOQRTOkd5J0ZPzdRcK
vDtdjudNSmk9PIdVStvB2/U59/2n6TX91/vWeipO30y3n/FuP+M9ej+t97n3
P7VH70f3+9F1Xdd1Xdf9f9Tb6HN//6k9ej+6ruu6ruu6ruv/6qk47dzPWu/R
30/XdV3XIzoZb57amSTJkt3bPF1jnSTZpnlqZ5IkS0bfL9w/SHKZ5qmdSZIs
GX2/cP8gyWWap3bmrz4AXjqqgQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 72->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFLgkEYwPGznFqaG8NvILS0RGs2OTULze4RfYbW+gLNLUL4ZaQh0EGc
m3yVbijvHBK5i34PyJ/z5/Scw/ueDob928MQwkHz6bVCaDd9flrN9OJnw3oW
G9/z7x6Ss6jG7We72892L72f/+77vt9dvfR+uP8P55xzzjn3/Mjr8H3f/65e
ej+cc84555zzejwkp573l9q99P1xzjnnJVy1fOPkzqqqqqlOvhpnUpmrqmqd
jZM7q6qqplr6/cL7h6rq32yc3FlVVTXVzef/x/HD6OZknvW79Q/esn718nE5
/5xm/bV73zm6nmW9wfOz4/dK9qOqqunGyZ31t10CGrK3PQ==
                  "], {{0, 
                  0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 73->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zsOQUEUgOHxWIINWIlOo7MEidp6WJE1qG6rUyo9YhpmJNxcM/hOIl/G
HwmHwowXq/lyEELonx+zXgjDs5v1ZfaTe8N1Dg/P63X1kJxDNd1+nvfS+7Ff
3e8n30vv59t7199P2156P7qu67qu6/pne0iO/6e/0rv+ftr20vvRdV3XdV3X
df1/7g+l33/Xn0/XdV3XS3SyvHFyZ5IkUzY34zSVdZJkncbJnUmSTFn6fuH+
QZLfaZzcmSTJlK/fD3aL5XE62r79+tc6SbJO4+TOfNcTmhGtTA==
                  "], {{
                  0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 74->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17FtAjEUgOEHYYmUTMIA6VJRR6LOBtkDBqFC2SEb0KZjBCCKpSixOXEQ
2af7noQ++X5R8ERxnr+8Pq8eImJ6+jxNImYnN+vzfC5+G19z+PNc13/2yM6h
mW4/l3vt/bTe/3v/t/ba+9H9f+y33GvvR9d1Xdd1XR9Xj+x4P75Xr72/rl57
P7qu67qu67o+ph7ZcT9o5fd39dr70XVd14fZyfqmKZ1Jksy5/zbNvrFOkmzT
NKUzSZI5a98v3D9IcpimKZ1Jksx5/f1g97ZdPr5/9P7+dZ0k2aZpSmf29Qi7
V62B
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 75->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17FtwkAUgOEXkioNMzAEDU0GIBUjIKVGyjZkMVradB4hJso1cE5kLOfO
8D3J+nT+hWSfG26x3W3eHiNi1l7rh4in1o/9aT5fzo3vaS7u63pNPbLTVNPt
z++99P7cex/7+w7tpfdn6n3s7zO0ez9d13Vd13Vdv50e2bmd/+eln3/s99N1
Xdd1Xdd1vZ4e2XH++K9een//6qX3R9d1/V47Wd40XWuSJHMef0xzrKyTJOs0
TdeaJMmcpc8Xzh8kOW3Pp/TzkCTrtv/54Pl1tZy/H67+fb9OkqzTNF1rXusX
a7Krrg==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 76->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170JwkAYgOHzbwBLSxvXcAA7O1vB2nl0GDcR0tplBKMYhJgUSfNd8Pkg
PJwvglxC8NbH8/40SylNq2s3SWleeb285rFtmt5T/nyu6/q3p9Yps+nR+2N/
dc9Pd4/en7HvX+49+v7puq7ruq7r+ph6ap18/t/n3qPvn67ruq7ruq7r/3M+
it4f3fOl67oe9/4kI62na02SZJvFx3qKzDpJMk/r6VqTJNlm9PnC+YMkx21z
on8PSTJv+58PDqvbcrG5D/5+v06SzNN6utYc6hM1I6va
                  "], {{0, 0}, {
                  331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 77->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt2aFLA2EYgPHXKQgiWGwWjTaLZQhrFi2KzSKDsSIIFlkxGYQVi0H9CwSb
IIhZEIswFEUEbwjCUGEggkVwG17Zfa+Cn8f3Hj4vjIfbD7bbd8e448aKK/Ol
XhHJtV4zPSJ9re7utKdR6K50ppl4H8dxOy7OaZrx0Otj3dNef18PvT5Z97SP
j69nff+te+jzD8dxHMdxHMez5OIcO9f31j308cNxHMdxHMdx3I6Lc7h/wf+H
+56faXvo9cFx3Pf/hdKQjUfbppRSSl2NvhpPVBiYzU8OrV6r/lyubtdH6qrX
9itbJ+uPqm/cvR2enkeqd7794sjI+lBKKXU3Hm2bUkopdTV5/T8+0bicOntR
/bZYep8evlF98WDwfjP3oPpe//FTuXqlevvuZm6pZmR9KKWUft/uCb0/lFJK
bTd5/f+TL7yOrn0s688/fD//b38fpZTSdBqPtk1/2098qcsJ
                  "], {{0, 
                  0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 78->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z1KA0EYgOHxBwSbdNaKpaXY2KSz0UpvEAiWgrU38ARqJ14inSDWlmIX
RBGxCdgINibiNHFG2Q1xN/H5IDxMXhZ2JwlkVloHu+25EMJs/7U9E8J839OT
wTw3hw2f0/v2vq7reuwhOb3a9Kr357/3cX++o3b7M9l92ve/6u+nruu6ruu6
rv9lD8mZnv/nVd//uJ9P13Vd13Vd13U99pAc5x9d9/vS9cnuZPXGya1JkkzZ
/TJOt3l+ebH3uvyU7b9dP2o/W+i87B9f12R/SJJp4+TWJEmmLH4+OLy9WVq7
Kn8+WT9aXdzZfMz2Qd1o3Ndkf0iSPzs8Vd8PSbLeFj8/vN+12m9bD6WvL9ZJ
kvU0Tm7Nsn4Avf26EQ==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 79->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z1KA1EUgNHrzzpEVyIpxU53IKSxsXED7iJaimDnGtyBW0ghSiw04AaM
4mvim8gE5D6HcyEcXj4Ck5sEMnsnZ0fjrYjYXDwONyK2F15dfs5sf9n4mvmP
53Vd14fSozrzZnr2fv57/+vPZ+h96Pv3/Vzds/ej67qu67qu6316VMf/61be
/289ez+6ruu6ruu6ruulR3XcP+m631/+fvTcTuZbputMkmTN6bdlpul9cn66
83j30Mh+SJJ1y3SdSZKsmXV/8dbZLw5un0avL43shyS52uXJvh6SZNv2v3+4
vr85ft99Xvv1/TpJsk3LdJ25rh/7IreO
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 80->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFKA1EQgOGJehE7y9xAbE3nEQLWOYkH0At4GFsPkErYJmxtZRJi87IY
EyQzK99A+GB/Au8NBLLX88XD42VEXKw/s0nE1dqX5810t62xnX7vua7ruj6O
HoPTl+nu737uP96evd9DPXs/uq7ruq7r+v/qMTj+/56rZ+/3UM/ej67ruq7r
uq7r+m97DI73K133+8vfT/VO1rGd7POQJGu73Pk9y/T+1j/dTLv3IvshSf5s
O9nnIUnWtt77x9/ciyR5HtvJPg9JsrbHvx/cv37crT67k79/XCdJ1rad7POM
3y/o0bHn
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 81->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFOAkEUgOEnehE6Sm9gaKHjCCbWnMQDyAW8EI0dlckmxmBrJRBsho1x
dWUe+L2EfAl/SGYmuwkzvJ3P7i4jYrD5TC8irjYuHrbT3JTGbtYH3+u6ruv6
tkfrrNN0+zvv/Wfvtd9P/byf/9rno+u6ruu6/t96tI7/h3o//a+fj9/22uej
67qu67qu67r+3R6t436l696/vvZHZrCc2ushSeZ2tfdzVtX75PF5/Pr+lOR8
SJJfW07t9ZAkc5vv/tHPvkiSx7Gc2ushSea2+/3g7X503Sxffvz7bp0kmdty
aq/n9P0AJwix+Q==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 82->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z1qAlEUgNHrT5k1CK7EBdjZhjSBNGlsXEx0DeI6sotYpEkVlxCF2IwT
UUd9N3ouDKf4GHjzmIF5/efx6KUTEe31NWxFdOOvWQ22zqab+dpR13Vd15v0
qJ1Vmn7vz5+93/r+l/4+9dvuTd/PS/fS+6Pruq7run7uHrXj/0u/j970/bx0
L70/uq7ruq7ruq7rh/aoHecrXb/e90dmsDql10OSzO3y1+0si/f3p8Hj/OEj
yf6QJPdbndLrIUnmNt/54zzPRZK8jtUpvR6SZG6PPx+8TV57n4vvk+8/rpMk
c1ud0uv5//4A+X/kRA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 83->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1zFuwkAQQNEhoUqTMyDOkIYmB0gqjhApNechp7Po6DgCBJFmYxmQSGaM
3kjoSf7NemXL7Oxjtfx8jIiHw+9tEjE9+LX+nu1raxxn9+v6tT16Z1em//X9
67qu6zk9eqfO96d6v/f993wO9+z90XXvl67ruq7ruv9Huj6Gfu75zu7Z+6Pr
uq7ruq7run5pj95xvtJrdLKO7WSvhyRZ2+7kz3Tpff70vnh53hTZH5LksO1k
r4ckWdt654/b3BdJ8n9sJ3s9JMnaZp8vnD9Icty2k72e8bsHW2Srag==
                  
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 84->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z1uAjEQgNHh5wi5ACeho6HjCETUXAc4HQUN3ZaULFFSxFjQIMaL3kjo
SXyN7dUiPFtvV5tJRIz7z3IUMe097G9znpfGz3R33+v/e1Sna6Znn4+u67rf
53q3P/sfcs8+32c9+3x03fvX7vnpuq7ruj68HtXx/0fXvX/556Pruq7ruq7r
+uf0qI77j157TmSm5WSvhyTZtsdf/+aY3r83l8XX7tTI+ZAkH1tO9npIkm3b
3v3jNfsiSb7HcrLXQ5Js2+z7hfsHSQ7bcrLXM3yvzBKtJw==
                  "], {{0, 
                  0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 85->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt18FpAkEUgOGnsZBYSQrwph0EcraeeAwWYinegjfBBjQhXsYlImrec/M9
WD7wv8wOg+yMX+fTt6eIGB6eySBidHDx/jWbl9b4nu3J73qtHp2zLdOz90fX
dd3/az/fv3rPPr96v89/9v7o/7tfe37v3bP3R9d1Xdd1/dIeneP7StcrnP9z
PXt/dF3XdV3XdV2v06Nz3F/60sk6tpO9HpJkbdc/Hmed3j9Wy9nu+bPI/pAk
f7ed7PWQJGtb7/5xm/ciSf6N7WSvhyRZ2+z7hfsHST627WSv5/HdA8LVreQ=

                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 86->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170JwkAYgOHzZwsrJ3EAK51ABGvn0Q1cxwmCnZ0jqGCaqCjE5LvE54Pw
FG9zOQ/JTdfb5WaUUhrenvkgpXF6N5dZ6X53n/OTej/6p98/ukfvj67r+r/+
/+be+77/0edT73evez6b7tH7ozfb656Ppnv0/ui6ruu6rvetp5fj+09vp9c9
H0336P3RdV3XdV3Xdd39Q/+uk/lYnej1kCTztnhYThHeT5PF6njwnUWS3bA6
0eshSeZtfveP37wXSbIdqxO9HpJk3kbfL9w/SLLbVid6Pd33CqhBoJU=
                  
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 87->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt100KgVEUgOHrZyO2YAMWYGYJykwZWgu7sCNTZWADyk9MLvkonPPVc0pP
eSf3OyJ3MF1MZr1SSvf8GndK6Z9dry6zG9WW6xwe3v+0l6dzSNN//fzZe/T+
m3r0fnRd1/3+ej6ff77vj677frW3R++/qUfvR9d1Xdd1XW9XL0/H/9ssPXr/
TT16P7qu67qu67quu3/o73Uyj/VEn4ckmdvtzftsw/tgeZxvhvsk+yFJvrae
6POQJHOb7/7xneciSf7HeqLPQ5LMbfT9wv2DJNttPdHnab8ndn5sGw==
                  
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 88->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt18FNAlEQgOERaIRKKMCbFRATzp7tgqt2YA12QQVcuRhKAIleHptFgzCz
8k1CvoT/8nayIbzp49PDYhwRo/3n/i5isvf15XM2s9Y4zPbo+6H16JxtmW4/
/T17P7qu61V7dM7t/H5nP9+pnv1+2H/t/en/u5/7/l66209/z96Pruu6ruu6
rv+mR+f4f13l+U/17P3ouq7ruq7ruu7+of+sk3VsJ/s8JMnarr/8nnV6n6/e
npfvH0X2Q5Lst53s85Aka1vv/vE3z0WSvI7tZJ+HJFnb7PuF+wdJDtt2ss8z
fHfP9GzY
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 89->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17sJAkEQgOHx0YiVWICZJQjG1qPVmZpdCT7QZL1AMZhZ7xuQD/yT5fZA
Z7U7bPeLiJjfPptZxPLm6Xify7o1HjO8fa9/12N0Bv3Dnn1/uq7rU+0xOnV+
H6r37PvT//v9z34+eu3+6/s19Z59f7qu67qu67reU4/RqfP/vnrPvj9d13Vd
13Vd16ezH2U/n947Wcd2ss9Dkqzt+elrzsU6SbK27WSfhyRZ2+z9wv5Bkn3b
TvZ5SJK1zd4v7B8k2bftZJ+nf6+gtmk7
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 90->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17kNwkAQQNHlaIRKKICMEpCIqQeqc0pGCYCEk8UciTWz9hsJveAng9cS
7OZw2h9XpZTl47NblLIun+a27b2cn3N9U/+v/3q++vcefX66rutz7WVwpvP7
EL3/2N9P173/8+1jn8/Ue/T56bqu67qu63pLvQxOnv/32Xv0+em6ruu6ruu6
Pp/7UfTzab2Teawneh+SZG67l/10yTpJMrf1RO9Dksxt9P3C/YMk27ae6H1I
krmNvl+4f5Bk29YTvU/73gEWFVwt
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 91->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt100OAUEQgNHycxEncQA7R5BYOw+ns7WbIxhiNmNELKSqeZXIy/g23TOE
Xu0O2/0iIub9azOLWPaejre5rMfGfbqn9z/tMTldmf7v+6/ev/18dF3X9e/0
mBy/L1X2/65n3x9d9/363f1X79mfX13XdV3XdV1vqcfk1Pl/X71nPz9d13Vd
13Vd1//nfJR9f1rvZB3Hk70ekmRtzw+HORfrJMnajid7PSTJ2mafL5w/SLJN
h3l1TZLklNnnC+cPkmzb8WSvp32v+88n9Q==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 92->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt100OAUEQgNHycxEncQA7R5BYOw+ns7WbIxhiNq2FRKieyatEXvg2bdIJ
tdodtvtFRMz712YWsew9HW9zWZfGfbqnz1vrUZ1On0jPvl+6rut6mz2q4/fr
Xz37+b7r2c9Hn3b/9n7qbffs+6Xruq7ruq7rY+pRnen8v88+/6+/n67ruq7r
uq7r9iP9s062YznZ5yFJtu354TDnxjpJsm3LyT4PSbJts/cL+wdJjtNhXr0n
SbJm9n5h/yDJcVtO9nnG7xW4tCf1
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 93->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17kNwkAQQNHhaIRKKICMEpCIqQeqIyWjBA7hxCwiADRj80aynvBP1mYl
2MVmt97OImJ6vVaTiPnVw/42p2XfuM/56X61Hs056yPp2ftL13Vdr9mjOX6/
9O/0X++PT3v2+/n3/uvvV8/t2ftL13Vd13Vd1/+pR3OcD6o8/7ue/X50Xdd1
Xdd1vVKP5vj/PpZO1rE/2eshSdb2+LCbY7FOkqxtf7LXQ5Ksbfb5wvmDJIdp
N68+kyTZMvt84fxBksO2P9nrGb4X0Kon9Q==
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 94->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt1z0KwkAQgNHx5yKexAPYeQTB2vPo6dKm8wgqmCYmpIgyu/ENhEf4ms2y
oLs7XY7nTUSsn89hFbGNsbnvO2/X17QfltKn1q/X3bPPl67rur7MHoPj90//
jz73fP66Z+9P7funz+vZ50vXdV3XdV3Xdfe7b31fds/ev6mevT+6ruu6ruv6
snoMjv+/S+lkOfYnez0kybJt3nbTFNZJkmXbn+z1kCTLNvt+4f5BknXazdg7
SZJDZt8v3D9Ism77k72e+n0A4kga5w==
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 95->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt180JwkAQgNHxpxErsQBvliB4th6tzqs3S1DBHIwbPIQwu+YNyEO+y5AY
4m4Op/1xFRHL52e3iFjH0Ny3n+b1y/k1ty9r2U+ftv+6/7qu67reYo/ieP/q
8+hjf59T99b318f17OdD13Vd13Vd1/X59CiO81ErferrP7ZnXx9d13Vd1/W5
9SiO/4f/0sl67E/2PiTJur2+7eZaWSdJ1m1/svchSdZt9vnC+YMk27Sboe8k
SZbMPl84f5Bk2/Yne5/2fQBNQOag
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 96->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt17sNwjAYhdGfxyJMwgB0jIBEzTwwXVq6jEBAcRM5IPGwE3SuFB1ZXwcp
4s3htD+uImLZPbtFxLrzcr7vuh0aj7W9w7W6XqS/ej91Xdd1XS/fIzvfD/p3
+q/fD11/1mu//7qu67qu67qu66V6ZOd+ppf5fz/ttX8fXdd1Xdf1YY/sfD/9
SyfrmzZ2JkkyZ9Ob1kyskySnadrYmSTJnLXvF+4fJDlP08bOJEnmrH2/cP8g
yXmaNnbmu94AQC3moA==
                  "], {{0, 0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 97->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt100KgkAYgOGvn4t0kg7QriMErTtPnc5tO4+QhbORkSKxUXs+kIfhXTkq
OLvT5XjeRMS6uQ6riG3j7fqc+75rvKZu7U6tL6S/e/5zfz+G3p+u67qu6//X
Izv+b37VS++vPm5f+vtR+vvRdV3XdV3XdV3/lx7ZcT7UP+tjP/+hvfT+6Lqu
67ru/6TbS+9P6U6WN03fmiTJnFVrmmpinSQ5TdP0rUmSzFn6fOH8QZLzNE3f
miTJnKXPF84fJDlP0/St+a0PcBnmoA==
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 98->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt180JwjAYgOH4s4iTOIA3RxA8O49O16u3jmCV5mBJtbRKGn0+kIfwnvoV
odkcTvvjKoSwbH67RQjrxsv5Ptdt1/CYurU7tT6wv9tv6fuf+nz2o+u6ruu6
/txDcv7n+yb385Xef33//p+ve+796Lqu67qu67qu65/pITnun/qw/u33P7Xn
3o+u67qu674fxu2HzGmcvjNJkimr1jjVzDpJcp7G6TuTJJky9/3C/YMkyzRO
35kkyZS57xfuHyRZpnH6zhzrDenU5qA=
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 99->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt18sJAjEUQNHnpxErsQB3liC4th6tbrbuLEEFsxATHfyQOHMeyCHcjb4R
NIvNbr2dRcT08lpNIuZRmtPy3nb7YX+d44N9e+33/+vPZz9t99r7e9Vr70fX
dV3X9fH9/2i9D33/vp/Pe+392K+u67qu67qu67o+hB7ZcT/V+/VfP/9Pe+39
6Lqu6/oYe2Tn27//ZE3TlM4kSebsbqbpGuskyTZNUzqTJJmz9v3C/YMk/9M0
pTNJkjlr3y/cP0jyP01TOvNdz1Gl864=
                  "], {{0, 0}, {331, 2}}, {0,
                   1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 100->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt180JAjEQgNH404iVWIA3SxA8W49Wt1dvlqCCOZmguMTJLm9AHuEDcUdQ
sjmc9sdVSmn5eO0WKa1TbW7b7OX8nOub3/ZP7x/dxz6f/dhP5H567633P7ZH
70fXdV3XI3oqznz+n6M/f+vnsx/76fn3Jbq33v/YHr0fXdd1Xdd1Xdd1/T89
Fcf9dC699fcztkfvR9d1Xdfn2Ml489TOJEmWHF7mGTrrJMk+zVM7kyRZMvp+
4f5BktM0T+1MkmTJ6PuF+wdJTtM8tTN/9Q6MZhrn
                  "], {{0, 0}, {331, 
                  2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}], 101->
                GraphicsBox[RasterBox[CompressedData["
1:eJzt170NwjAQgFHzswiTMAAdIyBRMw9MR0vHCICEC4QdJEJyCXknRU/WV+VS
RF7tDtv9IqU0vz+bWUrLVJvr+tXv++n4mMubffWu369tt5/mbj/NPXo/U+9d
f9+2PXo/uq7r+n/2VBz/v6G8/6duP83dfpp79H6m3rv+vm179H50Xdd1Xdd1
Xdf1fnoqjvvpr3r0/j716P3ouq7rekQn481TO5MkWfL8NM95YJ0kOUzz1M4k
SZaMvl+4f5DkOM1TO5MkWTL6fuH+QZLjNE/tzG+9AYPrAMs=
                  "], {{0, 
                  0}, {331, 2}}, {0, 1}],
                 AspectRatio->NCache[
                   Rational[1, 4], 0.25],
                 Frame->Automatic,
                 FrameLabel->{None, None},
                 FrameTicks->{{None, None}, {None, None}},
                 GridLinesStyle->Directive[
                   GrayLevel[0.5, 0.4]],
                 
                 Method->{
                  "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
                   Automatic}]}, Dynamic[$CellContext`i25$$],
                Alignment->Automatic,
                BaseStyle->"ListAnimateCore",
                ImageSize->All,
                TransitionDirection->Horizontal,
                TransitionDuration->0.5,
                TransitionEffect->Automatic],
               Identity,
               Editable->True,
               Selectable->True],
              ImageMargins->10],
             Deployed->False,
             StripOnInput->False,
             ScriptLevel->0,
             GraphicsBoxOptions->{PreserveImageOptions->True},
             Graphics3DBoxOptions->{PreserveImageOptions->True}],
            Identity,
            Editable->False,
            Selectable->False],
           Alignment->{Left, Center},
           Background->GrayLevel[1],
           Frame->1,
           FrameStyle->GrayLevel[0, 0.2],
           ItemSize->Automatic,
           StripOnInput->False]}
        },
        AutoDelete->False,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Top}}, 
          "RowsIndexed" -> {}},
        GridBoxDividers->{
         "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
          "RowsIndexed" -> {}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.7], {
             Offset[0.5599999999999999]}, 
            Offset[0.7]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.4], {
             Offset[0.8]}, 
            Offset[0.4]}, "RowsIndexed" -> {}}], If[
        And[
         CurrentValue["NotebookSelected"], 
         CurrentValue["SelectionOver"]], 
        Manipulate`Dump`ReadControllerState[
         Map[Manipulate`Dump`updateOneVar[#, 
           CurrentValue["PreviousFormatTime"], 
           CurrentValue["CurrentFormatTime"]]& , {
           
           Manipulate`Dump`controllerLink[{$CellContext`i25$$, \
$CellContext`i25$132784$$}, "X1", 
            If["DefaultAbsolute", True, "JB1"], False, {1, 101, 1}, 101, 
            1.]}], 
         CurrentValue[{
          "ControllerData", {
           "Gamepad", "Joystick", "Multi-Axis Controller"}}], {}]],
       ImageSizeCache->{491., {88.25, 96.25}}],
      DefaultBaseStyle->{},
      FrameMargins->{{5, 5}, {5, 5}}],
     BaselinePosition->Automatic,
     ImageMargins->0],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "ListAnimate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.75105214075482*^9},
 Background->RGBColor[1, 0.5, 0.5],
 CellLabel->
  "Out[316]=",ExpressionUUID->"40bb0f78-1dd4-4f76-b527-c07bb5283c7b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Do not erase", "Section",
 CellChangeTimes->{{3.7495745366820297`*^9, 
  3.749574542387333*^9}},ExpressionUUID->"3f319079-3b09-4e4a-9b82-\
5ad8289ec5d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movebottom", "[", 
   RowBox[{"bottom", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"wagons", ":", "___"}], ",", 
      RowBox[{"h", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v_", "/;", 
          RowBox[{"v", "\[GreaterEqual]", "1"}]}], ",", "_", ",", "_"}], 
        "}"}]}], ",", "___", ",", 
      RowBox[{"{", "_", "}"}], ",", "___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"crash", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bottom", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"w", "+", "2"}], ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", "_", "}"}], ",", "1", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Bus ahead, moving\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"h", ",", "crash"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "am", "]"}], "<", "crash"}], "&&", 
        RowBox[{"v", "\[GreaterEqual]", "crash"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Bus", " ", "ahead"}], ",", " ", "fast", ",", " ", 
         RowBox[{
         "brake", " ", "as", " ", "much", " ", "as", " ", "possible"}]}], 
        "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Far, fast, brake max negative\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"brake", "[", "v", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "am", "]"}], "<", "crash"}], "&&", 
        RowBox[{"v", "<", "crash"}]}], 
       RowBox[{"(*", 
        RowBox[{"far", ",", " ", 
         RowBox[{"going", " ", "slow"}]}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Far, slow, hold or accelerate to max negative\>\"",
          "]"}], ";", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
             RowBox[{"Abs", "[", "am", "]"}]}], ",", 
            RowBox[{"Abs", "[", "am", "]"}], ",", 
            RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"crash", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
        RowBox[{"v", "\[GreaterEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"close", ",", " ", 
         RowBox[{"going", " ", "fast"}]}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Close, fast, brake to max negative or ds\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", "crash"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"crash", "\[LessEqual]", 
         RowBox[{"Abs", "[", "am", "]"}]}], "&&", 
        RowBox[{"v", "<", 
         RowBox[{"Abs", "[", "am", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"close", ",", " ", 
         RowBox[{"going", " ", "slow"}]}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Close, slow, brake or accelerate to ds\>\"", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"v", "+", "ap"}], ",", "ds", ",", 
             RowBox[{
              RowBox[{"v", "+", "ap"}], ">", "ds"}], ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", "ds"}], ",", 
                 "ds", ",", 
                 RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"movebottom", "[", 
         RowBox[{"bottom", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", "crash"}], ",", 
            "crash", ",", 
            RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "True", " ", ",", 
       RowBox[{"Print", "[", "\"\<crash will happen\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"2f6a58f4-2e56-4318-85ec-e7af48acf3dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"move", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"top", ":", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"s_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[Equal]", "2"}]}], ",", 
        "___"}], "}"}]}], ",", 
     RowBox[{"bottom", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wagons", ":", "__"}], ",", 
        RowBox[{"h", ":", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"rest__", "/;", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
           "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}]}]}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"db", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", "rest", "}"}], ",", "_List", ",", "1", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"ds", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"top", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"w", "+", "1"}], ")"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Station, bus\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"db", ",", "ds"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "<", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"station", " ", "behind"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<\\tStation behind\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ds", "<", "db"}], " ", 
       RowBox[{"(*", 
        RowBox[{"Deal", " ", "with", " ", "the", " ", "station"}], "*)"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<\\tBus at or after station, interact with station\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "\[Equal]", "0"}], "&&", 
           RowBox[{"ds", "\[Equal]", "0"}]}], 
          RowBox[{"(*", 
           RowBox[{"bus", " ", "at", " ", "station"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tBus at station, load, unload or move\>\"",
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"h", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<\\t\\t\\tmove.\>\"", "]"}], ";", 
              RowBox[{"{", 
               RowBox[{"top", ",", 
                RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<\\t\\t\\tload or unload.\>\"", "]"}],
               ";", 
              RowBox[{"loadAndUnload", "[", 
               RowBox[{"{", 
                RowBox[{
                 StyleBox["top",
                  FontSlant->"Italic"], ",", 
                 StyleBox["bottom",
                  FontSlant->"Italic"]}], "}"}], "]"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "\[GreaterEqual]", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "fast"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tFar, fast, brake to max negative\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"Abs", "[", "am", "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "am", "]"}], "<", "ds"}], "&&", 
           RowBox[{"v", "<", "ds"}]}], 
          RowBox[{"(*", 
           RowBox[{"far", ",", " ", 
            RowBox[{"going", " ", "slow"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\\t\\tFar, slow, hold or accelerate to max negative\>\"", 
            "]"}], ";", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "+", "ap"}], "\[GreaterEqual]", 
                  RowBox[{"Abs", "[", "am", "]"}]}], ",", 
                 RowBox[{"Abs", "[", "am", "]"}], ",", 
                 RowBox[{"v", "+", "ap"}]}], "]"}]}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ds", "\[LessEqual]", 
           RowBox[{"Abs", "[", "am", "]"}]}], 
          RowBox[{"(*", "close", "*)"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\t\\tClose, brake or accelerate to ds\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"top", ",", 
             RowBox[{"movebottom", "[", 
              RowBox[{"bottom", ",", "ds"}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", "True", ",", " ", 
          RowBox[{"Print", "[", "\"\<\\tProblem (station)\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ds", "\[GreaterEqual]", " ", "db"}], 
       RowBox[{"(*", 
        RowBox[{"Deal", " ", "with", " ", "the", " ", "bus"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<\\tBus before station, interact with bus\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"top", ",", 
          RowBox[{"movebottom", "[", "bottom", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", 
       RowBox[{"Print", "[", "\"\<\\tProblem with interaction.\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756919141055341*^9, 3.75691914156811*^9}, {
   3.756919192383854*^9, 3.7569191933599787`*^9}, {3.7569192549262257`*^9, 
   3.756919255021707*^9}, {3.756919983616617*^9, 3.7569199844420557`*^9}, 
   3.756920203899517*^9, 3.756920438513762*^9, 3.756920758653461*^9, {
   3.7569221553272943`*^9, 3.756922266943678*^9}, {3.756922303092514*^9, 
   3.7569223487424927`*^9}, {3.756923157628049*^9, 3.756923159317794*^9}, {
   3.7569231975410233`*^9, 3.7569232809559402`*^9}, {3.756936380818111*^9, 
   3.756936403750822*^9}, {3.758479376513631*^9, 3.7584794501041803`*^9}, {
   3.758479484370964*^9, 3.7584795204054823`*^9}, 3.758479560158568*^9, {
   3.758479600395851*^9, 3.758479603826613*^9}, {3.7584820654345284`*^9, 
   3.7584820686677437`*^9}, {3.763742617867609*^9, 
   3.763742619804126*^9}},ExpressionUUID->"e1a3ec96-b1d9-41ed-a97a-\
820ea7533ab1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1052, 704},
WindowMargins->{{14, Automatic}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 242, 4, 124, "Title",ExpressionUUID->"96147a4d-7515-4828-be64-976d91bea8e8"],
Cell[CellGroupData[{
Cell[847, 30, 169, 3, 80, "Subchapter",ExpressionUUID->"6fca091b-9b9a-406e-a508-43cb7455b9fa"],
Cell[1019, 35, 4703, 102, 823, "Text",ExpressionUUID->"4b1e53e0-cadb-4068-a1b0-2ada61edd588"],
Cell[5725, 139, 210, 4, 44, "Text",ExpressionUUID->"bc79c9d6-9b1d-4c13-b73c-c855212371b9"],
Cell[5938, 145, 1413, 34, 292, "Input",ExpressionUUID->"06561019-91e5-4895-98ec-ea625464ae94",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[7388, 184, 197, 3, 100, "Subchapter",ExpressionUUID->"34a485e1-db54-494d-bd09-bd8e00ac5eae"],
Cell[CellGroupData[{
Cell[7610, 191, 156, 3, 84, "Section",ExpressionUUID->"e8573741-344c-41ec-98bf-aeb18d62369a"],
Cell[7769, 196, 738, 18, 102, "Text",ExpressionUUID->"8fe7bb2e-b8a4-42e3-9fa4-4a94ea0f459a"],
Cell[8510, 216, 612, 13, 59, "Input",ExpressionUUID->"29371a8c-7808-401c-8a44-7fa1feab8cfb",
 InitializationCell->True],
Cell[9125, 231, 239, 4, 44, "Text",ExpressionUUID->"b89e8d06-e6e1-4670-9e35-cd61f5ecabec"],
Cell[9367, 237, 377, 9, 59, "Input",ExpressionUUID->"a1a47536-9a1c-4457-b7ab-597eb0c6c9c7",
 InitializationCell->True],
Cell[9747, 248, 1591, 44, 102, "Text",ExpressionUUID->"0121c219-e4e1-41b9-a68f-bf0115741663"],
Cell[11341, 294, 2103, 54, 259, "Input",ExpressionUUID->"571c3f2c-de0e-4e1b-8c09-ca43eeae9abc",
 InitializationCell->True],
Cell[13447, 350, 328, 8, 59, "Input",ExpressionUUID->"e26c2684-30e8-4eb8-b904-115724ea3ad9",
 InitializationCell->True],
Cell[13778, 360, 2053, 54, 102, "Text",ExpressionUUID->"d74bbd24-d0f1-42bd-bb3a-675cd6db6fe4"],
Cell[15834, 416, 1384, 37, 181, "Input",ExpressionUUID->"841bd5b4-19a2-4ebf-9fdf-b991f32c62c0",
 InitializationCell->True],
Cell[17221, 455, 381, 9, 59, "Input",ExpressionUUID->"74d04a73-a54a-4b31-8fb9-e91ce118eb78",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[17639, 469, 150, 3, 65, "Section",ExpressionUUID->"a8b112f3-2448-4781-88eb-341c7082f57f"],
Cell[17792, 474, 3175, 81, 246, "Text",ExpressionUUID->"ac33a864-65c0-4f37-b150-38ae66143e2f"]
}, Closed]],
Cell[CellGroupData[{
Cell[21004, 560, 206, 4, 65, "Section",ExpressionUUID->"b0d0f650-268d-4607-8117-169c38e036ce"],
Cell[21213, 566, 488, 7, 44, "Text",ExpressionUUID->"63d0b6a7-1d72-4561-8aee-350d800681da"],
Cell[21704, 575, 7358, 231, 611, "Input",ExpressionUUID->"66ef6297-4ac6-4ef5-819e-ec40d1288576",
 InitializationCell->True],
Cell[29065, 808, 301, 5, 106, "Text",ExpressionUUID->"9f7925ca-5235-4f99-b779-fd5f8b16794b"],
Cell[29369, 815, 2959, 83, 500, "Input",ExpressionUUID->"8df18c66-b716-420e-b945-a5db70389fb8",
 InitializationCell->True],
Cell[32331, 900, 968, 16, 178, "Text",ExpressionUUID->"4ec388ea-1684-4fb1-bde0-166c3d766324"],
Cell[CellGroupData[{
Cell[33324, 920, 540, 13, 93, "Input",ExpressionUUID->"657c5e0a-a3a4-457a-88a1-52b23694d15f"],
Cell[33867, 935, 787, 13, 179, "Output",ExpressionUUID->"f039b292-0e31-433c-8fef-a1829e8a004c"]
}, Open  ]],
Cell[34669, 951, 12425, 375, 2340, "Input",ExpressionUUID->"b64af6ad-5580-4c4a-8833-42682b32afa8",
 InitializationCell->True],
Cell[47097, 1328, 417, 9, 178, "Text",ExpressionUUID->"86d18cb1-de72-4495-ba5d-675fa7c601e7"],
Cell[CellGroupData[{
Cell[47539, 1341, 460, 12, 93, "Input",ExpressionUUID->"38fa66e0-66e7-492a-b4e0-40048fa82e3f"],
Cell[48002, 1355, 722, 12, 179, "Output",ExpressionUUID->"a0b1bb2c-c3c6-4207-9773-4cebe814113c"]
}, Open  ]],
Cell[48739, 1370, 5813, 174, 1207, "Input",ExpressionUUID->"048bab5f-774c-4caa-96dd-24eff9fbbb55",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[54589, 1549, 190, 3, 70, "Section",ExpressionUUID->"9dc19ae6-ecbb-48d3-bb5c-448b820f668c"],
Cell[54782, 1554, 1129, 31, 102, "Text",ExpressionUUID->"cef8119a-37ae-403f-8a67-fd6459261552"],
Cell[55914, 1587, 1407, 41, 147, "Input",ExpressionUUID->"facaedda-76bc-402b-9b48-ae74826e3f46",
 InitializationCell->True],
Cell[57324, 1630, 1176, 26, 104, "Text",ExpressionUUID->"e38bb641-3464-41d7-8566-b58e1838f651"],
Cell[58503, 1658, 2321, 54, 176, "Input",ExpressionUUID->"0186486b-a385-4862-bf74-d6471580f8ed",
 InitializationCell->True],
Cell[60827, 1714, 461, 8, 102, "Text",ExpressionUUID->"ea6d7524-6856-450f-a7bb-9bb6fc170580"],
Cell[CellGroupData[{
Cell[61313, 1726, 517, 13, 39, "Input",ExpressionUUID->"eef9f21a-f8a4-46b2-abf0-a43456a436a7"],
Cell[61833, 1741, 1222, 19, 74, "Output",ExpressionUUID->"06355f6b-1410-4f0a-b4c8-61cdc2e73701"]
}, Open  ]],
Cell[63070, 1763, 1101, 28, 98, "Input",ExpressionUUID->"b9edf46c-6814-4145-ba3d-ac497645b49d"],
Cell[CellGroupData[{
Cell[64196, 1795, 230, 4, 39, "Input",ExpressionUUID->"fe0e60b6-0fa0-4d03-9d9e-50ccccd554d0"],
Cell[64429, 1801, 1480, 32, 103, "Output",ExpressionUUID->"893f988c-d0ee-4802-a03e-41ebbd6f84e8"]
}, Open  ]],
Cell[65924, 1836, 846, 15, 217, "Text",ExpressionUUID->"fcdb0935-6db0-4968-906f-ed8903fa2764"],
Cell[CellGroupData[{
Cell[66795, 1855, 158, 3, 68, "Subsection",ExpressionUUID->"9f4601e7-c16a-4a11-ae70-d9556c56ef94"],
Cell[66956, 1860, 1163, 31, 131, "Text",ExpressionUUID->"857ad2ee-84cc-4eca-9153-fc7e0901a58d"],
Cell[CellGroupData[{
Cell[68144, 1895, 316, 7, 59, "Input",ExpressionUUID->"b6fe9b39-403a-48ca-a22f-369edabf4140",
 InitializationCell->True],
Cell[68463, 1904, 569, 12, 70, "Output",ExpressionUUID->"d9b9e045-7699-48c0-a6a1-a5c6f2addd36"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69069, 1921, 178, 3, 57, "Subsubsection",ExpressionUUID->"4a4f8ff1-3e91-4026-8c5c-254aac57d883"],
Cell[69250, 1926, 564, 16, 75, "Text",ExpressionUUID->"ebb24cef-a7ba-4f7d-ba87-2f2568e16180"],
Cell[69817, 1944, 1081, 26, 205, "Input",ExpressionUUID->"9b3e417d-b36a-4d53-aa44-62cf3cc44e76",
 InitializationCell->True],
Cell[70901, 1972, 261, 5, 44, "Text",ExpressionUUID->"d935f2f6-e259-44ff-afde-1805f0cf7e90"],
Cell[71165, 1979, 1068, 30, 89, "Input",ExpressionUUID->"3de749d7-95f7-45f7-985d-6e0ad577b796",
 InitializationCell->True],
Cell[72236, 2011, 440, 8, 73, "Text",ExpressionUUID->"2a9eb7e4-d5e3-46e8-9e5f-87861d5ec0e4"],
Cell[72679, 2021, 4660, 120, 495, "Input",ExpressionUUID->"2d9432c3-9eb7-44f0-95be-305ef78469e1",
 InitializationCell->True],
Cell[77342, 2143, 233, 4, 44, "Text",ExpressionUUID->"5599b516-7616-4046-b1b5-f31ac645588c"],
Cell[77578, 2149, 1431, 42, 147, "Input",ExpressionUUID->"ee15f134-8a5e-4328-b909-90eea1a659fe",
 InitializationCell->True],
Cell[79012, 2193, 242, 4, 44, "Text",ExpressionUUID->"a6716cbf-eca8-49aa-99cb-70c3eb21c05e"],
Cell[79257, 2199, 3337, 92, 466, "Input",ExpressionUUID->"2c13f073-2afa-4d73-b607-335cd3fa16d6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[82631, 2296, 226, 4, 139, "Subsubsection",ExpressionUUID->"1b690565-d7a8-4daf-a73a-e64f5e361117"],
Cell[82860, 2302, 531, 15, 182, "Text",ExpressionUUID->"650a71d8-a1d4-46d8-a336-8c95c3f7f5db"],
Cell[83394, 2319, 1208, 31, 521, "Input",ExpressionUUID->"26c4a5c2-d440-417b-9b6e-c13caa272be0"],
Cell[84605, 2352, 261, 5, 106, "Text",ExpressionUUID->"02bc87b7-057e-4382-90b7-2e1b09d3eec5"],
Cell[84869, 2359, 1281, 35, 239, "Input",ExpressionUUID->"df0d7e60-5734-4a19-bf5c-6e35fa3269d6"],
Cell[86153, 2396, 440, 8, 178, "Text",ExpressionUUID->"f7471d36-930f-47f4-a38b-f2c67e930994"],
Cell[86596, 2406, 5617, 145, 1512, "Input",ExpressionUUID->"d57bbcad-bdd3-4579-827a-e5ff72e6fe5f"],
Cell[92216, 2553, 233, 4, 106, "Text",ExpressionUUID->"a5bc851e-c1bc-475f-89eb-ee224d278c9e"],
Cell[92452, 2559, 1533, 44, 309, "Input",ExpressionUUID->"e786b857-499b-4342-bdcf-81639d94143b"],
Cell[93988, 2605, 242, 4, 106, "Text",ExpressionUUID->"78b5fb41-b0ee-40e9-aafb-4fa4afeddaa2"],
Cell[94233, 2611, 3645, 100, 1017, "Input",ExpressionUUID->"58671395-5e14-4f70-a2ad-d87756323ad1"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[97927, 2717, 203, 4, 47, "Subsection",ExpressionUUID->"767e1ff4-6555-41a0-8123-a690763a0701"],
Cell[98133, 2723, 981, 23, 188, "Text",ExpressionUUID->"96023d43-f806-4569-b1ec-637f7a9d8804"],
Cell[CellGroupData[{
Cell[99139, 2750, 178, 3, 57, "Subsubsection",ExpressionUUID->"9d6afb35-47f6-47d7-aec3-3fc3f26a5d0a"],
Cell[99320, 2755, 369, 7, 44, "Text",ExpressionUUID->"40ec76a3-fa87-442d-9e32-508b804466e0"],
Cell[99692, 2764, 6964, 173, 1020, "Input",ExpressionUUID->"5707bd90-bddf-4a1d-8e3e-a50fe218a7dc",
 InitializationCell->True],
Cell[106659, 2939, 419, 8, 44, "Text",ExpressionUUID->"9bbc4881-7e9e-4ec3-acf9-ec0df59a2268"],
Cell[107081, 2949, 6448, 159, 756, "Input",ExpressionUUID->"8d548be1-acb1-4f15-b6b9-42d9a99ff27e",
 InitializationCell->True],
Cell[113532, 3110, 418, 8, 106, "Text",ExpressionUUID->"fc96c2f1-fd53-4fbc-a444-115c8dec0d58"],
Cell[113953, 3120, 6603, 175, 1845, "Input",ExpressionUUID->"2d94b5fd-5659-4397-bc4a-9fefc344bc7c",
 InitializationCell->True],
Cell[120559, 3297, 419, 8, 44, "Text",ExpressionUUID->"38fd9f21-2f2f-44ca-9230-5ec59ea7953d"],
Cell[120981, 3307, 6146, 160, 669, "Input",ExpressionUUID->"3bafc472-5bf7-48bd-ad32-0ff4cc6af29c",
 InitializationCell->True],
Cell[127130, 3469, 158, 3, 44, "Text",ExpressionUUID->"bf475897-90a2-4989-9f0c-3e7dbc4da0af"],
Cell[127291, 3474, 522, 15, 59, "Input",ExpressionUUID->"0d5beac3-50f7-4de8-8954-4e4c70b7450b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[127850, 3494, 228, 4, 57, "Subsubsection",ExpressionUUID->"6b1112fd-c70d-4b7c-b3c2-94080786cd88"],
Cell[128081, 3500, 369, 7, 44, "Text",ExpressionUUID->"0597a4b6-9903-4e49-bd63-5cddd837ea41"],
Cell[128453, 3509, 10144, 238, 1316, "Input",ExpressionUUID->"69253122-35ca-4058-9099-46da0bcd3052"],
Cell[138600, 3749, 419, 8, 44, "Text",ExpressionUUID->"72455a84-5ab5-4b98-b5e0-6b0ae55a534f"],
Cell[139022, 3759, 8083, 195, 1026, "Input",ExpressionUUID->"41c188e8-4cd5-4695-927b-22e5c1445064"],
Cell[147108, 3956, 418, 8, 44, "Text",ExpressionUUID->"798ba209-42b3-46b4-9073-9098b61a53b4"],
Cell[147529, 3966, 8377, 215, 1026, "Input",ExpressionUUID->"6a76a04e-b9f7-41e0-9b36-6f66f27f36d3"],
Cell[155909, 4183, 419, 8, 44, "Text",ExpressionUUID->"31761617-6c00-4a73-8c27-00b2ddbf2c32"],
Cell[156331, 4193, 7249, 187, 881, "Input",ExpressionUUID->"46147936-aab2-4e80-9abd-a7f408e63568"],
Cell[163583, 4382, 158, 3, 44, "Text",ExpressionUUID->"0c65a689-f771-4657-a434-386005c0e307"],
Cell[163744, 4387, 499, 15, 39, "Input",ExpressionUUID->"6b1af498-60c4-41ff-b067-9c3f75c61a26"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[164292, 4408, 268, 4, 68, "Subsection",ExpressionUUID->"66c92979-ccc4-4f83-a469-90ab64ff3586"],
Cell[164563, 4414, 1271, 38, 73, "Text",ExpressionUUID->"ee7c4320-0366-4261-b339-c429b298de90"],
Cell[165837, 4454, 1248, 28, 188, "Text",ExpressionUUID->"3d54aadb-d1c2-4dd7-a8fa-13109a4788d2"],
Cell[CellGroupData[{
Cell[167110, 4486, 178, 3, 57, "Subsubsection",ExpressionUUID->"4871f7f6-7b10-4097-9568-3ce7900f97a5"],
Cell[167291, 4491, 155, 3, 106, "Text",ExpressionUUID->"f97db9a5-e004-47c1-91c8-0af1b762e757"],
Cell[167449, 4496, 816, 23, 217, "Input",ExpressionUUID->"ef31de4e-6700-4eb9-afd1-1d11db1c2419",
 InitializationCell->True],
Cell[168268, 4521, 2649, 70, 735, "Input",ExpressionUUID->"291c116d-c3fe-48f3-aa6b-048793a66d2b",
 InitializationCell->True],
Cell[170920, 4593, 157, 3, 106, "Text",ExpressionUUID->"70385013-3fb9-4587-b232-a85f419aca10"],
Cell[171080, 4598, 648, 13, 178, "Text",ExpressionUUID->"d42d4228-5715-4710-934f-bfc65a14dcf3"],
Cell[171731, 4613, 4430, 113, 1207, "Input",ExpressionUUID->"535cf175-5ad7-4f43-a2ff-08d82520a41b",
 InitializationCell->True],
Cell[176164, 4728, 6348, 151, 1632, "Input",ExpressionUUID->"9fbde3dc-3491-408d-b0c2-46127c7c7dd6",
 InitializationCell->True],
Cell[182515, 4881, 610, 12, 178, "Text",ExpressionUUID->"0ef7b520-0c9e-45bd-ac02-04861c0c44a5"],
Cell[183128, 4895, 1402, 39, 357, "Input",ExpressionUUID->"e58bc5d5-2d94-4b2b-84e3-decea4fe8cc5",
 InitializationCell->True],
Cell[184533, 4936, 9805, 243, 2978, "Input",ExpressionUUID->"8530aa09-bb3f-4d90-8784-834ef589db6c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[194375, 5184, 226, 4, 46, "Subsubsection",ExpressionUUID->"ab79bdd5-2ee2-4c4d-9a6b-806bf0fd543e"],
Cell[194604, 5190, 155, 3, 44, "Text",ExpressionUUID->"10db8785-cf4b-4829-b9ea-833cda7d4da0"],
Cell[194762, 5195, 793, 23, 69, "Input",ExpressionUUID->"30394347-e4af-44ee-b562-11fe393b68b4"],
Cell[195558, 5220, 3182, 83, 396, "Input",ExpressionUUID->"2a98bf30-439f-4bb6-83d7-f651bce3af95"],
Cell[198743, 5305, 157, 3, 44, "Text",ExpressionUUID->"ced5b0b9-f04b-4f44-9dab-73ddf2ec8200"],
Cell[198903, 5310, 648, 13, 73, "Text",ExpressionUUID->"1b783c1b-9450-4aeb-935f-58331aa510e2"],
Cell[199554, 5325, 5041, 129, 620, "Input",ExpressionUUID->"dbefce7e-2a04-4a10-82c2-ab5ce2809688"],
Cell[204598, 5456, 7590, 177, 852, "Input",ExpressionUUID->"6cdcbdbc-6c35-4e3c-a6f7-1e31b3c9ab00"],
Cell[212191, 5635, 610, 12, 73, "Text",ExpressionUUID->"e6c2ba97-8d0b-4008-b39a-ed940e98875d"],
Cell[212804, 5649, 1466, 41, 156, "Input",ExpressionUUID->"b5df34bc-575c-4d2f-af32-5d82a7f86095"],
Cell[214273, 5692, 11939, 297, 1548, "Input",ExpressionUUID->"ce593845-1231-4d43-8e38-24da98c326d6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[226261, 5995, 311, 5, 68, "Subsection",ExpressionUUID->"28662e67-ae17-4ce0-88c0-7bfb4aede95c"],
Cell[226575, 6002, 595, 18, 44, "Text",ExpressionUUID->"6c904cce-eb26-43c4-91fc-56c81df5531d"],
Cell[227173, 6022, 4161, 107, 408, "Input",ExpressionUUID->"e588da51-99d7-430a-8264-2b9b91085515",
 InitializationCell->True],
Cell[231337, 6131, 672, 14, 39, "Input",ExpressionUUID->"374dd65b-1fe2-469f-9630-ea16b96fb6f4"],
Cell[232012, 6147, 545, 13, 44, "Text",ExpressionUUID->"de8a89b0-9fbf-4465-8316-cc8ef2c770e7"],
Cell[232560, 6162, 1871, 49, 176, "Input",ExpressionUUID->"2990deab-e4cb-4f86-8c84-ed040d38d255",
 InitializationCell->True],
Cell[234434, 6213, 1170, 35, 44, "Text",ExpressionUUID->"2ea49c77-28c1-4db0-937b-a1b173a5cb9b"],
Cell[235607, 6250, 1103, 30, 118, "Input",ExpressionUUID->"2f324dec-e31c-4c2c-a892-c518afac5b28",
 InitializationCell->True],
Cell[236713, 6282, 778, 21, 73, "Text",ExpressionUUID->"f66e121d-c02b-43bf-bcc3-a0343fe9c62c"],
Cell[237494, 6305, 5240, 126, 785, "Input",ExpressionUUID->"c70c1c1d-fd90-4bff-9903-3bcc91cc911b",
 InitializationCell->True],
Cell[242737, 6433, 300, 7, 59, "Input",ExpressionUUID->"65a3c1cb-41b3-450f-a822-a563d3b031ac"],
Cell[243040, 6442, 1368, 39, 147, "Input",ExpressionUUID->"3a8ae963-9502-4e63-b13b-2754476e9134"],
Cell[244411, 6483, 7271, 119, 176, "Input",ExpressionUUID->"22e98dc3-104b-4351-bf15-4df14113a0b3"],
Cell[251685, 6604, 377, 8, 59, "Input",ExpressionUUID->"1d092e32-fcdb-4ad0-996a-6a0ac81ac79a"],
Cell[252065, 6614, 1279, 38, 147, "Input",ExpressionUUID->"af5583f3-dc15-4fd7-993a-fbd276c22b80"],
Cell[253347, 6654, 7530, 123, 176, "Input",ExpressionUUID->"d4b0eba8-0668-42f3-85f9-0e979eb3a609"],
Cell[260880, 6779, 367, 8, 59, "Input",ExpressionUUID->"38a8d8aa-eeb1-4207-8b74-75795e8defc1"],
Cell[261250, 6789, 1154, 35, 64, "Text",ExpressionUUID->"06fa6ddb-b5bd-406f-a7ce-85e5e674227b"],
Cell[262407, 6826, 23378, 684, 2119, "Input",ExpressionUUID->"869c89c0-536c-4de5-a8ff-970b9706bed8"],
Cell[285788, 7512, 234, 6, 59, "Input",ExpressionUUID->"390bde7c-55fb-41dc-8119-4724cc27307b"],
Cell[286025, 7520, 2114, 52, 176, "Input",ExpressionUUID->"309f9cb3-3353-4b8c-8c98-b5af5109ada5"],
Cell[288142, 7574, 8947, 144, 176, "Input",ExpressionUUID->"0876f054-88d6-4376-a48e-3fbca9dd518e"],
Cell[297092, 7720, 1628, 46, 158, "Input",ExpressionUUID->"4b2150d6-b459-4533-a394-8b2a7a9ef4b8"],
Cell[298723, 7768, 952, 22, 59, "Input",ExpressionUUID->"5bb59abc-f8ba-4a77-869e-91442da3477d"],
Cell[CellGroupData[{
Cell[299700, 7794, 1148, 31, 118, "Input",ExpressionUUID->"79b1ac0a-bda1-4998-8541-ca3f8c336a4e"],
Cell[300851, 7827, 94719, 2053, 245, "Output",ExpressionUUID->"40bb0f78-1dd4-4f76-b527-c07bb5283c7b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[395631, 9887, 159, 3, 84, "Section",ExpressionUUID->"3f319079-3b09-4e4a-9b82-5ad8289ec5d2"],
Cell[395793, 9892, 5115, 133, 620, "Input",ExpressionUUID->"2f6a58f4-2e56-4318-85ec-e7af48acf3dc"],
Cell[400911, 10027, 7989, 197, 1026, "Input",ExpressionUUID->"e1a3ec96-b1d9-41ed-a97a-820ea7533ab1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

